{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./components/Cell.vue?7813","webpack:///./components/Cell.vue?334d","webpack:///./components/Cell.vue","webpack:///./components/Cell.vue?3316","webpack:///./src/engine/utils.ts","webpack:///./src/engine/fov.ts","webpack:///./src/engine/characteristics.ts","webpack:///./src/engine/items/internal.ts","webpack:///./src/engine/inventory.ts","webpack:///./src/engine/creature.ts","webpack:///./src/engine/ai/internal.ts","webpack:///./src/engine/ai/attacker.ts","webpack:///./src/engine/ai/chaser.ts","webpack:///./src/engine/tile.ts","webpack:///./src/engine/screens/internal.ts","webpack:///./src/engine/screens/idle_screen.ts","webpack:///./src/engine/screens/inventory_screen.ts","webpack:///./src/engine/ai/meta_ai.ts","webpack:///./src/engine/ai/dispatcher.ts","webpack:///./src/engine/ai/escaper.ts","webpack:///./src/engine/ai/explorer.ts","webpack:///./src/engine/ai/loiter.ts","webpack:///./src/engine/ai/patrol.ts","webpack:///./src/engine/ai/player_ai.ts","webpack:///./src/engine/ai/picker.ts","webpack:///./src/engine/ai/selfhealer.ts","webpack:///./src/engine/ai/descender.ts","webpack:///./src/engine/effect.ts","webpack:///./src/engine/ai/thrower.ts","webpack:///./src/engine/logger.ts","webpack:///./src/engine/timeline.ts","webpack:///./src/engine/map.ts","webpack:///./src/engine/level.ts","webpack:///./src/engine/memory.ts","webpack:///./src/engine/game.ts","webpack:///./src/engine/pool.ts","webpack:///./src/engine/profession.ts","webpack:///./src/engine/generator/post.ts","webpack:///./src/engine/generator/drawn.ts","webpack:///./src/engine/generator/dungeon.ts","webpack:///./src/engine/screens/items_listing.ts","webpack:///./src/engine/screens/profession_picking_screen.ts","webpack:///./components/Logger.vue?c1ad","webpack:///./components/Logger.vue?9375","webpack:///./components/Logger.vue","webpack:///./components/Logger.vue?e2af","webpack:///./components/stats.vue?fdb0","webpack:///./components/stats.vue?8458","webpack:///./src/engine/ai/waiter.ts","webpack:///./components/stats.vue","webpack:///./components/stats.vue?2da8","webpack:///./vendor/unicodetiles.ts/src/unicodetiles.ts","webpack:///./vendor/unicodetiles.ts/src/CanvasRenderer.ts","webpack:///./vendor/unicodetiles.ts/src/WebGLRenderer.ts","webpack:///./components/scene_tiles.ts","webpack:///./components/Scene.vue?a156","webpack:///./components/Scene.vue?4292","webpack:///./components/Scene.vue","webpack:///./components/Scene.vue?042c","webpack:///./components/screens/IdleScreen.vue?afe3","webpack:///./components/screens/IdleScreen.vue?432f","webpack:///./components/screens/IdleScreen.vue","webpack:///./components/screens/IdleScreen.vue?43b6","webpack:///./components/screens/ProfessionPickingScreen.vue?ecdd","webpack:///./components/screens/ProfessionPickingScreen.vue?f603","webpack:///./components/screens/ProfessionPickingScreen.vue","webpack:///./components/screens/ProfessionPickingScreen.vue?b50d","webpack:///./components/screens/ItemsListingScreen.vue?f414","webpack:///./components/screens/ItemsListingScreen.vue?bb87","webpack:///./components/screens/ItemsListingScreen.vue","webpack:///./components/screens/ItemsListingScreen.vue?9f88","webpack:///./src/onisun.ts","webpack:///./components/screens/TalentsTreeScreen.vue?b3a5","webpack:///./components/screens/TalentsTreeScreen.vue?7f6a","webpack:///./components/screens/TalentsTreeScreen.vue","webpack:///./components/screens/TalentsTreeScreen.vue?58da","webpack:///./components/screens/InventoryScreen.vue?a91d","webpack:///./components/screens/InventoryScreen.vue?29af","webpack:///./components/screens/InventoryScreen.vue","webpack:///./components/screens/InventoryScreen.vue?70d0","webpack:///./components/App.vue?91d1","webpack:///./components/App.vue?b7e9","webpack:///./components/App.vue","webpack:///./components/App.vue?5fb2","webpack:///./components/index.ts","webpack:///./components/App.vue?7ea9","webpack:///./components/screens/InventoryScreen.vue?e463","webpack:///./components/screens/TalentsTreeScreen.vue?c9d5","webpack:///./components/screens/ItemsListingScreen.vue?d62f","webpack:///./components/screens/ProfessionPickingScreen.vue?936d","webpack:///./components/Scene.vue?c20d","webpack:///./components/Logger.vue?c164","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./components/Cell.vue?b975"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","components_Cellvue_type_script_lang_ts","vue_runtime_esm","extend","props","computed","[object Object]","this","player","cell","isWall","isDoor","display","Cell","componentNormalizer","_h","$createElement","_self","_c","_v","Rect","x","y","w","h","succ","String","fromCharCode","charCodeAt","rand","max","Math","floor","random","twoDimArray","width","height","field","Array","min","list","Point","point","abs","dxy","map","add","Mapped","on","forEach","column","tile","cycle","dx","pop","unshift","bresenham","p0","p1","x0","x1","y0","y1","steps","delta","round","Direction","super","up","down","left","right","upLeft","upRight","downLeft","downRight","Fov","startx","starty","radius","checkSolid","markVisible","doubleRadius","dy","castLight","row","start","end","xx","xy","yx","yy","newStart","blocked","distance","deltaY","deltaX","currentX","currentY","leftSlope","rightSlope","doubleDistance","characteristics_Attribute","current","modifiers","modifier","increase","decrease","lodash","val","PositiveAttribute","currentValue","AttributeSet","attack","defense","dexterity","health","speed","pairSet","Modifier","weight","Characteristics","with","char","mod","addModifier","removeModifier","victim","dex","pow","misses","missile","regenerationValue","specie","constantIncrease","Usage","ItemGroup","internal_Item","group","usages","id","getId","lastId","creature","characteristics","item","inventoryItemId","GroupedItem","count","groupsWith","internal_ItemsBunch","bunch","find","invItem","inventoryItem","inv","groupedItem","put","Corpse","Consumable","Missile","Throw","BodyArmor","WearsOnBody","OneHandWeapon","WeaponOneHand","RightHandSlot","usage","useSingleItem","LeftHandSlot","BodySlot","MissileSlot","allInventorySlots","inventory_Inventory","parts","wearings","bag","inventorySlot","slot","wearing","matchingEquip","equipment","actor","onTakeOff","undefined","some","wearSlot","groupItem","putToBag","remove","onPutOn","Clan","Ability","allAbilities","keys","Specie","clan","abilities","creature_Phantom","refToReal","ability","Event","AttackEvent","subject","currentLevel","game","logger","missMessage","Reaction","DODGE","damage","damageTo","AddExperienceEvent","killMessage","die","DIE","hurtMessage","HURT","ThrowEvent","throwMisses","throwMissMessage","THROW_DODGE","throwDamageTo","throwKillMessage","throwHurtMessage","Player","levelUps","level","NOTHING","creature_Creature","ai","stageMemories","inventory","pos","previousLevel","addCreature","visionMask","removeCreature","at","addItem","wears","cares","event","affect","levelId","stage","previousPos","copy","act","nextPoint","phantom","stageMemory","resetVisible","memory_Memory","isSolid","degree","see","calc","visibleThrough","dead","professions","dest","move","FIRST_STEP","internal_AI","prevAI","destination","eq","path","leePath","nextTo","randomDestination","pointsToVisit","pointsToCheck","step","wavePoints","inRange","tangible","wrappers","dist","buildRoad","lastPoint","chain","dp","visit","tileVisited","visible","enemy","FreeForAll","PlayerOnlyEnemy","FollowTargetAI","foundNewTarget","goTo","onMove","onReach","onCantMove","moveTo","GoToTileAI","metaAI","matcher","attacker_Attacker","canAttack","firstTurn","victimInAccess","pickNewVictim","findCreature","enemies","real","condition","memory","chaser_Chaser","reset","victimId","victimSet","buildVictimPath","foundNewVictim","followTo","withinView","TileTypes","ScreenType","IdleInputKey","tile_Tile","kind","Floor","Wall","Door","StairwayDown","StairwayUp","items","isFloor","retrieve","clone","repository","Stairway","currentMap","leave","adjacentMap","enter","enterPos","Screen","type","inventory_screen_InventoryScreen","Inventory","positions","availableItems","filter","position","AITakeOffItem","screen","items_listing_PutOnItemsScreen","idle_screen_IdleScreen","Idle","Right","meta_ai_AIMoveEvent","Left","Down","Up","UpRight","UpLeft","DownRight","DownLeft","Handle","meta_ai_AIHandleEnvEvent","PickUp","meta_ai_AIPickUpItemsDialog","Drop","items_listing_DropItemsScreen","AIEvent","meta_ai_AIItemPickedEvent","whereToWear","AIPutOnItem","matches","weightModifier","reduce","acc","withWeight","f","direction","passibleThrough","ranIntoAnObstacle","go","howToHandle","noItemsToPickUp","meta_ai_AIPickUpItems","items_listing_PickUpScreen","tileItems","pickedUpItem","meta_ai_AIDropItems","removeFromBag","droppedItem","inSlot","takeOff","equip","putOn","meta_ai_MetaAI","aiToRun","events","resetEvents","dispatcher_Dispatcher","firstCallPatrol","escaper","escaper_Escaper","explorer","explorer_Explorer","chaser","attacker","picker","picker_Picker","patrol","patrol_Patrol","loiter","loiter_Loiter","thrower","thrower_Thrower","descender","descender_Descender","regenerateEvery","regenerate","runEvents","feelsGood","available","setAi","seesItems","pickItem","explore","healthCritical","rest","maximum","trackMovement","addNode","selfhealer_SelfHealer","STEP_DISTANCE","escapesFrom","foundEnemies","buildPath","minDistance","seen","NEW_POINT_EVERY","graph","graphlib","lastNodeVisit","markNodeVisited","currentNodeID","nodes","moveToTarget","targetNodeID","pickUpNewTarget","shouldAddNode","setNode","setEdge","node","seenLastID","seenLastStep","neighbors","nodeID","buildNewPath","player_ai_PlayerAI","profession_picking_screen_ProfessionPickingScreen","desiredItemId","can","findItem","pushEvent","atMax","canDescend","GoStairwayDown","Effect","onDone","ItemFlightEffect","frames","done","effect","patchMemory","Throwing","hasMissile","missiles","removeWearing","previousVictim","addEffect","obstacles","target","LogLevel","LogMessage","ts","message","logger_Logger","messages","debug","warning","addMessage","DEBUG","INFO","WARNING","DANGER","moment","timeline_Timeline","turns","element","parseInt","actors","map_LevelMap","creatures","timeline","addToMap","actorId","next","rebuildVision","Level","requires","currentExperience","doneLeveling","requiredExperience","exp","levelUp","MemoryTile","baseTile","each","game_Game","professionPicker","running","turn","pool_Pool","totalWeight","ceil","input","pick","pool","totalPool","Profession","points","talents","ProfessionPicker","Talent","depth","rank","maxRank","description","addDoors","addDoor","setTile","addItems","chance","itemsPool","centralize","minX","minY","maxX","maxY","addOnTile","match","onValid","iters","connectMaps","map1","map2","downTile","ux","uy","upTile","drawn","drawMap","charAt","THICKNESS","newRoomSpace","newCorridor","newWall","RAY_TURNS","DELTA_ANGLE","PI","dungeon_Room","rect","dungeon_Road","lined","hx","hy","horizontalLine","vx","vy","verticalLine","generator_dungeon","dimX","dimY","minSize","maxSize","roomsCount","dungeon","rooms","fill","_","generateRoom","normalize","ray","roads","buildRoads","pickedRooms","currentRoom","angle","cos","sin","roomToMove","ndx","ndy","every","room","notCross","pointWithin","connectedPoints","point1","point2","currentPoint","pointToConnect","currentDistance","items_listing_ItemsListingScreen","ItemsListing","initPositions","title","itemGroup","singleItemMode","console","log","ProfessionPicking","options","pickedProfession","playerProfession","profession","components_Loggervue_type_script_lang_ts","methods","record","format","components_Logger","_vm","ref","staticClass","_l","class","rowClass","_s","components_statsvue_type_script_lang_ts","aiName","displayAttribute","attribute","mods","join","stats","displayAttributeWithModifiers","unicodetiles_Tile","ch","g","b","br","bg","bb","grey","toString","other","CSSCLASS","NULLTILE","VERTEX_SHADER","FRAGMENT_SHADER","webGLRenderer","viewport","view","canvas","document","createElement","getContext","gl","elem","appendChild","charMap","charArray","defaultColors","attribs","buffer","itemSize","location","hint","STATIC_DRAW","texCoord","color","DYNAMIC_DRAW","bgColor","charIndex","offscreen","style","top","ctx","updateStyle","squarify","th","tw","vertexShader","compileShader","fragmentShader","program","createProgram","attachShader","linkProgram","deleteShader","getProgramParameter","LINK_STATUS","msg","getProgramInfoLog","deleteProgram","useProgram","getAttribLocation","initBuffers","resolutionLocation","getUniformLocation","uniform2f","tileCountsLocation","paddingLocation","texture","createTexture","bindTexture","TEXTURE_2D","cacheChars","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","activeTexture","TEXTURE0","setTimeout","buildTexture","render","pad","charCount","sqrt","fillStyle","fillRect","halfGap","gap","fillText","texImage2D","RGBA","UNSIGNED_BYTE","chars","build","changed","getComputedStyle","font","fontSize","lineHeight","fontFamily","textBaseline","measureText","backgroundColor","clear","COLOR_BUFFER_BIT","tiles","newChars","defaultColor","defaultBackground","k","kk","bindBuffer","ARRAY_BUFFER","bufferData","attrib","drawArrays","TRIANGLES","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","a","Float32Array","insertQuad","deleteBuffer","createBuffer","enableVertexAttribArray","vertexAttribPointer","FLOAT","arr","x2","y2","DEFAULT_GREY","IMPORTANT_GREY","DEFAULT_LIT","scene_tiles_DisplayTile","setBackground","setColor","ImportantTile","CreatureTile","vr","vg","vb","ItemTile","WEAPON","CORPSE","BODY_ARMOR","MISSILE","displayItem","HUMAN","HUMAN2","HUMAN3","HUMAN4","HUMAN5","RAT","DOOR","litColor","swapColors","WALL","litBackground","backgroundToColor","FLOOR","STAIRWAY_DOWN","STAIRWAY_UP","Scenevue_type_script_lang_ts_NULLTILE","nextItemAnimation","components_Scenevue_type_script_lang_ts","wholeMap","term","eng","drawInterval","Date","now","fps","counter","interval","components","Stats","frame","animationFps","itemId","renderer","cx","cy","innerHTML","className","indexOf","updateRenderer","getRendererString","str","len","unsafePut","$refs","scene","tileFunc","refreshCache","cacheEnabled","transitionDuration","cachex","cachey","tileCache","tileCache2","func","duration","transition","new_t","old_t","factor","halfw","halfh","transitionTimer","getTime","maskFunc","shaderFunc","timeNow","transTime","ixx","jyy","lookupx","lookupy","tempCache","getTile","setMaskFunc","setShaderFunc","time","lighting","clearInterval","setInterval","drawScene","update","lighted","fovTile","initViewport","watch","Scene","directives","rawName","expression","attrs","domProps","checked","isArray","_i","change","$event","$$a","$$el","$$c","$$i","concat","screens_IdleScreenvue_type_script_lang_ts","inputKey","onInput","close","screens_IdleScreen","screens_ProfessionPickingScreenvue_type_script_lang_ts","picked","doubleClickOption","iconPath","professionId","screens_ProfessionPickingScreen","option","click","dblclick","src","variant","_e","screens_ItemsListingScreenvue_type_script_lang_ts","page","perPage","selected","pickUpItems","index","selectAt","withItem","indexLetter","positionStatus","screens_ItemsListingScreen","positionSelected","baseConfig","weapons","newCreature","rat","orc","undead","robot","onisun_OnisunProfessionPicker","maxLevel","maxTaken","canUpdate","updatableProfession","canTakeNewProfession","newFromPool","excludeProfessions","excluding","OnisunTalentId","onisun_OnisunTalent","onisun_OnisunDefenderProfession","depthCost","AttackerTwoHandedWeapons","AttackerLightWeapons","AttackerHeavyWeapons","AttackerTwoWeapons","AttackerDoubleTwoHandedWeapons","AttackerStrongGrip","onisun_Onisun","generatorOptions","initPlayer","generateMap","playerSpecie","dagger","katana","rock","merge","screens_TalentsTreeScreenvue_type_script_lang_ts","pickedId","professionIndex","groups","talent","talentStatus","tip","talentId","screens_TalentsTreeScreen","card","model","callback","$$v","no-body","pickTalent","talentTip","triggers","container","screens_InventoryScreenvue_type_script_lang_ts","bodyPart","getChar","itemName","screens_InventoryScreen","availableStatus","displayBodyPart","itemWeight","components_Appvue_type_script_lang_ts","loopIntervalId","Logger","AbilitiesPicking","screenComponent","onEvent","main","loop","addEventListener","removeEventListener","App","tag","$set","for","composing","use","es","el","./af","./af.js","./ar","./ar-dz","./ar-dz.js","./ar-kw","./ar-kw.js","./ar-ly","./ar-ly.js","./ar-ma","./ar-ma.js","./ar-sa","./ar-sa.js","./ar-tn","./ar-tn.js","./ar.js","./az","./az.js","./be","./be.js","./bg","./bg.js","./bm","./bm.js","./bn","./bn.js","./bo","./bo.js","./br","./br.js","./bs","./bs.js","./ca","./ca.js","./cs","./cs.js","./cv","./cv.js","./cy","./cy.js","./da","./da.js","./de","./de-at","./de-at.js","./de-ch","./de-ch.js","./de.js","./dv","./dv.js","./el","./el.js","./en-au","./en-au.js","./en-ca","./en-ca.js","./en-gb","./en-gb.js","./en-ie","./en-ie.js","./en-il","./en-il.js","./en-nz","./en-nz.js","./eo","./eo.js","./es","./es-do","./es-do.js","./es-us","./es-us.js","./es.js","./et","./et.js","./eu","./eu.js","./fa","./fa.js","./fi","./fi.js","./fo","./fo.js","./fr","./fr-ca","./fr-ca.js","./fr-ch","./fr-ch.js","./fr.js","./fy","./fy.js","./gd","./gd.js","./gl","./gl.js","./gom-latn","./gom-latn.js","./gu","./gu.js","./he","./he.js","./hi","./hi.js","./hr","./hr.js","./hu","./hu.js","./hy-am","./hy-am.js","./id","./id.js","./is","./is.js","./it","./it.js","./ja","./ja.js","./jv","./jv.js","./ka","./ka.js","./kk","./kk.js","./km","./km.js","./kn","./kn.js","./ko","./ko.js","./ky","./ky.js","./lb","./lb.js","./lo","./lo.js","./lt","./lt.js","./lv","./lv.js","./me","./me.js","./mi","./mi.js","./mk","./mk.js","./ml","./ml.js","./mn","./mn.js","./mr","./mr.js","./ms","./ms-my","./ms-my.js","./ms.js","./mt","./mt.js","./my","./my.js","./nb","./nb.js","./ne","./ne.js","./nl","./nl-be","./nl-be.js","./nl.js","./nn","./nn.js","./pa-in","./pa-in.js","./pl","./pl.js","./pt","./pt-br","./pt-br.js","./pt.js","./ro","./ro.js","./ru","./ru.js","./sd","./sd.js","./se","./se.js","./si","./si.js","./sk","./sk.js","./sl","./sl.js","./sq","./sq.js","./sr","./sr-cyrl","./sr-cyrl.js","./sr.js","./ss","./ss.js","./sv","./sv.js","./sw","./sw.js","./ta","./ta.js","./te","./te.js","./tet","./tet.js","./tg","./tg.js","./th","./th.js","./tl-ph","./tl-ph.js","./tlh","./tlh.js","./tr","./tr.js","./tzl","./tzl.js","./tzm","./tzm-latn","./tzm-latn.js","./tzm.js","./ug-cn","./ug-cn.js","./uk","./uk.js","./ur","./ur.js","./uz","./uz-latn","./uz-latn.js","./uz.js","./vi","./vi.js","./x-pseudo","./x-pseudo.js","./yo","./yo.js","./zh-cn","./zh-cn.js","./zh-hk","./zh-hk.js","./zh-tw","./zh-tw.js","webpackContext","req","webpackContextResolve","e","Error","code","resolve"],"mappings":"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C,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,IACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,YAAA,GACAC,eAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,QAAA,GACAC,WAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,QAAA,GACAC,WAAA,GACAC,OAAA,GACAC,UAAA,GACAC,QAAA,GACAC,WAAA,GACAC,QAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,WAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,YAAA,GACAC,eAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,IAIA,SAAAC,EAAAC,GACA,IAAA3lC,EAAA4lC,EAAAD,GACA,OAAAzwC,EAAA8K,GAEA,SAAA4lC,EAAAD,GACA,IAAA3lC,EAAA/F,EAAA0rC,GACA,KAAA3lC,EAAA,IACA,IAAA6lC,EAAA,IAAAC,MAAA,uBAAAH,EAAA,KAEA,MADAE,EAAAE,KAAA,mBACAF,EAEA,OAAA7lC,EAEA0lC,EAAApiC,KAAA,WACA,OAAApP,OAAAoP,KAAArJ,IAEAyrC,EAAAM,QAAAJ,EACArwC,EAAAD,QAAAowC,EACAA,EAAA1lC,GAAA,yDC5QkS","file":"main.60f83495.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/onisun/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([196,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nimport { Tile, TileTypes } from '../map'\n\nexport default Vue.extend({\n  props: [\"cell\", 'player'],\n  computed: {\n    style() {\n      if (this.player) {\n        return 'player'\n      } else if (this.cell.isWall()) {\n        return 'wall'\n      } else if (this.cell.isDoor()) {\n        return 'door'\n      }\n\n      return 'floor'\n    },\n    symbol():any {\n      if (this.player) {\n        return '俺'\n      } else if (this.cell.display == ' ') {\n        return '・'\n      } else if (this.cell.display == '+') {\n        return '戸'\n      } else if (this.cell.display == '#') {\n        return '＃'\n      } else {\n        return 'E'\n      }\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./Cell.vue?vue&type=template&id=0a1e052e\"\nimport script from \"./Cell.vue?vue&type=script&lang=ts\"\nexport * from \"./Cell.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Cell.vue?vue&type=style&index=0&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_vm._v(\"\\n  :class=\\\"style\\\"\\n  v-text=\\\"symbol\\\"\\n  @click=\\\"$emit('setPosition')\\\"\\n\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class Rect {\n  // TODO: Validate?\n  constructor(\n    public x: number,\n    public y: number,\n    public w: number,\n    public h: number\n  ) {}\n\n  move(x: number, y: number): void {\n    this.x += x\n    this.y += y\n  }\n}\n\nexport const succ = function(c: string): string {\n  return String.fromCharCode(c.charCodeAt(0) + 1)\n}\n\nexport const rand = function(max: number): number {\n  return Math.floor(Math.random() * max)\n}\n\n/* tslint:disable no-any */\nexport const twoDimArray = function(\n  width: number,\n  height: number,\n  value: (x: number, y: number) => any\n): Array<Array<any>> {\n  let field = Array(width)\n\n  for (let i = 0; i < width; i++) {\n    field[i] = new Array(height)\n    for (let j = 0; j < height; j++) {\n      field[i][j] = value(i, j)\n    }\n  }\n\n  return field\n}\n\nexport const max = function(list: Array<number>): number {\n  return Math.max.apply(Math, list)\n}\n\nexport const min = function(list: Array<number>): number {\n  return Math.min.apply(Math, list)\n}\n\nexport class Point {\n  constructor(public x: number, public y: number) {}\n\n  public static readonly dxy = [\n    new Point(-1, -1),\n    new Point(0, -1),\n    new Point(1, -1),\n    new Point(-1, 0),\n    new Point(1, 0),\n    new Point(-1, 1),\n    new Point(0, 1),\n    new Point(1, 1),\n  ]\n\n  public eq(point: Point): boolean {\n    return this.x === point.x && this.y === point.y\n  }\n\n  public nextTo(point: Point): boolean {\n    return Math.abs(this.x - point.x) <= 1 && Math.abs(this.y - point.y) <= 1\n  }\n\n  public copy(): Point {\n    return new Point(this.x, this.y)\n  }\n\n  public add(point: Point): Point {\n    return new Point(this.x + point.x, this.y + point.y)\n  }\n\n  public wrappers(): Point[] {\n    return Point.dxy.map(point => this.add(point))\n  }\n}\n\nexport abstract class Mapped<T> {\n  public readonly width: number\n  public readonly height: number\n\n  constructor(public map: T[][]) {\n    this.width = map.length\n    this.height = map[0].length\n  }\n\n  public at(x, y): T {\n    return this.map[x][y]\n  }\n\n  public inRange(point: Point): boolean {\n    return (\n      point.x >= 0 &&\n      point.y >= 0 &&\n      point.x < this.width &&\n      point.y < this.height\n    )\n  }\n\n  public each(on: (T) => any): void {\n    this.map.forEach(column => {\n      column.forEach(tile => {\n        on(tile)\n      })\n    })\n  }\n}\n\nexport const cycle = function(list: any[], dx: number): any[] {\n  let x\n  if (dx > 0) {\n    for (let i = 0; i < dx; i++) {\n      x = list.pop()\n      list.unshift(x)\n    }\n  } else if (dx < 0) {\n    for (let i = dx; i < 0; i++) {\n      x = list.shift()\n      list.push(x)\n    }\n  }\n\n  return list\n}\n\nexport const bresenham = function(\n  p0: Point,\n  p1: Point,\n  on: (x, y) => void\n): void {\n  let [x0, x1, y0, y1] = [p0.x, p1.x, p0.y, p1.y]\n  let steps = Math.max(Math.abs(x0 - x1), Math.abs(y0 - y1))\n  const delta = new Point((x1 - x0) / steps, (y1 - y0) / steps)\n\n  while (steps > 1) {\n    x0 += delta.x\n    y0 += delta.y\n\n    on(Math.round(x0), Math.round(y0))\n\n    steps -= 1\n  }\n}\n\nexport class Direction extends Point {\n  private constructor(x, y) {\n    super(x, y)\n  }\n\n  static readonly up = new Direction(0, -1)\n  static readonly down = new Direction(0, 1)\n  static readonly left = new Direction(-1, 0)\n  static readonly right = new Direction(1, 0)\n\n  static readonly upLeft = new Direction(-1, -1)\n  static readonly upRight = new Direction(1, -1)\n  static readonly downLeft = new Direction(-1, 1)\n  static readonly downRight = new Direction(1, 1)\n}\n","export class Fov {\n  private doubleRadius: number\n\n  constructor(\n    private startx: number,\n    private starty: number,\n    private radius: number,\n    private width: number,\n    private height: number,\n    private checkSolid: (x: number, y: number) => boolean,\n    private markVisible: (x: number, y: number, degree: number) => void\n  ) {\n    this.doubleRadius = this.radius * this.radius\n  }\n\n  public calc(): void {\n    this.markVisible(this.startx, this.starty, 1)\n\n    if (!this.checkSolid(this.startx, this.starty)) {\n      ;[[1, 1], [1, -1], [-1, 1], [-1, -1]].forEach(([dx, dy]) => {\n        this.castLight(1, 1.0, 0.0, 0, dx, dy, 0)\n        this.castLight(1, 1.0, 0.0, dx, 0, 0, dy)\n      })\n    }\n  }\n\n  private castLight(\n    row: number,\n    start: number,\n    end: number,\n    xx: number,\n    xy: number,\n    yx: number,\n    yy: number\n  ) {\n    if (start < end) {\n      return\n    }\n\n    let newStart = 0.0\n    let blocked = false\n\n    for (let distance = row; distance <= this.radius && !blocked; distance++) {\n      let deltaY = -distance\n\n      for (let deltaX: number = -distance; deltaX <= 0; deltaX++) {\n        let currentX = Math.round(this.startx + deltaX * xx + deltaY * xy)\n        let currentY = Math.round(this.starty + deltaX * yx + deltaY * yy)\n        let leftSlope = (deltaX - 0.5) / (deltaY + 0.5)\n        let rightSlope = (deltaX + 0.5) / (deltaY - 0.5)\n\n        if (\n          !(\n            currentX >= 0 &&\n            currentY >= 0 &&\n            currentX < this.width &&\n            currentY < this.height\n          ) ||\n          start < rightSlope\n        ) {\n          continue\n        } else if (end > leftSlope) {\n          break\n        }\n\n        // check if it's within the lightable area and light if needed\n        if (this.doubleDistance(deltaX, deltaY) <= this.doubleRadius) {\n          this.markVisible(\n            currentX,\n            currentY,\n            1 - this.doubleDistance(deltaX, deltaY) / this.doubleRadius\n          )\n        }\n\n        if (blocked) {\n          // previous cell was a blocking one\n          if (this.checkSolid(currentX, currentY)) {\n            // hit a wall\n            newStart = rightSlope\n          } else {\n            blocked = false\n            start = newStart\n          }\n        } else {\n          if (this.checkSolid(currentX, currentY) && distance < this.radius) {\n            // hit a wall within sight line\n            blocked = true\n            this.castLight(distance + 1, start, leftSlope, xx, xy, yx, yy)\n            newStart = rightSlope\n          }\n        }\n      }\n    }\n  }\n\n  private doubleDistance(x: number, y: number): number {\n    return x * x + y * y\n  }\n}\n","import { remove, sum } from 'lodash'\nimport { Specie } from './creature'\nimport { Item } from './items'\n\nexport class Attribute {\n  public modifiers: number[] = []\n\n  constructor(protected max: number, protected current: number = max) {}\n\n  public maximum(): number {\n    return this.max\n  }\n\n  public atMax(): boolean {\n    return this.max === this.current\n  }\n\n  public decrease(modifier: number) {\n    this.current -= modifier\n  }\n\n  public increase(modifier: number) {\n    this.current = Math.min(this.current + modifier, this.max)\n  }\n\n  public constantIncrease(modifier: number) {\n    this.max += modifier\n    this.increase(modifier)\n  }\n\n  public constantDecrease(modifier: number) {\n    this.max -= modifier\n    this.decrease(modifier)\n  }\n\n  public addModifier(modifier: number) {\n    this.modifiers.push(modifier)\n  }\n\n  public removeModifier(modifier: number) {\n    remove(this.modifiers, val => val === modifier)\n  }\n\n  public currentValue(): number {\n    return this.current + sum(this.modifiers)\n  }\n}\n\nexport class PositiveAttribute extends Attribute {\n  public currentValue(): number {\n    const value = super.currentValue()\n    return value >= 1 ? value : 1\n  }\n\n  public constantDecrease(modifier: number) {\n    this.max = Math.max(1, this.max - modifier)\n    this.decrease(modifier)\n  }\n\n  public decrease(modifier: number) {\n    this.current = Math.max(1, this.current - modifier)\n  }\n}\n\nexport class AttributeSet<T> {\n  constructor(\n    public attack: T,\n    public defense: T,\n    public dexterity: T,\n    public health: T,\n    public radius: T,\n    public speed: T\n  ) {}\n\n  public with(pairSet: AttributeSet<any>, on: (first: T, second: any) => void) {\n    on(this.attack, pairSet.attack)\n    on(this.defense, pairSet.defense)\n    on(this.health, pairSet.health)\n    on(this.radius, pairSet.radius)\n    on(this.speed, pairSet.speed)\n  }\n}\n\nexport class Modifier extends AttributeSet<number> {\n  constructor({\n    attack = 0,\n    defense = 0,\n    dexterity = 0,\n    health = 0,\n    radius = 0,\n    speed = 0,\n  }) {\n    super(attack, defense, dexterity, health, radius, speed)\n  }\n\n  public withWeight(\n    pairSet: Modifier,\n    weight: Modifier,\n    on: (first: number, second: number, weight: number) => void\n  ) {\n    on(this.attack, pairSet.attack, weight.attack)\n    on(this.defense, pairSet.defense, weight.defense)\n    on(this.health, pairSet.health, weight.health)\n    on(this.radius, pairSet.radius, weight.radius)\n    on(this.speed, pairSet.speed, weight.speed)\n  }\n}\n\nexport class Characteristics extends AttributeSet<Attribute> {\n  constructor({ attack, defense, dexterity, health, radius, speed }) {\n    super(\n      new PositiveAttribute(attack),\n      new PositiveAttribute(defense),\n      new PositiveAttribute(dexterity),\n      new Attribute(health),\n      new PositiveAttribute(radius),\n      new PositiveAttribute(speed)\n    )\n  }\n\n  public addModifier(modifier: Modifier) {\n    this.with(modifier, (char, mod) => {\n      if (mod !== 0) {\n        char.addModifier(mod)\n      }\n    })\n  }\n\n  public removeModifier(modifier: Modifier) {\n    this.with(modifier, (char, mod) => {\n      if (mod !== 0) {\n        char.removeModifier(mod)\n      }\n    })\n  }\n\n  public damageTo(victim: Characteristics): number {\n    return Math.round(\n      (10 * this.attack.currentValue()) / victim.defense.currentValue()\n    )\n  }\n\n  public misses(victim: Characteristics): boolean {\n    let dex = this.dexterity.currentValue()\n\n    return (\n      Math.random() >\n      dex / (dex + Math.pow(victim.dexterity.currentValue() * 0.25, 0.8))\n    )\n  }\n\n  public throwMisses(victim: Characteristics): boolean {\n    return this.misses(victim)\n  }\n\n  public throwDamageTo(victim: Characteristics, missile: Item): number {\n    return 10\n  }\n\n  public regenerate(): void {\n    this.health.increase(this.regenerationValue())\n  }\n\n  protected regenerationValue(): number {\n    return 1\n  }\n\n  public regenerateEvery(): number {\n    return 8\n  }\n\n  public levelUp(specie: Specie) {\n    this.health.constantIncrease(3)\n\n    if (Math.random() > 0.5) {\n      this.attack.constantIncrease(1)\n    } else {\n      this.defense.constantIncrease(1)\n    }\n  }\n}\n","import { Specie, Creature } from '../creature'\nimport { Modifier } from '../characteristics'\n\nimport { remove } from 'lodash'\n\nexport enum Usage {\n  WeaponOneHand,\n  WearsOnBody,\n  Throw,\n}\n\nexport enum ItemGroup {\n  BodyArmor,\n  OneHandWeapon,\n  Consumable,\n  Missile,\n}\n\nexport type ItemId = number\n\nexport class Item {\n  private static lastId: ItemId = 0\n  public static getId(): ItemId {\n    return this.lastId++\n  }\n  public weight: number = 100\n\n  constructor(\n    public group: ItemGroup,\n    public name: string,\n    public readonly usages: Usage[] = [],\n    public readonly modifier: Modifier = new Modifier({}),\n    public id: ItemId = Item.getId()\n  ) {}\n\n  public clone(): Item {\n    return new Item(this.group, this.name)\n  }\n\n  public onPutOn(creature: Creature): void {\n    creature.characteristics.addModifier(this.modifier)\n  }\n\n  public onTakeOff(creature: Creature): void {\n    creature.characteristics.removeModifier(this.modifier)\n  }\n\n  public groupsWith(item: Item): boolean {\n    return this.name === item.name\n  }\n}\n\nlet inventoryItemId = 1\nexport class GroupedItem {\n  public id: number\n\n  constructor(public count: number, public item: Item) {\n    this.id = inventoryItemId++\n  }\n\n  public groupsWith(item: Item): boolean {\n    return this.item.groupsWith(item)\n  }\n}\n\nexport class ItemsBunch {\n  public bunch: GroupedItem[] = []\n\n  public find(item: Item): GroupedItem {\n    return this.bunch.find(invItem => invItem.groupsWith(item))\n  }\n\n  public remove(item: Item, count: number): void {\n    const invItem: GroupedItem = this.find(item)\n\n    if (!invItem) {\n      // TODO: Fail if removes item that's not in bunch yet?\n      return\n    } else if (invItem.count === count) {\n      remove(this.bunch, inventoryItem => inventoryItem.id === invItem.id)\n    } else {\n      invItem.count -= count\n    }\n  }\n\n  public put(item: Item, count: number): void {\n    const invItem = this.bunch.find(inv => inv.groupsWith(item))\n\n    if (invItem) {\n      invItem.count += count\n    } else {\n      this.bunch.push(new GroupedItem(count, item))\n    }\n  }\n\n  public clone(): ItemsBunch {\n    let bunch = new ItemsBunch()\n\n    this.bunch.forEach(groupedItem => {\n      bunch.put(groupedItem.item, groupedItem.count)\n    })\n\n    return bunch\n  }\n}\n\nexport class Corpse extends Item {\n  constructor(public readonly specie: Specie) {\n    super(ItemGroup.Consumable, `${specie.name}'s corpse`)\n  }\n}\n\nexport class Missile extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.Missile, name, [Usage.Throw], modifier)\n  }\n}\n\nexport class BodyArmor extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.BodyArmor, name, [Usage.WearsOnBody], modifier)\n  }\n}\n\nexport class OneHandWeapon extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.OneHandWeapon, name, [Usage.WeaponOneHand], modifier)\n  }\n}\n","import { Item, GroupedItem, ItemsBunch } from './items'\n\nimport { Usage } from './items/internal'\n\nimport { includes } from 'lodash'\nimport { Creature } from './creature'\n\nexport interface InventorySlot {\n  id: number // TODO: OMG do something with it\n  // What kind of items can be put in slot\n  usage: Usage\n  // Has to put only a single item or can put a bunch of them\n  useSingleItem: boolean\n}\n\nexport const RightHandSlot: InventorySlot = {\n  id: 1,\n  usage: Usage.WeaponOneHand,\n  useSingleItem: true,\n}\nexport const LeftHandSlot: InventorySlot = {\n  id: 2,\n  usage: Usage.WeaponOneHand,\n  useSingleItem: true,\n}\nexport const BodySlot: InventorySlot = {\n  id: 3,\n  usage: Usage.WearsOnBody,\n  useSingleItem: true,\n}\nexport const MissileSlot: InventorySlot = {\n  id: 4,\n  usage: Usage.Throw,\n  useSingleItem: false,\n}\n\nexport const allInventorySlots = [\n  RightHandSlot,\n  LeftHandSlot,\n  BodySlot,\n  MissileSlot,\n]\n// LeftHand,\n// Legs,\n// Finger,\n// Head,\n// Eye,\n// Neck,\n// Back,\n\n// MissileWeapon,\n\nexport type Wearing = {\n  inventorySlot: InventorySlot\n  equipment?: GroupedItem\n}\n\nexport class Inventory {\n  private wearings: Wearing[] = []\n  private bag: ItemsBunch = new ItemsBunch()\n\n  constructor(parts: InventorySlot[]) {\n    this.wearings = parts.map(inventorySlot => {\n      return { inventorySlot: inventorySlot }\n    })\n  }\n\n  public inSlot(slot: InventorySlot): GroupedItem {\n    const wearing = this.matchingEquip(slot)\n    return wearing && wearing.equipment\n  }\n\n  public removeWearing(\n    actor: Creature,\n    slot: InventorySlot,\n    count: number\n  ): void {\n    let wearing = this.matchingEquip(slot)\n\n    if (wearing && wearing.equipment) {\n      if (wearing.equipment.count === count) {\n        wearing.equipment.item.onTakeOff(actor)\n        wearing.equipment = undefined\n      } else {\n        wearing.equipment.count -= count\n      }\n    } else {\n      // TODO: fail here\n    }\n  }\n\n  public wears(): Wearing[] {\n    return this.wearings\n  }\n\n  public cares(): GroupedItem[] {\n    return this.bag.bunch\n  }\n\n  public canWear(item: Item) {\n    return this.wearings.some(wearing =>\n      includes(item.usages, wearing.inventorySlot.usage)\n    )\n  }\n\n  public matchingEquip(slot: InventorySlot): Wearing {\n    return this.wearings.find(wearSlot => wearSlot.inventorySlot.id === slot.id)\n  }\n\n  public equip(actor: Creature, slot: InventorySlot, item: Item) {\n    let wearing = this.matchingEquip(slot),\n      groupItem = this.bag.find(item)\n\n    if (wearing && groupItem) {\n      if (wearing.equipment) {\n        this.putToBag(wearing.equipment.item, wearing.equipment.count)\n        wearing.equipment.item.onTakeOff(actor)\n      }\n\n      // TODO: Check that can't equip more than have in inventory\n\n      const count = slot.useSingleItem ? 1 : groupItem.count\n      wearing.equipment = new GroupedItem(count, item)\n\n      this.bag.remove(item, count)\n      item.onPutOn(actor)\n    } else {\n      // TODO: fail here\n    }\n  }\n\n  public takeOff(actor: Creature, slot: InventorySlot): void {\n    const wearing = this.wearings.find(\n      wearing => wearing.inventorySlot === slot\n    )\n\n    if (wearing && wearing.equipment) {\n      this.putToBag(wearing.equipment.item, wearing.equipment.count)\n      wearing.equipment.item.onTakeOff(actor)\n      wearing.equipment = null\n    }\n\n    // TODO: Fail if nothing to remove?\n  }\n\n  public putToBag(item: Item, count: number): void {\n    this.bag.put(item, count)\n  }\n\n  public removeFromBag(item: Item, count: number): void {\n    this.bag.remove(item, count)\n  }\n}\n","import { Point } from './utils'\nimport { MetaAI } from './ai'\nimport { Fov } from './fov'\n\nimport {\n  Characteristics,\n  Corpse,\n  LevelMap,\n  LevelMapId,\n  Memory,\n} from '../engine'\nimport {\n  Inventory,\n  MissileSlot,\n  BodySlot,\n  RightHandSlot,\n  LeftHandSlot,\n} from './inventory'\n\nimport { Level } from './level'\nimport { includes } from 'lodash'\nimport { Item } from './items'\nimport { Profession } from './profession'\n\nexport enum Clan {\n  Player,\n  PlayerOnlyEnemy,\n  FreeForAll,\n}\n\nexport enum Ability {\n  GoStairwayDown,\n  Inventory,\n  PutOn,\n  Throwing,\n}\n\nexport const allAbilities = Object.keys(Ability).map(key => Ability[key])\n\nexport class Specie {\n  constructor(\n    public readonly name: string,\n    public readonly clan: Clan,\n    public readonly abilities: Ability[]\n  ) {}\n}\n\nexport type CreatureId = number\n\nexport class Phantom {\n  private static lastId: CreatureId = 0\n  public static getId(): CreatureId {\n    return this.lastId++\n  }\n\n  public refToReal?: Creature\n\n  constructor(public specie: Specie, public id: CreatureId = Phantom.getId()) {}\n\n  public name(): string {\n    return this.specie.name\n  }\n\n  public clan(): Clan {\n    return this.specie.clan\n  }\n\n  public clone(): Phantom {\n    return new Phantom(this.specie, this.id)\n  }\n\n  public real(): Creature {\n    return this.refToReal\n  }\n\n  public can(ability: Ability) {\n    return includes(this.specie.abilities, ability)\n  }\n}\n\nexport abstract class Event {\n  public abstract affect(subject: Creature): Reaction\n}\n\nexport class AttackEvent extends Event {\n  constructor(public actor: Creature) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (this.actor.characteristics.misses(subject.characteristics)) {\n      subject.currentLevel.game.logger.missMessage(this.actor, subject)\n      return Reaction.DODGE\n    }\n\n    const damage = this.actor.characteristics.damageTo(subject.characteristics)\n\n    if (damage >= subject.characteristics.health.currentValue()) {\n      this.actor.on(new AddExperienceEvent(subject))\n      subject.currentLevel.game.logger.killMessage(damage, this.actor, subject)\n      subject.die()\n      return Reaction.DIE\n    } else {\n      subject.characteristics.health.decrease(damage)\n      subject.currentLevel.game.logger.hurtMessage(damage, this.actor, subject)\n      return Reaction.HURT\n    }\n  }\n}\n\nexport class ThrowEvent extends Event {\n  constructor(public actor: Creature, public missile: Item) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (this.actor.characteristics.throwMisses(subject.characteristics)) {\n      subject.currentLevel.game.logger.throwMissMessage(\n        this.actor,\n        subject,\n        this.missile\n      )\n      return Reaction.THROW_DODGE\n    }\n\n    const damage = this.actor.characteristics.throwDamageTo(\n      subject.characteristics,\n      this.missile\n    )\n\n    if (damage >= subject.characteristics.health.currentValue()) {\n      this.actor.on(new AddExperienceEvent(subject))\n      subject.currentLevel.game.logger.throwKillMessage(\n        damage,\n        this.actor,\n        subject,\n        this.missile\n      )\n      subject.die()\n      return Reaction.DIE\n    } else {\n      subject.characteristics.health.decrease(damage)\n      subject.currentLevel.game.logger.throwHurtMessage(\n        damage,\n        this.actor,\n        subject,\n        this.missile\n      )\n      return Reaction.HURT\n    }\n  }\n}\n\nexport class AddExperienceEvent extends Event {\n  constructor(public actor: Creature) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (subject instanceof Player) {\n      subject.levelUps += subject.level.add(1)\n    }\n\n    return Reaction.NOTHING\n  }\n}\n\nexport enum Reaction {\n  DIE,\n  HURT,\n  DODGE,\n  THROW_DODGE,\n  NOTHING,\n}\n\nexport class Creature extends Phantom {\n  public ai: MetaAI\n  public stageMemories: { [key: string]: Memory } = {}\n  public currentLevel: LevelMap\n  public inventory: Inventory\n\n  public previousPos: Point\n  public previousLevel: LevelMap\n  public pos: Point\n\n  constructor(\n    public characteristics: Characteristics,\n    ai: MetaAI,\n    specie: Specie\n  ) {\n    super(specie)\n    this.ai = ai\n\n    this.inventory = new Inventory([\n      RightHandSlot,\n      LeftHandSlot,\n      BodySlot,\n      MissileSlot,\n    ])\n  }\n\n  public addToMap(pos: Point, level: LevelMap) {\n    this.pos = pos\n    this.previousLevel = this.currentLevel\n    this.currentLevel = level\n    level.addCreature(this)\n    this.visionMask(level)\n  }\n\n  public die(): void {\n    this.currentLevel.removeCreature(this)\n\n    let tile = this.currentLevel.at(this.pos.x, this.pos.y)\n    tile.addItem(new Corpse(this.specie), 1)\n\n    this.inventory.wears().forEach(({ equipment }) => {\n      if (equipment) {\n        tile.addItem(equipment.item, equipment.count)\n      }\n    })\n\n    this.inventory.cares().forEach(invItem => {\n      tile.addItem(invItem.item, invItem.count)\n    })\n  }\n\n  public on(event: Event): Reaction {\n    return event.affect(this)\n  }\n\n  public real(): Creature {\n    return this\n  }\n\n  public speed(): number {\n    return this.characteristics.speed.currentValue()\n  }\n\n  public radius(): number {\n    return this.characteristics.radius.currentValue()\n  }\n\n  public stageMemory(levelId: LevelMapId = this.currentLevel.id): Memory {\n    return this.stageMemories[levelId]\n  }\n\n  public act(stage: LevelMap) {\n    this.visionMask(stage)\n    this.previousPos = this.pos.copy()\n    this.ai.act(this, true)\n\n    let previousPosLevel = this.previousLevel || this.currentLevel\n    previousPosLevel.at(\n      this.previousPos.x,\n      this.previousPos.y\n    ).creature = undefined\n    this.currentLevel.at(this.pos.x, this.pos.y).creature = this\n\n    this.previousLevel = undefined\n  }\n\n  public move(nextPoint: Point) {\n    this.pos = nextPoint.copy()\n  }\n\n  public clone(): Phantom {\n    let phantom = new Phantom(this.specie, this.id)\n    phantom.refToReal = this\n    return phantom\n  }\n\n  public visionMask(stage: LevelMap): void {\n    if (!this.stageMemories[stage.id]) {\n      this.stageMemories[stage.id] = new Memory(stage.width, stage.height)\n    } else {\n      this.stageMemory().resetVisible()\n    }\n\n    const see = (x: number, y: number, degree: number): void => {\n      this.stageMemory()\n        .at(x, y)\n        .see(stage.at(x, y), degree)\n    }\n\n    new Fov(\n      this.pos.x,\n      this.pos.y,\n      this.radius(),\n      stage.width,\n      stage.height,\n      this.isSolid(stage),\n      see\n    ).calc()\n  }\n\n  private isSolid(stage: LevelMap): (x: number, y: number) => boolean {\n    return (x: number, y: number) => {\n      if (stage.visibleThrough(x, y)) {\n        return false\n      } else {\n        return !(\n          stage.at(x, y).isDoor() &&\n          this.pos.x === x &&\n          this.pos.y === y\n        )\n      }\n    }\n  }\n}\n\nexport class Player extends Creature {\n  public dead: boolean = false\n\n  public levelUps: number = 0\n  public professions: Profession[] = []\n\n  constructor(\n    public level: Level,\n    characteristics: Characteristics,\n    ai: MetaAI,\n    specie: Specie\n  ) {\n    super(characteristics, ai, specie)\n  }\n\n  public act(stage: LevelMap): void {\n    super.act(stage)\n    // TODO: Simplify this? No need to move here\n  }\n\n  public move(dest: Point) {\n    super.move(dest)\n\n    let previousPosLevel = this.previousLevel || this.currentLevel\n    previousPosLevel.at(\n      this.previousPos.x,\n      this.previousPos.y\n    ).creature = undefined\n    this.currentLevel.at(this.pos.x, this.pos.y).creature = this\n\n    this.previousLevel = undefined\n  }\n\n  public die(): void {\n    super.die() // We do not want player to act after they death\n    this.dead = true\n  }\n\n  public rebuildVision(): void {\n    this.visionMask(this.currentLevel)\n  }\n}\n","import { Point, twoDimArray } from '../utils'\nimport { Creature, Phantom, Clan } from '../creature'\n\nimport { sample } from 'lodash'\nimport { MetaAI } from './meta_ai'\nimport { MemoryTile } from '../memory'\n\nconst FIRST_STEP: number = 1\n\ntype AIId = number\n\nexport abstract class AI {\n  private static lastId: AIId = 0\n  public static getId(): AIId {\n    return this.lastId++\n  }\n\n  constructor(public prevAI?: MetaAI, public id: AIId = AI.getId()) {}\n\n  public abstract act(actor: Creature, firstTurn: boolean): void\n\n  public abstract available(actor: Creature): boolean\n\n  public reset(): void {}\n\n  protected moveTo(actor: Creature, destination: Point): boolean {\n    // TODO: Rethink of it\n    if (actor.pos.eq(destination)) {\n      return true\n    }\n\n    const path = this.leePath(actor, point => destination.eq(point))\n\n    if (path.length) {\n      actor.move(path[0])\n    }\n\n    return !!path.length\n  }\n\n  protected followTo(actor: Creature, destination: Point): boolean {\n    const path = this.leePath(actor, point => destination.nextTo(point))\n\n    if (path.length) {\n      actor.move(path[0])\n    }\n\n    return !!path.length\n  }\n\n  protected leePath(\n    actor: Creature,\n    destination: (point: Point, tile: MemoryTile) => boolean,\n    randomDestination: boolean = false\n  ): Point[] {\n    const map = actor.stageMemory()\n\n    let stageMemory: number[][] = twoDimArray(\n      map.width,\n      map.height,\n      () => undefined\n    )\n    let pointsToVisit: Point[] = []\n    let pointsToCheck: Point[] = [actor.pos]\n\n    let step = 0\n    while (pointsToCheck.length && !pointsToVisit.length) {\n      let wavePoints: Array<Point> = []\n\n      pointsToCheck.forEach((point: Point) => {\n        if (!map.inRange(point)) {\n          return\n        }\n\n        const tile = map.at(point.x, point.y)\n        // TODO: Compare, current value might be lower\n        if (\n          tile.tangible(actor) ||\n          stageMemory[point.x][point.y] !== undefined\n        ) {\n          return\n        }\n\n        stageMemory[point.x][point.y] = step\n        if (destination(point, tile)) {\n          pointsToVisit.push(point)\n        } else {\n          point.wrappers().forEach(dist => wavePoints.push(dist))\n        }\n      })\n      step++\n\n      pointsToCheck = wavePoints\n    }\n\n    if (pointsToVisit.length) {\n      if (randomDestination) {\n        return this.buildRoad(sample(pointsToVisit), stageMemory)\n      } else {\n        return this.buildRoad(pointsToVisit[0], stageMemory)\n      }\n    } else {\n      return []\n    }\n  }\n\n  private buildRoad(point: Point, stageMemory: number[][]): Point[] {\n    let lastPoint = point\n    let chain = [lastPoint]\n\n    let delta: Point = undefined\n\n    while (stageMemory[lastPoint.x][lastPoint.y] !== FIRST_STEP) {\n      delta = Point.dxy.find(\n        (dp): boolean => {\n          return (\n            stageMemory[lastPoint.x + dp.x] &&\n            stageMemory[lastPoint.x + dp.x][lastPoint.y + dp.y] ===\n              stageMemory[lastPoint.x][lastPoint.y] - 1\n          )\n        }\n      )\n\n      if (!delta) {\n        return []\n      }\n\n      lastPoint = lastPoint.add(delta)\n\n      chain.unshift(lastPoint)\n    }\n\n    return chain\n  }\n\n  protected withinView(\n    actor: Creature,\n    visit: (point: Point, tile: MemoryTile) => void\n  ): void {\n    const map = actor.stageMemory()\n\n    let tileVisited: boolean[][] = twoDimArray(\n      map.width,\n      map.height,\n      () => false\n    )\n    let pointsToCheck: Point[] = [actor.pos]\n\n    while (pointsToCheck.length) {\n      let wavePoints: Array<Point> = []\n\n      pointsToCheck.forEach((point: Point) => {\n        if (!map.inRange(point)) {\n          return\n        }\n\n        const tile = map.at(point.x, point.y)\n        if (!tile.visible || tileVisited[point.x][point.y]) {\n          return\n        }\n\n        tileVisited[point.x][point.y] = true\n\n        visit(point, tile)\n\n        point.wrappers().forEach(dist => wavePoints.push(dist))\n      })\n\n      pointsToCheck = wavePoints\n    }\n  }\n\n  public enemies(actor: Phantom, enemy: Phantom): boolean {\n    if (actor.id === enemy.id) {\n      return false\n    }\n\n    if (actor.clan() === Clan.FreeForAll || enemy.clan() === Clan.FreeForAll) {\n      return true\n    }\n\n    if (actor.clan() === Clan.Player && enemy.clan() === Clan.PlayerOnlyEnemy) {\n      return true\n    }\n\n    if (enemy.clan() === Clan.Player && actor.clan() === Clan.PlayerOnlyEnemy) {\n      return true\n    }\n\n    return false\n  }\n}\n\nexport abstract class FollowTargetAI extends AI {\n  public destination: Point = undefined\n\n  public available(actor: Creature): boolean {\n    return this.foundNewTarget(actor) || !!this.destination\n  }\n\n  public act(actor: Creature): void {\n    if (!this.destination) {\n      throw `FollowTargetAI's act got called when there is no destination!`\n    }\n\n    if (this.goTo(actor)) {\n      this.onMove(actor)\n      // If got the destination\n      if (this.destination.eq(actor.pos)) {\n        this.destination = undefined\n        this.onReach(actor)\n      }\n    } else {\n      // If can not move\n      this.destination = undefined\n      this.onCantMove(actor)\n    }\n  }\n\n  public reset(): void {\n    this.destination = undefined\n  }\n\n  protected goTo(actor: Creature): boolean {\n    return this.moveTo(actor, this.destination)\n  }\n\n  protected abstract foundNewTarget(actor: Creature): boolean\n  protected onMove(actor: Creature): void {}\n  protected onReach(actor: Creature): void {}\n  protected onCantMove(actor: Creature): void {}\n}\n\nexport abstract class GoToTileAI extends FollowTargetAI {\n  constructor(\n    metaAI: MetaAI,\n    protected matcher: (tile: MemoryTile) => boolean\n  ) {\n    super(metaAI)\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    const path = this.leePath(actor, (point, tile) => this.matcher(tile), true)\n\n    if (path.length) {\n      this.destination = path.pop()\n      return true\n    } else {\n      return false\n    }\n  }\n}\n","import { AI } from './internal'\nimport { Phantom, Creature, Reaction, AttackEvent } from '../creature'\n\nexport class Attacker extends AI {\n  public victim?: Creature\n\n  public available(actor: Creature): boolean {\n    return this.canAttack(actor)\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    if (this.victimInAccess(actor)) {\n      this.attack(actor)\n    } else {\n      if (!firstTurn) {\n        throw 'Attacker got called twice'\n      }\n\n      this.pickNewVictim(actor)\n      this.act(actor, false)\n    }\n  }\n\n  protected attack(actor: Creature) {\n    if (this.victim.on(new AttackEvent(actor)) === Reaction.DIE) {\n      this.victim = undefined\n    }\n  }\n\n  private canAttack(actor: Creature): boolean {\n    const creature = this.findCreature(actor, creature =>\n      this.enemies(actor, creature)\n    )\n    return !!creature\n  }\n\n  private victimInAccess(actor: Creature): boolean {\n    if (this.victim === undefined) {\n      return false\n    }\n\n    const creature = this.findCreature(\n      actor,\n      creature => creature.id === this.victim.id\n    )\n    return !!creature\n  }\n\n  private pickNewVictim(actor: Creature) {\n    this.victim = this.findCreature(actor, creature =>\n      this.enemies(actor, creature)\n    ).real()\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): Phantom {\n    const memory = actor.stageMemory()\n    return actor.pos\n      .wrappers()\n      .map(({ x, y }) => memory.at(x, y).creature())\n      .find(creature => creature && condition(creature))\n  }\n}\n","import { FollowTargetAI } from './internal'\nimport { Phantom, Creature, CreatureId } from '../creature'\nimport { Point } from '../utils'\n\nexport class Chaser extends FollowTargetAI {\n  private victimId?: CreatureId\n\n  public reset(): void {\n    super.reset()\n    this.victimId = undefined\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    // Is there a victim and a path to it?\n    return (\n      (this.victimSet() && this.buildVictimPath(actor)) ||\n      this.foundNewVictim(actor)\n    )\n  }\n\n  protected onCantMove(): void {\n    this.victimId = undefined\n  }\n\n  protected onReach(): void {\n    this.victimId = undefined\n  }\n\n  private victimSet(): boolean {\n    return !!this.victimId\n  }\n\n  protected goTo(actor: Creature): boolean {\n    return this.followTo(actor, this.destination)\n  }\n\n  private buildVictimPath(actor: Creature): boolean {\n    return this.findCreature(actor, creature => creature.id === this.victimId)\n  }\n\n  private foundNewVictim(actor: Creature): boolean {\n    // Found new victim and built path to it\n    return (\n      this.findCreature(actor, creature => this.enemies(actor, creature)) &&\n      this.buildVictimPath(actor)\n    )\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): boolean {\n    let result: boolean = false\n\n    this.withinView(actor, ({ x, y }, tile) => {\n      const creature = tile.creature()\n\n      if (!result && creature && condition(creature)) {\n        this.destination = new Point(x, y)\n        this.victimId = creature.id\n        result = true\n      }\n    })\n\n    return result\n  }\n}\n","import { Phantom, Creature } from './creature'\nimport { Item } from './items'\nimport { Point } from './utils'\nimport { LevelMap } from './map'\nimport { ItemsBunch } from './items/internal'\n\nexport enum TileTypes {\n  Wall,\n  Door,\n  Floor,\n  StairwayDown,\n  StairwayUp,\n}\n\nexport class Tile {\n  public creature?: Phantom\n  public items: ItemsBunch\n\n  private static repository: { [key: string]: Tile } = {}\n\n  public static retrieve(key: string): Tile {\n    switch (key) {\n      case 'R':\n        return new Tile('R', ' ', TileTypes.Floor)\n      case 'C':\n        return new Tile('C', ' ', TileTypes.Floor)\n      case 'W':\n        return new Tile('W', '#', TileTypes.Wall)\n      case 'D':\n        return new Tile('D', '+', TileTypes.Door)\n      case '>':\n        return new Tile('>', '>', TileTypes.StairwayDown)\n      case '<':\n        return new Tile('<', '<', TileTypes.StairwayUp)\n      default:\n        throw `Tile '${key}' is not registered!`\n    }\n  }\n\n  protected constructor(\n    public key: string,\n    public display: string,\n    public kind: TileTypes\n  ) {}\n\n  public addItem(item: Item, count: number): void {\n    if (!this.items) {\n      this.items = new ItemsBunch()\n    }\n\n    this.items.put(item, count)\n  }\n\n  public isDoor(): boolean {\n    return this.kind === TileTypes.Door\n  }\n\n  public isWall(): boolean {\n    return this.kind === TileTypes.Wall\n  }\n\n  public isFloor(): boolean {\n    return this.kind === TileTypes.Floor\n  }\n\n  public isStairway(): boolean {\n    return (\n      this.kind === TileTypes.StairwayDown || this.kind === TileTypes.StairwayUp\n    )\n  }\n\n  public visibleThrough(): boolean {\n    return (\n      this.isFloor() ||\n      this.kind === TileTypes.StairwayDown ||\n      this.kind === TileTypes.StairwayUp\n    )\n  }\n\n  public passibleThrough(actor?: Creature): boolean {\n    if (actor && this.creature) {\n      return this.kind !== TileTypes.Wall && this.creature.id === actor.id\n    }\n\n    return this.kind !== TileTypes.Wall && !this.creature\n  }\n\n  public clone(): Tile {\n    let tile = Tile.retrieve(this.key)\n    if (this.creature) {\n      tile.creature = this.creature.clone()\n    }\n    tile.items = this.items && this.items.clone()\n    return tile\n  }\n\n  protected uniq(): boolean {\n    return this.creature !== undefined\n  }\n}\n\nabstract class Stairway extends Tile {\n  protected currentMap: LevelMap\n  protected adjacentMap: LevelMap\n  protected enterPos: Point\n\n  public go(actor: Creature): void {\n    this.currentMap.leave(actor)\n    this.adjacentMap.enter(actor, this.enterPos)\n\n    this.adjacentMap.game.currentMap = this.adjacentMap\n  }\n}\n\nexport class StairwayDown extends Stairway {\n  constructor(\n    protected currentMap: LevelMap,\n    protected adjacentMap: LevelMap,\n    protected enterPos: Point\n  ) {\n    super('>', '>', TileTypes.StairwayDown)\n  }\n}\n\nexport class StairwayUp extends Stairway {\n  constructor(\n    protected currentMap: LevelMap,\n    protected adjacentMap: LevelMap,\n    protected enterPos: Point\n  ) {\n    super('<', '<', TileTypes.StairwayUp)\n  }\n}\n","import { Game } from '../game'\nimport { Player } from '../creature'\n\nexport enum ScreenType {\n  ProfessionPicking,\n  Idle,\n  AbilitiesPicking,\n  Inventory,\n  ItemsListing,\n}\n\nexport abstract class Screen {\n  public player: Player\n\n  constructor(public readonly type: ScreenType, protected game: Game) {\n    this.player = this.game.player\n  }\n\n  public build() {}\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  AIMoveEvent,\n  Direction,\n  AIHandleEnvEvent,\n  AIPickUpItemsDialog,\n  DropItemsScreen,\n} from '../../engine'\nimport { InventoryScreen } from './inventory_screen'\n\nexport enum IdleInputKey {\n  Right,\n  Left,\n  Down,\n  Up,\n\n  UpRight,\n  UpLeft,\n  DownRight,\n  DownLeft,\n\n  Handle,\n\n  Inventory,\n  PickUp,\n  Drop,\n}\n\nexport class IdleScreen extends Screen {\n  constructor(game: Game) {\n    super(ScreenType.Idle, game)\n  }\n\n  public onInput(key: IdleInputKey) {\n    // TODO: Shouldn't be done here, move to every command\n    this.game.screen = undefined\n\n    switch (key) {\n      case IdleInputKey.Right:\n        return new AIMoveEvent(Direction.right, this.game).act()\n      case IdleInputKey.Left:\n        return new AIMoveEvent(Direction.left, this.game).act()\n      case IdleInputKey.Down:\n        return new AIMoveEvent(Direction.down, this.game).act()\n      case IdleInputKey.Up:\n        return new AIMoveEvent(Direction.up, this.game).act()\n\n      case IdleInputKey.UpRight:\n        return new AIMoveEvent(Direction.upRight, this.game).act()\n      case IdleInputKey.UpLeft:\n        return new AIMoveEvent(Direction.upLeft, this.game).act()\n      case IdleInputKey.DownRight:\n        return new AIMoveEvent(Direction.downRight, this.game).act()\n      case IdleInputKey.DownLeft:\n        return new AIMoveEvent(Direction.downLeft, this.game).act()\n\n      case IdleInputKey.Handle:\n        return new AIHandleEnvEvent(this.game).act()\n\n      case IdleInputKey.PickUp:\n        return new AIPickUpItemsDialog(this.game).act()\n\n      case IdleInputKey.Drop:\n        this.game.screen = new DropItemsScreen(this.game)\n        return\n\n      case IdleInputKey.Inventory:\n        this.game.screen = new InventoryScreen(this.game)\n        return\n    }\n  }\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  AITakeOffItem,\n  Item,\n  InventorySlot,\n  GroupedItem,\n  PutOnItemsScreen,\n} from '../../engine'\nimport { IdleScreen } from './idle_screen'\n\nimport { includes } from 'lodash'\n\ninterface InventoryPosition {\n  inventorySlot: InventorySlot\n  item: Item\n  count: number\n  availableItems: GroupedItem[]\n}\n\nexport class InventoryScreen extends Screen {\n  public positions: InventoryPosition[] = []\n\n  constructor(game: Game) {\n    super(ScreenType.Inventory, game)\n\n    const cares = this.player.inventory.cares()\n\n    this.positions = this.player.inventory\n      .wears()\n      .map(({ inventorySlot, equipment }) => {\n        return {\n          inventorySlot: inventorySlot,\n          item: equipment && equipment.item,\n          count: equipment && equipment.count,\n          availableItems: cares.filter(groupedItem =>\n            includes(groupedItem.item.usages, inventorySlot.usage)\n          ),\n        }\n      })\n  }\n\n  public takeOff(position: InventoryPosition) {\n    new AITakeOffItem(position.inventorySlot, this.game).act()\n    this.game.screen = null\n  }\n\n  public putOn(position: InventoryPosition) {\n    this.game.screen = new PutOnItemsScreen(\n      position.inventorySlot,\n      position.availableItems,\n      this.game\n    )\n  }\n\n  public close() {\n    this.game.screen = new IdleScreen(this.game)\n  }\n}\n","import { AI } from './internal'\nimport { Creature, Player, AttackEvent } from '../creature'\nimport { ItemsBunch, Item, GroupedItem } from '../items/internal'\nimport { Direction } from '../utils'\nimport { StairwayDown, StairwayUp, Tile } from '../tile'\nimport { Logger } from '../logger'\nimport {\n  Game,\n  Wearing,\n  allInventorySlots,\n  Modifier,\n  PickUpScreen,\n} from '../../engine'\n\nimport { compact, flatten } from 'lodash'\nimport { IdleScreen } from '../screens/idle_screen'\nimport { InventorySlot } from '../inventory'\n\nexport abstract class AIEvent {\n  protected logger: Logger\n  protected player: Player\n\n  constructor(protected game: Game) {\n    this.player = game.player\n    this.logger = game.logger\n  }\n\n  public abstract act(): void\n\n  protected tile(): Tile {\n    return this.player.currentLevel.at(this.player.pos.x, this.player.pos.y)\n  }\n}\n\nexport class AIItemPickedEvent extends AIEvent {\n  constructor(public items: ItemsBunch, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    this.player.inventory.cares().forEach(item => {\n      const wearing = this.whereToWear(item.item)\n\n      if (wearing) {\n        // TODO: Use matching slot\n        new AIPutOnItem(wearing.inventorySlot, item.item, this.game).act()\n      }\n    })\n  }\n\n  private whereToWear(item: Item): Wearing {\n    const matches: Wearing[] = compact(\n      flatten(\n        item.usages.map(usage =>\n          allInventorySlots.filter(slot => slot.usage === usage)\n        )\n      ).map(slot => this.player.inventory.matchingEquip(slot))\n    )\n\n    if (matches.length === 0) {\n      return null\n    }\n\n    const weightModifier = new Modifier({\n      attack: 1,\n      defense: 1,\n      health: 1,\n      radius: 0.5,\n      speed: 1,\n    })\n\n    const { wearing } = matches.reduce(\n      (acc, wearing) => {\n        let weight = 0\n\n        if (wearing.equipment) {\n          item.modifier.withWeight(\n            wearing.equipment.item.modifier,\n            weightModifier,\n            (f, s, w) => (weight += w * (f - s))\n          )\n        } else {\n          item.modifier.with(weightModifier, (f, w) => (weight += f * w))\n        }\n\n        if (acc.weight > weight) {\n          return acc\n        } else {\n          return { weight, wearing }\n        }\n      },\n      { weight: 0, wearing: null }\n    )\n\n    return wearing\n  }\n}\n\nexport class AIMoveEvent extends AIEvent {\n  constructor(public direction: Direction, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    const stage = this.player.currentLevel,\n      dest = this.player.pos.add(this.direction),\n      tile = stage.at(dest.x, dest.y)\n\n    if (tile.passibleThrough(this.player)) {\n      this.player.move(dest)\n    } else if (tile.creature) {\n      tile.creature.real().on(new AttackEvent(this.player))\n    } else {\n      this.game.logger.ranIntoAnObstacle()\n    }\n  }\n}\n\nexport class AIHandleEnvEvent extends AIEvent {\n  public act(): void {\n    const tile = this.tile()\n\n    if (tile instanceof StairwayDown || tile instanceof StairwayUp) {\n      tile.go(this.player)\n    } else {\n      this.player.currentLevel.game.logger.howToHandle()\n    }\n  }\n}\n\nexport class AIPickUpItemsDialog extends AIEvent {\n  public act(): void {\n    const items = this.tile().items,\n      game = this.player.currentLevel.game\n\n    switch ((items && items.bunch.length) || 0) {\n      case 0:\n        game.logger.noItemsToPickUp()\n        game.screen = new IdleScreen(this.game)\n        return\n      case 1:\n        new AIPickUpItems(items.bunch, this.game).act()\n        return\n      default:\n        game.screen = new PickUpScreen(game)\n        return\n    }\n  }\n}\n\nexport class AIPickUpItems extends AIEvent {\n  constructor(private items: GroupedItem[], game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    if (!this.items.length) {\n      this.game.screen = new IdleScreen(this.game)\n    }\n\n    let tileItems = this.tile().items\n\n    this.items.forEach(({ item, count }) => {\n      this.player.inventory.putToBag(item, count)\n      this.game.logger.pickedUpItem(item, count)\n      tileItems.remove(item, count)\n    })\n\n    this.game.screen = undefined\n  }\n}\n\nexport class AIDropItems extends AIEvent {\n  constructor(private items: GroupedItem[], game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    if (!this.items.length) {\n      this.game.screen = new IdleScreen(this.game)\n    }\n\n    let tile = this.tile()\n\n    this.items.forEach(({ item, count }) => {\n      this.player.inventory.removeFromBag(item, count)\n      this.game.logger.droppedItem(item, count)\n      tile.addItem(item, count)\n    })\n\n    this.game.screen = undefined\n  }\n}\n\nexport class AITakeOffItem extends AIEvent {\n  constructor(private slot: InventorySlot, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    // TODO: assert slot is not empty\n    const groupedItem = this.player.inventory.inSlot(this.slot)\n    this.player.inventory.takeOff(this.player, this.slot)\n    this.logger.takeOff(groupedItem.item)\n  }\n}\n\nexport class AIPutOnItem extends AIEvent {\n  constructor(private slot: InventorySlot, private item: Item, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    this.player.inventory.equip(this.player, this.slot, this.item)\n    this.logger.putOn(this.item)\n  }\n}\n\nexport abstract class MetaAI extends AI {\n  constructor(public aiToRun: AI = null) {\n    super()\n  }\n  protected events: AIEvent[] = []\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n\n  public pushEvent(event: AIEvent) {\n    this.events.push(event)\n  }\n\n  protected resetEvents(): void {\n    this.events = []\n  }\n\n  public runEvents(player: Player): void {\n    this.events.forEach(event => {\n      event.act()\n    })\n\n    this.resetEvents()\n  }\n}\n","import {\n  AI,\n  Attacker,\n  Chaser,\n  Escaper,\n  Explorer,\n  Loiter,\n  Picker,\n  Patrol,\n  SelfHealer,\n  Descender,\n  Thrower,\n} from '../ai'\nimport { Creature } from '../creature'\nimport { MetaAI } from './meta_ai'\n\nexport class Dispatcher extends MetaAI {\n  private escaper: Escaper\n  private explorer: Explorer\n  private chaser: Chaser\n  private attacker: Attacker\n  private picker: Picker\n  private patrol: Patrol\n  private loiter: Loiter\n  private thrower: Thrower\n\n  private descender: Descender\n\n  private firstCallPatrol: boolean = true\n\n  private step: number = 0\n\n  constructor() {\n    super()\n    this.escaper = new Escaper(this)\n    this.explorer = new Explorer(this)\n    this.chaser = new Chaser(this)\n    this.attacker = new Attacker(this)\n    this.picker = new Picker(this)\n    this.patrol = new Patrol(this)\n    this.loiter = new Loiter(this)\n    this.thrower = new Thrower(this)\n\n    this.descender = new Descender(this)\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    // Never dispatch twice\n    if (!firstTurn) {\n      throw 'Meta AI called recursively'\n    }\n\n    this.step += 1\n\n    if (this.step % actor.characteristics.regenerateEvery() === 0) {\n      actor.characteristics.regenerate()\n    }\n\n    this.runEvents(actor)\n\n    if (this.feelsGood(actor)) {\n      if (this.attacker.available(actor)) {\n        this.setAi(this.attacker)\n      } else if (this.thrower.available(actor)) {\n        this.setAi(this.thrower)\n      } else if (this.chaser.available(actor)) {\n        this.setAi(this.chaser)\n      } else if (this.seesItems(actor)) {\n        this.pickItem(actor)\n      } else {\n        this.explore(actor)\n      }\n    } else if (this.healthCritical(actor) && this.escaper.available(actor)) {\n      this.setAi(this.escaper)\n    } else if (this.attacker.available(actor)) {\n      this.setAi(this.attacker)\n    } else if (this.thrower.available(actor)) {\n      this.setAi(this.thrower)\n    } else if (this.chaser.available(actor)) {\n      this.setAi(this.chaser)\n    } else {\n      this.rest(actor)\n    }\n\n    this.resetEvents()\n    this.aiToRun.act(actor, firstTurn)\n  }\n\n  private feelsGood(actor: Creature): boolean {\n    return (\n      actor.characteristics.health.currentValue() >\n      actor.characteristics.health.maximum() * 0.9\n    )\n  }\n\n  private healthCritical(actor: Creature): boolean {\n    return (\n      actor.characteristics.health.currentValue() <\n      actor.characteristics.health.maximum() / 4\n    )\n  }\n\n  private seesItems(actor: Creature): boolean {\n    return this.picker.available(actor)\n  }\n\n  private pickItem(actor: Creature): void {\n    this.setAi(this.picker)\n  }\n\n  private explore(actor: Creature): void {\n    if (this.explorer.available(actor)) {\n      this.patrol.trackMovement(actor)\n      this.setAi(this.explorer)\n    } else if (this.descender.available(actor)) {\n      this.setAi(this.descender)\n    } else if (this.patrol.available(actor)) {\n      if (this.firstCallPatrol) {\n        this.firstCallPatrol = false\n        this.patrol.addNode(actor.pos.x, actor.pos.y)\n      }\n      this.setAi(this.patrol)\n    } else {\n      this.setAi(this.loiter)\n    }\n  }\n\n  private rest(actor: Creature): void {\n    this.setAi(new SelfHealer(this))\n  }\n\n  private setAi(ai: AI): void {\n    if (this.aiToRun && this.aiToRun.id !== ai.id) {\n      this.aiToRun.reset()\n    }\n\n    this.aiToRun = ai\n  }\n}\n","import { FollowTargetAI } from './internal'\nimport { Phantom, Creature } from '../creature'\n\nimport { sumBy } from 'lodash'\nimport { Point } from '../../engine'\n\nconst STEP_DISTANCE = 2\n\nexport class Escaper extends FollowTargetAI {\n  private escapesFrom: [Point, Phantom][] = []\n\n  protected foundNewTarget(actor: Creature): boolean {\n    return this.foundEnemies(actor) && this.buildPath(actor)\n  }\n\n  private buildPath(\n    actor: Creature,\n    minDistance: number = actor.radius() / 2\n  ): boolean {\n    if (minDistance <= 1) {\n      this.destination = undefined\n      return false\n    }\n\n    const path = this.leePath(\n      actor,\n      ({ x, y }) => {\n        const score = sumBy(this.escapesFrom, ([pos, enemy]) => {\n          // I don't use pathfinding since it should try\n          // to run away from those who are visible, so the path\n          // to them should be straightforward.\n          return Math.max(Math.abs(x - pos.x), Math.abs(y - pos.y))\n        })\n\n        return score >= minDistance\n      },\n      true\n    )\n\n    if (path.length) {\n      this.destination = path.pop()\n      return true\n    } else {\n      return this.buildPath(actor, minDistance - STEP_DISTANCE)\n    }\n  }\n\n  private foundEnemies(actor: Creature): boolean {\n    this.escapesFrom = []\n\n    this.withinView(actor, (point, tile) => {\n      const creature = tile.creature()\n\n      if (creature && this.enemies(actor, creature)) {\n        this.escapesFrom.push([point, creature])\n      }\n    })\n\n    return this.escapesFrom.length > 0\n  }\n}\n","import { GoToTileAI } from '../ai'\nimport { MetaAI } from './meta_ai'\n\nexport class Explorer extends GoToTileAI {\n  constructor(metaAI: MetaAI) {\n    super(metaAI, tile => !tile.seen)\n  }\n}\n","import { AI } from './internal'\nimport { Creature } from '../creature'\n\nexport class Loiter extends AI {\n  // private turns: number = 0\n\n  act(actor: Creature, firstTurn: boolean = true): void {\n    // if (this.turns > 1) {\n    //   actor.ai = this.prevAI\n    //   this.prevAI.act(actor, false)\n    //   return\n    // }\n\n    const path = this.leePath(actor, point => !actor.pos.eq(point), true)\n\n    if (path.length) {\n      // this.turns += 1\n      actor.move(path[0])\n    }\n  }\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n}\n","import { AI } from './internal'\n\nimport { Point, succ } from '../utils'\nimport { Creature } from '../creature'\n\nimport * as graphlib from 'graphlib'\nimport { Loiter } from './loiter'\nimport { MetaAI } from './meta_ai'\n\ntype NodeID = string\n\nconst NEW_POINT_EVERY: number = 10\n\nexport class Patrol extends AI {\n  private i: NodeID\n  private graph: graphlib.Graph\n  private lastNodeVisit: { [key: string]: number }\n  private currentNodeID: NodeID\n  private targetNodeID: NodeID\n  private path: Point[]\n  private step: number = NEW_POINT_EVERY\n\n  constructor(ai: MetaAI) {\n    super(ai)\n    this.i = 'a'\n\n    this.graph = new graphlib.Graph()\n\n    this.lastNodeVisit = {}\n\n    this.markNodeVisited(this.currentNodeID)\n    this.path = []\n  }\n\n  public available(actor: Creature): boolean {\n    return this.graph.nodes().length > 1\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    if (this.path.length) {\n      this.moveToTarget(actor, firstTurn)\n    } else {\n      if (this.targetNodeID) {\n        this.markNodeVisited(this.targetNodeID)\n        this.currentNodeID = this.targetNodeID\n      }\n\n      this.pickUpNewTarget(actor)\n      this.moveToTarget(actor, firstTurn)\n    }\n    this.step += 1\n  }\n\n  public reset(): void {\n    this.path = []\n  }\n\n  public trackMovement(actor: Creature): void {\n    if (this.step >= NEW_POINT_EVERY || this.shouldAddNode(actor)) {\n      this.addNode(actor.pos.x, actor.pos.y)\n    }\n    this.step += 1\n  }\n\n  // TODO: If close enough to another node, use it instead.\n  public addNode(x: number, y: number): void {\n    this.graph.setNode(this.i, new Point(x, y))\n    if (this.currentNodeID && this.currentNodeID !== this.i) {\n      this.graph.setEdge(this.currentNodeID, this.i)\n    }\n    this.currentNodeID = this.i\n    this.i = succ(this.i)\n    this.step = 0\n  }\n\n  private buildNewPath(actor: Creature): void {\n    const pos: Point = this.graph.node(this.targetNodeID)\n\n    this.path = this.leePath(actor, point => pos.eq(point))\n  }\n\n  private pickUpNewTarget(actor: Creature): void {\n    let seenLastID: NodeID = this.graph.nodes()[0]\n    let seenLastStep: number = this.lastNodeVisit[seenLastID]\n\n    this.graph.neighbors(this.currentNodeID).forEach((nodeID: NodeID) => {\n      if (seenLastStep > (this.lastNodeVisit[nodeID] || 0)) {\n        seenLastID = nodeID\n        seenLastStep = this.lastNodeVisit[seenLastID]\n      }\n    })\n\n    this.targetNodeID = seenLastID\n    this.buildNewPath(actor)\n  }\n\n  private moveToTarget(actor: Creature, firstTurn: boolean): void {\n    const nextPoint: Point = this.path.shift()\n\n    if (!nextPoint) {\n      if (firstTurn) {\n        this.path = []\n        this.act(actor, false)\n      } else {\n        new Loiter(this.prevAI).act(actor, firstTurn)\n      }\n    } else if (\n      actor\n        .stageMemory()\n        .at(nextPoint.x, nextPoint.y)\n        .tangible()\n    ) {\n      this.buildNewPath\n\n      if (this.path.length) {\n        return this.act(actor, false)\n      }\n    } else {\n      actor.move(nextPoint)\n    }\n  }\n\n  private markNodeVisited(nodeID: NodeID): void {\n    this.lastNodeVisit[nodeID] = this.step\n  }\n\n  private shouldAddNode(actor: Creature): boolean {\n    return actor\n      .stageMemory()\n      .at(actor.previousPos.x, actor.previousPos.y)\n      .tile.isDoor()\n  }\n}\n","import { MetaAI } from './meta_ai'\nimport { Player } from '../creature'\nimport { IdleScreen, ProfessionPickingScreen } from '../../engine'\n\nexport class PlayerAI extends MetaAI {\n  public act(player: Player): void {\n    const game = player.currentLevel.game\n\n    // this.runEvents(player)\n    game.screen = new IdleScreen(game)\n\n    if (player.levelUps > 0) {\n      player.currentLevel.game.screen = new ProfessionPickingScreen(game)\n    }\n  }\n}\n","import { FollowTargetAI } from '../ai'\nimport { Creature, Ability } from '../creature'\nimport { Item, ItemId } from '../items'\nimport { Point } from '../utils'\nimport { AIItemPickedEvent } from './meta_ai'\n\nexport class Picker extends FollowTargetAI {\n  private desiredItemId: ItemId = null\n\n  public available(actor: Creature): boolean {\n    return actor.can(Ability.Inventory) && super.available(actor)\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    return (\n      this.findItem(actor, item => item.id === this.desiredItemId) ||\n      this.findItem(actor, item => true)\n    )\n  }\n\n  protected onReach(actor: Creature): void {\n    const tile = actor.currentLevel.at(actor.pos.x, actor.pos.y)\n    this.prevAI.pushEvent(\n      new AIItemPickedEvent(tile.items, actor.currentLevel.game)\n    )\n\n    tile.items.bunch.forEach(groupedItem => {\n      actor.inventory.putToBag(groupedItem.item, groupedItem.count)\n    })\n\n    tile.items = undefined\n\n    this.desiredItemId = null\n  }\n\n  private findItem(\n    actor: Creature,\n    condition: (item: Item) => boolean\n  ): boolean {\n    let result: boolean = false\n\n    this.withinView(actor, ({ x, y }, tile) => {\n      if (!tile.items()) {\n        return\n      }\n\n      const item = tile\n        .items()\n        .bunch.find(groupedItem => condition(groupedItem.item))\n\n      if (item && !result) {\n        this.desiredItemId = item.id\n        this.destination = new Point(x, y)\n        result = true\n      }\n    })\n\n    return result\n  }\n}\n","import { AI } from '../ai'\nimport { Creature } from '../creature'\n\nexport class SelfHealer extends AI {\n  public available(actor: Creature): boolean {\n    return !actor.characteristics.health.atMax()\n  }\n\n  public act(actor: Creature): void {\n    // Does nothing, just waiting\n    // actor.characteristics.regenerate()\n  }\n}\n","import { GoToTileAI, MetaAI } from '../ai'\nimport { Ability, Creature, StairwayDown, TileTypes } from '../../engine'\n\nexport class Descender extends GoToTileAI {\n  private canDescend: boolean = false\n\n  constructor(metaAI: MetaAI) {\n    super(metaAI, tile => tile.tile.kind === TileTypes.StairwayDown)\n  }\n\n  public available(actor: Creature): boolean {\n    return actor.can(Ability.GoStairwayDown) && super.available(actor)\n  }\n\n  public reset(): void {\n    super.reset()\n    this.canDescend = false\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    // When we are on a stairway\n    this.canDescend = this.matcher(\n      actor.stageMemory().at(actor.pos.x, actor.pos.y)\n    )\n\n    if (this.canDescend) {\n      this.destination = actor.pos\n      return true\n    } else {\n      return super.foundNewTarget(actor)\n    }\n  }\n\n  protected onReach(actor: Creature) {\n    // Should stay here at least for a turn\n    const tile = actor.currentLevel.at(actor.pos.x, actor.pos.y)\n    if (this.canDescend && tile instanceof StairwayDown) {\n      tile.go(actor)\n    }\n  }\n}\n","import { Item } from './items/internal'\nimport { Point } from './utils'\nimport { Memory } from './memory'\n\nexport abstract class Effect {\n  constructor(public onDone: () => void) {}\n\n  public abstract done(): boolean\n  public abstract patchMemory(memory: Memory): void\n  public speed(): number {\n    return -1\n  }\n}\n\nexport class ItemFlightEffect extends Effect {\n  constructor(\n    public readonly item: Item,\n    private frames: Point[],\n    onDone: () => void\n  ) {\n    super(onDone)\n  }\n\n  public patchMemory(memory: Memory): void {\n    if (this.done()) {\n      return\n    }\n\n    const [point] = this.frames.splice(0, 1)\n    const tile = memory.at(point.x, point.y)\n\n    if (tile.visible) {\n      tile.effect = '-'\n    } else {\n      // Skipping effect if it's not visible\n      this.patchMemory(memory)\n    }\n  }\n\n  public done(): boolean {\n    return this.frames.length === 0\n  }\n}\n","import { AI } from './internal'\nimport {\n  Creature,\n  Ability,\n  CreatureId,\n  Phantom,\n  Reaction,\n  ThrowEvent,\n} from '../creature'\nimport { Usage, Item, GroupedItem } from '../items/internal'\nimport { Point, bresenham } from '../utils'\nimport { ItemFlightEffect } from '../effect'\nimport { MissileSlot, Wearing } from '../inventory'\n\nexport class Thrower extends AI {\n  public victim: Creature\n  public previousVictim: Creature\n  public missiles: GroupedItem\n\n  public available(actor: Creature): boolean {\n    return (\n      actor.can(Ability.Throwing) &&\n      this.hasMissile(actor) &&\n      this.canAttack(actor)\n    )\n  }\n\n  public act(actor: Creature): void {\n    const missile = this.missiles.item\n    actor.inventory.removeWearing(actor, MissileSlot, 1)\n\n    let path = []\n\n    bresenham(actor.pos, this.victim.pos, (x, y) => path.push(new Point(x, y)))\n\n    const effect = new ItemFlightEffect(missile, path, () => {\n      if (this.victim.on(new ThrowEvent(actor, missile)) === Reaction.DIE) {\n        this.victim = undefined\n        this.previousVictim = undefined\n      }\n    })\n\n    actor.currentLevel.addEffect(effect)\n  }\n\n  private hasMissile(actor: Creature): boolean {\n    this.missiles = actor.inventory.inSlot(MissileSlot)\n    return this.missiles !== undefined\n  }\n\n  private canAttack(actor: Creature): boolean {\n    this.previousVictim = this.victim\n    this.victim = undefined\n\n    if (this.previousVictim) {\n      if (\n        this.findCreature(\n          actor,\n          creature => this.previousVictim.id === creature.id\n        )\n      ) {\n        return true\n      }\n    }\n\n    return this.findCreature(actor, creature => this.enemies(actor, creature))\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): boolean {\n    this.withinView(actor, (point, tile) => {\n      const creature = tile.creature()\n\n      if (\n        !this.victim &&\n        creature &&\n        condition(creature) &&\n        !this.obstacles(actor, point)\n      ) {\n        this.victim = actor.currentLevel.at(point.x, point.y).creature.real()\n      }\n    })\n\n    return !!this.victim\n  }\n\n  private obstacles(actor: Creature, target: Point): boolean {\n    let obstacles = false\n\n    bresenham(actor.pos, target, (x, y) => {\n      obstacles =\n        obstacles ||\n        actor\n          .stageMemory()\n          .at(x, y)\n          .tangible(actor)\n    })\n\n    return obstacles\n  }\n}\n","import * as moment from 'moment'\nimport { Creature } from './creature'\nimport { Moment } from 'moment'\nimport { Item } from './items/internal'\n\nexport enum LogLevel {\n  DEBUG,\n  INFO,\n  WARNING,\n  DANGER,\n}\n\nexport class LogMessage {\n  constructor(\n    public level: LogLevel,\n    public ts: Moment,\n    public message: string\n  ) {}\n}\n\nexport class Logger {\n  public messages: LogMessage[] = []\n\n  public hurtMessage(damage: number, actor: Creature, target: Creature) {\n    this.debug(`${target.name()} got ${damage} damage from ${actor.name()}`)\n  }\n\n  public killMessage(damage: number, actor: Creature, target: Creature) {\n    this.warning(\n      `${target.name()} got ${damage} damage from ${actor.name()} causes them to die`\n    )\n  }\n\n  public missMessage(actor: Creature, target: Creature) {\n    this.debug(`${actor.name()} misses ${target.name()}!`)\n  }\n\n  public throwMissMessage(actor: Creature, target: Creature, missile: Item) {\n    this.debug(\n      `${actor.name()} throws ${missile.name} in ${target.name()}, but misses!`\n    )\n  }\n\n  public throwKillMessage(\n    damage: number,\n    actor: Creature,\n    target: Creature,\n    missile: Item\n  ) {\n    this.warning(\n      `${target.name()} got ${damage} damage from ${actor.name()} by ${\n        missile.name\n      } causes them to die`\n    )\n  }\n\n  public throwHurtMessage(\n    damage: number,\n    actor: Creature,\n    target: Creature,\n    missile: Item\n  ) {\n    this.debug(\n      `${target.name()} got ${damage} damage from ${actor.name()} by ${\n        missile.name\n      }`\n    )\n  }\n\n  public ranIntoAnObstacle(): void {\n    this.addMessage(LogLevel.DEBUG, 'You ran into a wall')\n  }\n\n  public howToHandle(): void {\n    this.addMessage(LogLevel.DEBUG, \"Don't know how to handle it\")\n  }\n\n  public noItemsToPickUp(): void {\n    this.addMessage(LogLevel.DEBUG, \"You don't see anything to pick up\")\n  }\n\n  public takeOff(item: Item): void {\n    this.addMessage(LogLevel.DEBUG, `You took off ${item.name}`)\n  }\n\n  public putOn(item: Item): void {\n    this.addMessage(LogLevel.DEBUG, `You put on ${item.name}`)\n  }\n\n  public pickedUpItem(item: Item, count: number): void {\n    if (count === 1) {\n      this.addMessage(LogLevel.INFO, `You picked up ${item.name}`)\n    } else {\n      this.addMessage(LogLevel.INFO, `You picked up ${count} ${item.name}`)\n    }\n  }\n\n  public droppedItem(item: Item, count: number): void {\n    if (count === 1) {\n      this.addMessage(LogLevel.INFO, `You dropped a ${item.name}`)\n    } else {\n      this.addMessage(LogLevel.INFO, `You dropped ${count} ${item.name}`)\n    }\n  }\n\n  protected debug(message: string): void {\n    this.addMessage(LogLevel.DEBUG, message)\n  }\n\n  protected info(message: string): void {\n    this.addMessage(LogLevel.INFO, message)\n  }\n\n  protected warning(message: string): void {\n    this.addMessage(LogLevel.WARNING, message)\n  }\n\n  protected danger(message: string): void {\n    this.addMessage(LogLevel.DANGER, message)\n  }\n\n  protected addMessage(level: LogLevel, message: string): void {\n    this.messages.push(new LogMessage(level, moment(), message))\n  }\n}\n","import { forEach, keys, min, remove, size, pullAt } from 'lodash'\n\nexport class Timeline<T> {\n  private step: number = 0\n  private turns: { [key: number]: T[] } = {}\n\n  public add(item: T, delta: number): void {\n    const ts = this.step + delta\n\n    if (this.turns[ts]) {\n      this.turns[ts].push(item)\n    } else {\n      this.turns[ts] = [item]\n    }\n  }\n\n  public remove(item: T): void {\n    forEach(this.turns, (value, key) => {\n      remove(value, element => element === item)\n    })\n  }\n\n  public next(): T {\n    this.step = min(keys(this.turns).map(x => parseInt(x)))\n\n    const [element] = pullAt(this.turns[this.step], 0)\n\n    if (this.turns[this.step].length === 0) {\n      delete this.turns[this.step]\n    }\n\n    return element\n  }\n\n  public actors(): T[] {\n    if (size(this.turns) === 0) {\n      return []\n    }\n\n    this.step = min(keys(this.turns).map(x => parseInt(x)))\n    const actors = this.turns[this.step]\n\n    delete this.turns[this.step]\n\n    return actors\n  }\n}\n","import { Creature, CreatureId } from './creature'\nimport { Mapped, Point } from './utils'\nimport { Timeline } from './timeline'\nimport { Game } from './game'\nimport { Tile } from './tile'\n\nimport { remove } from 'lodash'\nimport { Effect } from '../engine'\n\nexport type LevelMapId = number\n\nexport type TimeEvent = [CreatureId, Effect]\n\nexport class LevelMap extends Mapped<Tile> {\n  public creatures: Creature[] = []\n  public id: LevelMapId\n  public game: Game\n  public timeline: Timeline<TimeEvent>\n\n  private static lastId: LevelMapId = 0\n  public static getId(): LevelMapId {\n    return this.lastId++\n  }\n\n  constructor(map: Tile[][]) {\n    super(map)\n    this.id = LevelMap.getId()\n    this.timeline = new Timeline()\n  }\n\n  public reset(): void {\n    this.timeline = new Timeline()\n  }\n\n  public leave(actor: Creature): void {\n    this.reset()\n    this.removeCreature(actor)\n  }\n\n  public enter(actor: Creature, enterPos: Point): void {\n    this.reset()\n    this.creatures.forEach(creature =>\n      this.timeline.add([creature.id, undefined], creature.speed())\n    )\n\n    actor.addToMap(enterPos, this)\n  }\n\n  public addCreature(creature: Creature) {\n    this.creatures.push(creature)\n    // TODO fail if taken\n    this.at(creature.pos.x, creature.pos.y).creature = creature\n    this.timeline.add([creature.id, undefined], creature.speed())\n  }\n\n  public removeCreature(creature: Creature) {\n    let tile = this.at(creature.pos.x, creature.pos.y)\n    tile.creature = undefined\n    remove(this.creatures, c => c.id === creature.id)\n    this.timeline.remove([creature.id, undefined])\n  }\n\n  public visibleThrough(x: number, y: number): boolean {\n    return this.map[x][y].visibleThrough()\n  }\n\n  public passibleThrough(x: number, y: number): boolean {\n    return this.map[x][y].passibleThrough()\n  }\n\n  public setTile(x: number, y: number, tile: Tile): void {\n    this.map[x][y] = tile\n  }\n\n  public addEffect(effect: Effect): void {\n    this.timeline.add([undefined, effect], effect.speed())\n  }\n\n  public turn(): void {\n    const [actorId, effect] = this.timeline.next()\n\n    if (actorId !== undefined) {\n      const actor = this.creatures.find(creature => actorId === creature.id)\n\n      if (actor) {\n        actor.act(this)\n\n        // If they are still on a map\n        if (this.creatures.find(creature => actorId === creature.id)) {\n          this.timeline.add([actorId, undefined], actor.speed())\n        }\n      }\n\n      this.game.player.rebuildVision()\n    } else if (effect) {\n      if (effect.done()) {\n        effect.onDone()\n      } else {\n        this.timeline.add([undefined, effect], effect.speed())\n      }\n\n      this.game.player.rebuildVision()\n      effect.patchMemory(this.game.player.stageMemory())\n    } else {\n      throw 'Timeline event is empty!'\n    }\n  }\n}\n","export class Level {\n  public current: number = 1\n  public currentExperience: number = 0\n  public requiredExperience: number\n\n  private doneLeveling: boolean = false\n\n  constructor(private requires: number[]) {\n    this.requiredExperience = this.requires[0]\n  }\n\n  public add(exp: number): number {\n    if (this.doneLeveling) {\n      return\n    }\n\n    this.currentExperience += exp\n\n    let levelUps = 0\n\n    while (\n      !this.doneLeveling &&\n      this.currentExperience >= this.requiredExperience\n    ) {\n      levelUps += 1\n      this.levelUp()\n    }\n\n    return levelUps\n  }\n\n  protected levelUp(): void {\n    this.current += 1\n\n    let level = this.requires[this.current - 1]\n\n    if (level) {\n      this.currentExperience -= this.requiredExperience\n      this.requiredExperience = level\n    } else {\n      this.currentExperience = this.requiredExperience\n      this.doneLeveling = true\n    }\n  }\n}\n","import { Tile } from './tile'\nimport { Creature, Phantom, twoDimArray } from '../engine'\nimport { ItemsBunch } from './items/internal'\nimport { Mapped } from './utils'\n\nexport class MemoryTile {\n  public visible: boolean = false\n  public degree: number = 0\n  public seen: boolean = false\n  public effect?: string\n\n  constructor(public tile?: Tile) {}\n\n  public see(tile: Tile, degree: number) {\n    this.visible = true\n    this.degree = degree\n    this.seen = true\n    this.tile = tile.clone()\n  }\n\n  public items(): ItemsBunch {\n    return this.tile.items\n  }\n\n  public tangible(actor?: Creature): boolean {\n    return this.seen && !this.tile.passibleThrough(actor)\n  }\n\n  public creature(): Phantom {\n    return this.tile && this.tile.creature\n  }\n\n  public reset(): void {\n    this.visible = false\n    this.effect = undefined\n    this.tile.creature = undefined\n  }\n}\n\nexport class Memory extends Mapped<MemoryTile> {\n  constructor(width: number, height: number) {\n    const baseTile = Tile.retrieve('W')\n    super(twoDimArray(width, height, () => new MemoryTile(baseTile)))\n  }\n\n  public resetVisible(): void {\n    this.each(tile => tile.reset())\n  }\n}\n","import { Logger, LevelMap, Player, Screen } from '../engine'\nimport { ProfessionPicker } from './profession'\n\nexport abstract class Game {\n  public logger: Logger = new Logger()\n  public currentMap: LevelMap\n  public player: Player\n  public screen: Screen\n  public running: boolean = false\n\n  constructor(public professionPicker: ProfessionPicker) {\n    this.screen = null\n  }\n\n  public turn() {\n    if (this.running || this.screen) {\n      return\n    }\n\n    this.player.ai.runEvents(this.player)\n\n    this.running = true\n\n    while (!this.player.dead && !this.screen) {\n      this.player.currentLevel.turn()\n    }\n\n    this.running = false\n  }\n}\n","import { random } from 'lodash'\n\nexport class Pool<Input, Output> {\n  private totalWeight: number = 0\n  private items: [number, (Input) => Output][] = []\n\n  constructor(items: [number, (Input) => Output][]) {\n    items.forEach(([weight, item]) => this.add(weight, item))\n  }\n\n  public add(weight: number, item: (Input) => Output): void {\n    if (weight < 1) {\n      throw `Item's weight is lower than 1`\n    }\n\n    this.items.push([weight, item])\n    this.totalWeight += Math.ceil(weight)\n  }\n\n  public pick(input: Input): Output {\n    if (this.items.length === 0) {\n      throw 'Tried to use empty pool'\n    }\n\n    let pick = random(this.totalWeight)\n\n    return this.items.find(([weight, item]) => {\n      pick -= weight\n\n      return pick <= 0\n    })[1](input)\n  }\n\n  public merge(pool: Pool<Input, Output>): Pool<Input, Output> {\n    let totalPool = new Pool<Input, Output>([])\n\n    this.items.forEach(([weight, item]) => totalPool.add(weight, item))\n    pool.items.forEach(([weight, item]) => totalPool.add(weight, item))\n\n    return totalPool\n  }\n}\n","import { Player } from './creature'\n\nexport class Profession {\n  public talents: Talent[] = []\n\n  constructor(\n    public readonly id: number,\n    public readonly name: string,\n    public level: number = 1,\n    public points: number = 0\n  ) {}\n}\n\nexport abstract class ProfessionPicker {\n  public abstract available(player: Player): Profession[]\n}\n\nexport abstract class Talent {\n  constructor(\n    public readonly name: string,\n    public readonly depth: number,\n    public rank: number,\n    public readonly maxRank: number,\n    public readonly description: string\n  ) {}\n}\n","import { LevelMap, Tile, StairwayDown, StairwayUp, Item } from '../../engine'\nimport { Pool } from '../pool'\nimport { Creature } from '../creature'\nimport { Point, cycle } from '../utils'\n\nimport { random } from 'lodash'\n\nexport const addDoors = function(\n  level: LevelMap,\n  addDoor: () => boolean = () => true\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width; i++) {\n      const tile = level.at(i, j),\n        up = level.at(i, j - 1),\n        down = level.at(i, j + 1),\n        left = level.at(i - 1, j),\n        right = level.at(i + 1, j)\n\n      if (!addDoor() || tile.key !== 'C') {\n        continue\n      }\n\n      if (\n        left.key === 'D' ||\n        right.key === 'D' ||\n        up.key === 'D' ||\n        down.key === 'D'\n      ) {\n        continue\n      }\n\n      if (\n        left.key !== 'R' &&\n        right.key !== 'R' &&\n        up.key !== 'R' &&\n        down.key !== 'R'\n      ) {\n        continue\n      }\n\n      if (\n        (left.key === 'W' && right.key === 'W') ||\n        (up.key === 'W' && down.key === 'W')\n      ) {\n        level.setTile(i, j, Tile.retrieve('D'))\n      }\n    }\n  }\n\n  return level\n}\n\nexport const addCreatures = function(\n  chance: number,\n  level: LevelMap,\n  creaturesPool: Pool<null, Creature>\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      if (level.at(i, j).passibleThrough() && Math.random() < chance) {\n        creaturesPool.pick(null).addToMap(new Point(i, j), level)\n      }\n    }\n  }\n\n  return level\n}\n\nexport const addItems = function(\n  chance: number,\n  level: LevelMap,\n  itemsPool: Pool<null, Item>\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      const tile = level.at(i, j)\n      if (tile.passibleThrough() && Math.random() < chance) {\n        tile.addItem(itemsPool.pick(null), 1)\n      }\n    }\n  }\n\n  return level\n}\n\nexport const centralize = function(level: LevelMap): LevelMap {\n  let minX = level.width,\n    minY = level.height,\n    maxX = 0,\n    maxY = 0\n\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      if (!level.at(i, j).passibleThrough()) {\n        continue\n      }\n\n      maxY = Math.max(j, maxY)\n      maxX = Math.max(i, maxX)\n      minY = Math.min(j, minY)\n      minX = Math.min(i, minX)\n    }\n  }\n\n  const dx = Math.floor((level.width - (maxX - minX)) / 2) - minX,\n    dy = Math.floor((level.height - (maxY - minY)) / 2) - minY\n\n  cycle(level.map, dx)\n  level.map.forEach(row => cycle(row, dy))\n\n  return level\n}\n\nexport const addOnTile = function(\n  level: LevelMap,\n  match: (tile: Tile) => boolean,\n  onValid: (x: number, y: number) => void\n): LevelMap {\n  let iters = level.width * level.height\n\n  while (iters > 0) {\n    const x = random(0, level.width - 1),\n      y = random(0, level.height - 1)\n\n    if (match(level.at(x, y))) {\n      onValid(x, y)\n      return level\n    }\n\n    iters--\n  }\n\n  throw 'post add failed to add tile'\n}\n\nexport const connectMaps = function(map1: LevelMap, map2: LevelMap) {\n  addOnTile(\n    map1,\n    tile => tile.isFloor() && tile.passibleThrough(),\n    (dx, dy) => {\n      let downTile\n\n      addOnTile(\n        map2,\n        tile => tile.isFloor() && tile.passibleThrough(),\n        (ux, uy) => {\n          const upTile = new StairwayUp(map2, map1, new Point(dx, dy))\n          map2.setTile(ux, uy, upTile)\n\n          downTile = new StairwayDown(map1, map2, new Point(ux, uy))\n        }\n      )\n\n      map1.setTile(dx, dy, downTile)\n    }\n  )\n}\n","import { twoDimArray } from '../utils'\nimport { LevelMap, Tile } from '../../engine'\n\nexport default function(drawMap: string[]): LevelMap {\n  return new LevelMap(\n    twoDimArray(drawMap[0].length, drawMap.length, (x, y) =>\n      Tile.retrieve(drawMap[y].charAt(x))\n    )\n  )\n}\n","import { Rect, Point, rand, min, twoDimArray } from '../utils'\nimport { LevelMap, Tile } from '../../engine'\n\nconst THICKNESS = 0\n\nconst newRoomSpace = function(): Tile {\n  return Tile.retrieve('R')\n}\n\nconst newCorridor = function(): Tile {\n  return Tile.retrieve('C')\n}\n\nconst newWall = function(): Tile {\n  return Tile.retrieve('W')\n}\n\ntype Stage = Tile[][]\n\nconst RAY_TURNS = 60\nconst DELTA_ANGLE = Math.PI / (RAY_TURNS * 2)\n\nclass Room extends Rect {\n  notCross(rect: Rect): boolean {\n    return (\n      rect.x - THICKNESS > this.x + this.w ||\n      rect.y - THICKNESS > this.y + this.h ||\n      rect.x + rect.w < this.x - THICKNESS ||\n      rect.y + rect.h < this.y - THICKNESS\n    )\n  }\n\n  pointWithin(): Point {\n    return new Point(\n      this.x + 1 + rand(this.w - 1),\n      this.y + 1 + rand(this.h - 1)\n    )\n  }\n\n  add(stage: Stage): void {\n    let i: number = 0\n    while (i < this.w) {\n      let j: number = 0\n      while (j < this.h) {\n        stage[this.x + i][this.y + j] = newRoomSpace()\n        j++\n      }\n\n      i++\n    }\n  }\n}\n\nclass Road extends Rect {\n  lined: boolean\n\n  constructor(x: number, y: number, w: number, h: number) {\n    super(x, y, w, h)\n    this.lined = (x >= w && y >= h) || (w >= x && h >= y)\n  }\n\n  add(stage: Stage): void {\n    let [hx, hy, w] = this.horizontalLine()\n\n    let i = 0\n    while (i < w) {\n      if (stage[hx + i][hy].key === 'W') {\n        stage[hx + i][hy] = newCorridor()\n      }\n      i += 1\n    }\n\n    let [vx, vy, h] = this.verticalLine()\n    let j = 0\n    while (j < h) {\n      if (stage[vx][vy + j].key === 'W') {\n        stage[vx][vy + j] = newCorridor()\n      }\n      j += 1\n    }\n  }\n\n  horizontalLine(): [number, number, number] {\n    // x\n    // |\\\n    // .-x\n    if (this.lined)\n      return [\n        Math.min(this.x, this.w),\n        Math.max(this.y, this.h),\n        Math.abs(this.w - this.x),\n      ]\n    // .-x\n    // |/\n    // x\n    else\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.w - this.x),\n      ]\n  }\n\n  verticalLine(): [number, number, number] {\n    // x\n    // |\\\n    // .-x\n    if (this.lined)\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.h - this.y),\n      ]\n    // .-x\n    // |/\n    // x\n    else\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.h - this.y),\n      ]\n  }\n}\n\nclass DungeonGenerator {\n  rooms: Array<Room>\n  roads: Array<Road>\n\n  constructor(\n    protected maxX: number,\n    protected maxY: number,\n    private minSize: number,\n    private maxSize: number,\n    private roomsCount: number\n  ) {\n    let rooms: Room[] = new Array(this.roomsCount)\n      .fill(undefined)\n      .map(_ => this.generateRoom())\n\n    this.rooms = this.normalize(this.ray(rooms))\n    this.roads = this.buildRoads(this.rooms)\n  }\n\n  private generateRoom(): Room {\n    return new Room(\n      0,\n      0,\n      this.minSize + rand(this.maxSize - this.minSize),\n      this.minSize + rand(this.maxSize - this.minSize)\n    )\n  }\n\n  // Takes a room and tries to put it on a ray coming from (0, 0)\n  // until the room finds empty place for it.\n  private ray(rooms: Room[]): Room[] {\n    return rooms.reduce((pickedRooms: Room[], currentRoom: Room) => {\n      for (\n        let i = 0, angle = (rand(360) / 180) * Math.PI;\n        i < RAY_TURNS;\n        angle += DELTA_ANGLE, i++\n      ) {\n        // TODO: Build table with these values.\n        const cos: number = Math.cos(angle)\n        const sin: number = Math.sin(angle)\n        let l: number = 1\n        let dx: number = 0\n        let dy: number = 0\n\n        let roomToMove = new Room(\n          currentRoom.x,\n          currentRoom.y,\n          currentRoom.w,\n          currentRoom.h\n        )\n\n        while (Math.abs(dx) < this.maxX / 2 && Math.abs(dy) < this.maxY / 2) {\n          let ndx = Math.round(l * cos)\n          let ndy = Math.round(l * sin)\n\n          while (ndx === dx && ndy === dy) {\n            l += 1\n            ndx = Math.round(l * cos)\n            ndy = Math.round(l * sin)\n          }\n\n          roomToMove.move(ndx - dx, ndy - dy)\n          dx = ndx\n          dy = ndy\n\n          if (pickedRooms.every(room => roomToMove.notCross(room))) {\n            pickedRooms.push(roomToMove)\n            return pickedRooms\n          }\n        }\n      }\n\n      return pickedRooms\n    }, [])\n  }\n\n  private normalize(rooms: Room[]): Room[] {\n    const minX = min(rooms.map(room => room.x)) - 1\n    rooms.forEach(room => {\n      room.move(-minX, 0)\n    })\n    rooms = rooms.filter((room: Room) => room.x + room.w < this.maxX)\n\n    const minY = min(rooms.map(room => room.y)) - 1\n    rooms.forEach(room => {\n      room.move(0, -minY)\n    })\n    return rooms.filter((room: Room) => room.y + room.h < this.maxY)\n  }\n\n  private buildRoads(rooms: Room[]): Road[] {\n    let points: Point[] = rooms.map(room => {\n      return room.pointWithin()\n    })\n\n    let connectedPoints: Point[] = [points.shift()]\n    let roads: Road[] = []\n\n    const distance = function(point1: Point, point2: Point): number {\n      // No need to calc square root since it's being used for comparison only.\n      return (point1.x - point2.x) ** 2 + (point1.y - point2.y) ** 2\n    }\n\n    while (points.length) {\n      let currentPoint = points.shift()\n\n      let pointToConnect = connectedPoints[0]\n      let minDistance = distance(currentPoint, pointToConnect)\n\n      connectedPoints.forEach(point => {\n        const currentDistance = distance(point, currentPoint)\n        if (currentDistance < minDistance) {\n          pointToConnect = point\n          minDistance = currentDistance\n        }\n      })\n\n      connectedPoints.push(currentPoint)\n\n      roads.push(\n        new Road(\n          currentPoint.x,\n          currentPoint.y,\n          pointToConnect.x,\n          pointToConnect.y\n        )\n      )\n    }\n\n    return roads\n  }\n}\n\nexport default function(\n  dimX: number,\n  dimY: number,\n  minSize: number,\n  maxSize: number,\n  roomsCount: number\n): LevelMap {\n  // TODO: Validate min or max size is lower than map's sizes\n  const dungeon = new DungeonGenerator(dimX, dimY, minSize, maxSize, roomsCount)\n\n  let stage = twoDimArray(dimX, dimY, newWall)\n\n  for (let i = 0; i < dungeon.rooms.length; i++) dungeon.rooms[i].add(stage)\n\n  for (let i = 0; i < dungeon.roads.length; i++) dungeon.roads[i].add(stage)\n\n  return new LevelMap(stage)\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  Item,\n  AIPickUpItems,\n  AIDropItems,\n  AIPutOnItem,\n} from '../../engine'\nimport { IdleScreen } from './idle_screen'\nimport { GroupedItem } from '../items/internal'\nimport { InventoryScreen } from './inventory_screen'\nimport { InventorySlot } from '../inventory'\n\ninterface ItemsListingPosition {\n  item: Item\n  count: number\n}\n\nabstract class ItemsListingScreen extends Screen {\n  public positions: ItemsListingPosition[]\n  public title: string\n\n  constructor(game: Game) {\n    super(ScreenType.ItemsListing, game)\n    this.initPositions()\n  }\n\n  protected abstract initPositions()\n\n  public close(): void {\n    this.game.screen = new IdleScreen(this.game)\n  }\n}\n\nexport class PickUpScreen extends ItemsListingScreen {\n  public title: string = 'What to pick up?'\n\n  protected initPositions(): void {\n    const items = this.player.currentLevel.at(\n      this.player.pos.x,\n      this.player.pos.y\n    ).items\n    this.positions = items.bunch.map(itemGroup => {\n      return { item: itemGroup.item, count: itemGroup.count }\n    })\n  }\n\n  public pickUpItems(items: GroupedItem[]): void {\n    // TODO: Validate items are part of positions\n    new AIPickUpItems(items, this.game).act()\n  }\n}\n\nexport class DropItemsScreen extends ItemsListingScreen {\n  public title: string = 'What to drop?'\n\n  protected initPositions(): void {\n    this.positions = this.player.inventory.cares()\n  }\n\n  public pickUpItems(items: GroupedItem[]): void {\n    // TODO: Validate items are part of positions\n    new AIDropItems(items, this.game).act()\n  }\n}\n\nexport class PutOnItemsScreen extends ItemsListingScreen {\n  public title: string = 'What to put on?'\n  public singleItemMode: boolean = true\n\n  constructor(\n    protected inventorySlot: InventorySlot,\n    public positions: ItemsListingPosition[],\n    game: Game\n  ) {\n    super(game)\n  }\n\n  protected initPositions(): void {}\n\n  public pickUpItems(items: ItemsListingPosition[]): void {\n    // TODO: Validate items are part of positions\n    // new AIDropItems(items, this.game).act()\n    console.log(items)\n  }\n\n  public withItem(itemGroup: ItemsListingPosition): void {\n    new AIPutOnItem(this.inventorySlot, itemGroup.item, this.game).act()\n    this.game.screen = undefined\n  }\n\n  public close(): void {\n    this.game.screen = new InventoryScreen(this.game)\n  }\n}\n","import { Game } from '../game'\nimport { ScreenType, Screen } from './internal'\nimport { Profession } from '../profession'\n\nexport class ProfessionPickingScreen extends Screen {\n  public options: Profession[]\n  public title: string\n\n  constructor(game: Game) {\n    super(ScreenType.ProfessionPicking, game)\n    this.options = this.game.professionPicker.available(this.player)\n\n    this.title = `Gained ${this.player.level.current - this.player.levelUps + 1} level`\n  }\n\n  public onInput(pickedProfession: Profession) {\n    let playerProfession = this.player.professions.find(\n      profession => profession.id === pickedProfession.id\n    )\n    if (playerProfession) {\n      playerProfession.level += 1\n    } else {\n      this.player.professions.push(pickedProfession)\n    }\n\n    this.player.levelUps -= 1\n    this.player.characteristics.levelUp(this.player.specie)\n\n    if (this.player.levelUps > 0) {\n      this.game.screen = new ProfessionPickingScreen(this.game)\n    } else {\n      this.game.screen = undefined\n    }\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { takeRight } from 'lodash'\n\nimport { LogLevel } from '../src/engine'\n\nimport * as moment from 'moment'\n\nexport default Vue.extend({\n  name: 'Logger',\n  props: ['logger'],\n  computed: {\n    messages() {\n      return takeRight(this.logger.messages, 5)\n    }\n  },\n  methods: {\n    ts(record) {\n      return moment(record.ts).format(\"hh:mm:ss\")\n    },\n    rowClass(record) {\n      switch (record.level) {\n        case LogLevel.DEBUG:\n          return 'table-secondary'\n        case LogLevel.INFO:\n          return 'table-info'\n        case LogLevel.WARNING:\n          return 'table-warning'\n        case LogLevel.DANGER:\n          return 'table-danger'\n      }\n    }\n  }\n})\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Logger.vue?vue&type=template&id=3e0edcb8\"\nimport script from \"./Logger.vue?vue&type=script&lang=ts\"\nexport * from \"./Logger.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Logger.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"container\",staticClass:\"logger\"},[_c('table',{staticClass:\"table table-sm table-striped\"},[_c('tbody',_vm._l((_vm.messages),function(record,i){return _c('tr',{key:i,class:_vm.rowClass(record)},[_c('td',[_vm._v(_vm._s(_vm.ts(record)))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(record.message))])])}))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./stats.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./stats.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nimport {\n  Patrol,\n  Explorer,\n  Waiter,\n  Chaser,\n  Escaper,\n  Loiter,\n  Dispatcher,\n  Picker,\n  SelfHealer,\n  Attacker,\n  Thrower,\n} from '../src/engine'\n\nexport default Vue.extend({\n  name: 'Stats',\n  props: ['creature'],\n  computed: {\n  },\n  methods: {\n    aiName(ai) {\n      if (ai instanceof Patrol) {\n        return 'Patrol'\n      }\n      if (ai instanceof Escaper) {\n        return 'Escaper'\n      }\n      if (ai instanceof Chaser) {\n        return 'Chaser'\n      }\n      if (ai instanceof Explorer) {\n        return 'Explorer'\n      }\n      if (ai instanceof Waiter) {\n        return 'Waiter'\n      }\n      if (ai instanceof Loiter) {\n        return `Loiter`\n      }\n      if (ai instanceof Dispatcher) {\n        return `Dispatcher (${this.aiName(ai.aiToRun)})`\n      }\n      if (ai instanceof Attacker) {\n        return `Attacker`\n      }\n      if (ai instanceof SelfHealer) {\n        return `SelfHealer`\n      }\n      if (ai instanceof Picker) {\n        return 'Picker'\n      }\n      if (ai instanceof Thrower) {\n        return 'Thrower'\n      }\n    },\n    displayAttribute(attribute) {\n      if (attribute.currentValue() != attribute.maximum()) {\n        return `${attribute.currentValue()} [${attribute.maximum()}]`\n      } else {\n        return attribute.currentValue()\n      }\n    },\n    displayAttributeWithModifiers(attribute) {\n      if (attribute.currentValue() != attribute.maximum()) {\n        const mods = attribute.modifiers.map(x => x > 0 ? `+ ${x}` : `- ${x}`).join(' ')\n        return `${attribute.currentValue()} = [${attribute.maximum()}] ${mods}`\n      } else {\n        return attribute.currentValue()\n      }\n    }\n  }\n})\n","import { AI } from './internal'\nimport { Creature } from '../creature'\n\nexport class Waiter extends AI {\n  act(actor: Creature): void {}\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n}\n","import { render, staticRenderFns } from \"./stats.vue?vue&type=template&id=d9087414\"\nimport script from \"./stats.vue?vue&type=script&lang=ts\"\nexport * from \"./stats.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('dl',{staticClass:\"row small\"},[_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    ID\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.id)+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    POS\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.pos)+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Level\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.level.current)+\" [\"+_vm._s(_vm.creature.level.currentExperience)+\" - \"+_vm._s(_vm.creature.level.requiredExperience)+\"]\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Здоровье\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttribute(_vm.creature.characteristics.health))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Атака\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.attack))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Защита\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.defense))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Скорость\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.speed))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    AI\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.aiName(_vm.creature.ai))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    В сумке\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_c('ul',_vm._l((_vm.creature.inventory.cares()),function(invItem){return _c('li',{key:invItem.id},[_vm._v(\"\\n          \"+_vm._s(invItem.item.name)+\" \"+_vm._s(invItem.count === 1 ? '' : (\": \" + (invItem.count)))+\"\\n      \")])}))]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Профессии\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_c('ul',_vm._l((_vm.creature.professions),function(profession){return _c('li',{key:profession.name},[_vm._v(\"\\n          \"+_vm._s(profession.name)+\" \"+_vm._s(profession.level)+\"\\n      \")])}))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/// This file contains the main tile engine namespace.\n/// All coordinates are assumed to be integers - behaviour is undefined\n/// if you feed in floats (or anything other) as x and y (or similar) parameters.\n\n/// Class: Tile\n/// Represents a unicode character tile with various attributes.\nexport class Tile {\n  /// Constructor: Tile\n  /// Constructs a new Tile object.\n  ///\n  /// Parameters:\n  ///   ch - a character to display for this tile\n  ///   r - (optional) red foregorund color component 0-255\n  ///   g - (optional) green foreground color component 0-255\n  ///   b - (optional) blue foreground color component 0-255\n  ///   br - (optional) red background color component 0-255\n  ///   bg - (optional) green background color component 0-255\n  ///   bb - (optional) blue background color component 0-255\n  constructor(\n    public ch: string,\n    public r?: number,\n    public g?: number,\n    public b?: number,\n    public br?: number,\n    public bg?: number,\n    public bb?: number,\n  ) {}\n\n  /// Function: getChar\n  /// Returns the character of this tile.\n  public getChar() { return this.ch }\n\n  /// Function: setChar\n  /// Sets the character of this tile.\n  public setChar(ch: string) { this.ch = ch }\n\n  /// Function: setColor\n  /// Sets the foreground color of this tile.\n  public setColor(r: number, g: number, b: number) {\n    this.r = r\n    this.g = g\n    this.b = b\n  }\n\n  /// Function: setGrey\n  /// Sets the foreground color to the given shade (0-255) of grey.\n  public setGrey(grey: number) {\n    this.r = grey\n    this.g = grey\n    this.b = grey\n  }\n\n  /// Function: setBackground\n  /// Sets the background color of this tile.\n  public setBackground(r: number, g: number, b: number) {\n    this.br = r\n    this.bg = g\n    this.bb = b\n  }\n\n  public backgroundToColor() {\n    this.r = this.br\n    this.g = this.bg\n    this.b = this.bb\n  }\n\n  public swapColors() {\n    this.r = [this.br, this.br = this.r][0]\n    this.g = [this.bg, this.bg = this.g][0]\n    this.b = [this.bb, this.bb = this.b][0]\n  }\n\n  /// Function: resetColor\n  /// Clears the color of this tile / assigns default color.\n  public resetColor() { this.r = this.g = this.b = undefined }\n\n  /// Function: resetBackground\n  /// Clears the background color of this tile.\n  public resetBackground() { this.br = this.bg = this.bb = undefined }\n\n  /// Function: getColorHex\n  /// Returns the hexadecimal representation of the color\n  public getColorHex() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return '#' + this.r.toString(16) + this.g.toString(16) + this.b.toString(16)\n    else return ''\n  }\n\n  /// Function: getBackgroundHex\n  /// Returns the hexadecimal representation of the background color\n  public getBackgroundHex() {\n    if (this.br !== undefined && this.bg !== undefined && this.bb !== undefined)\n      return '#' + this.br.toString(16) + this.bg.toString(16) + this.bb.toString(16)\n    else return ''\n  }\n\n  /// Function: getColorRGB\n  /// Returns the CSS rgb(r,g,b) representation of the color\n  public getColorRGB() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return `rgb(${this.r},${this.g},${this.b})`\n    else return ''\n  }\n\n  /// Function: getBackgroundRGB\n  /// Returns the CSS rgb(r,g,b) representation of the background color\n  public getBackgroundRGB() {\n    if (this.br !== undefined && this.bg !== undefined && this.bb !== undefined)\n      return `rgb(${this.br},${this.bg},${this.bb})`\n    else return ''\n  }\n\n  /// Function: getColorJSON\n  /// Returns the JSON representation of the color, i.e. object { r, g, b }\n  public getColorJSON() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return { 'r': this.r, 'g': this.g, 'b': this.b }\n    else return {}\n  }\n\n  /// Function: getBackgroundJSON\n  /// Returns the JSON representation of the background color, i.e. object { r, g, b }\n  public getBackgroundJSON() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return { 'r': this.br, 'g': this.bg, 'b': this.bb }\n    else return {}\n  }\n\n  /// Function: copy\n  /// Makes this tile identical to the one supplied. Custom properties are not copied.\n  public copy(other: Tile) {\n    this.ch = other.ch\n    this.r = other.r\n    this.g = other.g\n    this.b = other.b\n    this.br = other.br\n    this.bg = other.bg\n    this.bb = other.bb\n  }\n\n  /// Function: clone\n  /// Returns a new copy of this tile. Custom properties are not cloned.\n  public clone() {\n    return new Tile(this.ch, this.r, this.g, this.b, this.br, this.bg, this.bb)\n  }\n}\n\n/// Constants: Semi-internal constants for ut namespace\n/// VERSION  - Version of the library as string.\n/// NULLCHAR - Character used when none is specified otherwise.\n/// CSSCLASS - The CSS class name used for the tile engine element.\n/// NULLTILE - The tile used as placeholder for empty tile.\nexport const VERSION = '2.1'\nexport const NULLCHAR = ' '\nexport const CSSCLASS = 'unicodetiles'\nexport const NULLTILE = new Tile(NULLCHAR)\n\nexport interface Renderer {\n  updateStyle(s?: any): void\n\n    // if (this.renderer instanceof ut.WebGLRenderer) return ''\n    // if (this.renderer instanceof ut.CanvasRenderer) return 'canvas'\n    // if (this.renderer instanceof ut.DOMRenderer) return 'dom'\n  getRendererString(): string\n\n  clear(): void\n  render(): void\n}\n\n/// Class: Viewport\n/// The tile engine viewport / window. Takes care of initializing a proper renderer.\n\n/// Constructor: Viewport\n/// Constructs a new Viewport object.\n/// If you wish to display a player character at the center, you should use odd sizes.\n///\n/// Parameters:\n///   elem - the DOM element which shall be transformed into the tile engine\n///   w - (integer) width in tiles\n///   h - (integer) height in tiles\n///   renderer - (optional) choose rendering engine, see <Viewport.setRenderer>, defaults to 'auto'.\n///   squarify - (optional) set to true to force the tiles square; may break some box drawing\nexport class Viewport {\n  public cx: number\n  public cy: number\n\n  public buffer: Tile[][]\n  public renderer: Renderer\n\n  public defaultColor?: string\n  public defaultBackground?: string\n\n  constructor(\n    public elem: HTMLElement,\n    public w: number,\n    public h: number,\n    renderer: (viewport: Viewport) => Renderer,\n    public squarify: boolean = false,\n    ) {\n    this.cx = Math.floor(w / 2)\n    this.cy = Math.floor(h / 2)\n\n    this.elem.innerHTML = ''\n\n    // Add CSS class if not added already\n    if (elem.className.indexOf(CSSCLASS) === -1) {\n      if (elem.className.length === 0) {\n        elem.className = CSSCLASS\n      }\n      else elem.className += ' ' + CSSCLASS\n    }\n\n    // Create two 2-dimensional array to hold the viewport tiles\n    this.buffer = new Array(h)\n    for (let j = 0; j < h; ++j) {\n      this.buffer[j] = new Array(w)\n      for (let i = 0; i < w; ++i) {\n        this.buffer[j][i] = NULLTILE\n      }\n    }\n\n    this.renderer = renderer(this)\n  }\n\n  /// Function: updateStyle\n  /// If the style of the parent element is modified, this needs to be called.\n  private updateStyle(updateRenderer: boolean) {\n    const s = window.getComputedStyle(this.elem, null)\n\n    this.defaultColor = s.color || undefined // OMG\n    this.defaultBackground = s.backgroundColor || undefined\n    if (updateRenderer) {\n      this.renderer.updateStyle(s)\n    }\n  };\n\n  /// Function: getRendererString\n  /// Gets the currently used renderer.\n  ///\n  /// Returns:\n  ///   One of 'webgl', 'canvas', 'dom', ''.\n  public getRendererString(): string {\n    return this.renderer.getRendererString()\n  }\n\n  /// Function: put\n  /// Puts a tile to the given coordinates.\n  /// Checks bounds and does nothing if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   tile - the tile to put\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  public put(tile: Tile, x: number, y: number): void {\n    if (x < 0 || y < 0 || x >= this.w || y >= this.h) return\n    this.buffer[y][x] = tile\n  }\n\n  /// Function: unsafePut\n  /// Puts a tile to the given coordinates.\n  /// Does *not* check bounds throws exception if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   tile - the tile to put\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  public unsafePut(tile: Tile, x: number, y: number) {\n    this.buffer[y][x] = tile\n  }\n\n  /// Function: putString\n  /// Creates a row of tiles with the chars of the given string.\n  /// Wraps to next line if it can't fit the chars on one line.\n  ///\n  /// Parameters:\n  ///   str - (string) the string to put\n  ///   x - (integer) x coordinate (column)\n  ///   y - (integer) y coordinate (row)\n  ///   r - (optional) red foregorund color component 0-255\n  ///   g - (optional) green foreground color component 0-255\n  ///   b - (optional) blue foreground color component 0-255\n  ///   br - (optional) red background color component 0-255\n  ///   bg - (optional) green background color component 0-255\n  ///   bb - (optional) blue background color component 0-255\n  public putString(\n    str: string,\n    x: number,\n    y: number,\n    r?: number,\n    g?: number,\n    b?: number,\n    br?: number,\n    bg?: number,\n    bb?: number,\n  ) {\n    const len = str.length\n    if (x < 0 || y < 0) return\n\n    for (let i = 0; i < len; ++i) {\n      if (x >= this.w) {\n        x = 0\n        ++y\n      }\n      if (y >= this.h) return\n\n      const tile = new Tile(str[i], r, g, b, br, bg, bb)\n      this.unsafePut(tile, x, y)\n      ++x\n    }\n  }\n\n  /// Function: get\n  /// Returns the tile in the given coordinates.\n  /// Checks bounds and returns empty tile if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  ///\n  /// Returns:\n  ///   The tile.\n  public get(x: number, y: number): Tile {\n    if (x < 0 || y < 0 || x >= this.w || y >= this.h) return NULLTILE\n    return this.buffer[y][x]\n  }\n\n  /// Function: clear\n  /// Clears the viewport buffer by assigning empty tiles.\n  public clear() {\n    for (let j = 0; j < this.h; ++j) {\n      for (let i = 0; i < this.w; ++i) {\n        this.buffer[j][i] = NULLTILE\n      }\n    }\n    this.renderer.clear()\n  }\n\n  /// Function: render\n  /// Renders the buffer as html to the element specified at construction.\n  public render() {\n    this.renderer.render()\n  }\n}\n\n/// Class: Engine\n/// The tile engine itself.\nexport class Engine {\n  private refreshCache: boolean = true\n  private cacheEnabled: boolean = false\n  private transitionTimer?: number\n\n  private transitionDuration: number = 0\n  private transition?: (x: number, y: number, w: number, h: number, new_t: Tile, old_t: Tile, factor: number) => Tile\n  private maskFunc?: (x: number, y: number) => boolean\n  private shaderFunc?: (tile: Tile, x: number, y: number, timeNow: number) => Tile\n  private cachex: number = 0\n  private cachey: number = 0\n\n  private tileCache: Tile[][]\n  private tileCache2: Tile[][]\n\n  /// Constructor: Engine\n  /// Constructs a new Engine object. If width or height is given,\n  /// it will not attempt to fetch tiles outside the boundaries.\n  /// In that case 0,0 is assumed as the upper-left corner of the world,\n  /// but if no width/height is given also negative coords are valid.\n  ///\n  /// Parameters:\n  ///   vp - the <Viewport> instance to use as the viewport\n  ///   func - the function used for fetching tiles\n  ///   w - (integer) (optional) world width in tiles\n  ///   h - (integer) (optional) world height in tiles\n  constructor(\n    public viewport: Viewport,\n    public tileFunc: (x: number, y: number) => Tile,\n    public w: number,\n    public h: number,\n  ) {\n\n    this.tileCache = new Array(viewport.h)\n    this.tileCache2 = new Array(viewport.h)\n\n    for (let j = 0; j < viewport.h; ++j) {\n      this.tileCache[j] = new Array(viewport.w)\n      this.tileCache2[j] = new Array(viewport.w)\n    }\n  }\n\n  /// Function: setTileFunc\n  /// Sets the function to be called with coordinates to fetch each tile.\n  /// Optionally can apply a transition effect. Effects are:\n  /// 'boxin', 'boxout', 'circlein', 'circleout', 'random'\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (x, y) and returning an ut.Tile\n  ///   effect - (string) (optional) name of effect to use (see above for legal values)\n  ///   duration - (integer) (optional) how many milliseconds the transition effect should last\n  public setTileFunc(func: (x: number, y: number) => Tile, effect?: string, duration?: number) {\n    if (effect) {\n      this.transition = undefined\n      if (typeof effect === 'string') {\n        if (effect === 'boxin') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          if (Math.abs(x) < halfw * factor && Math.abs(y) < halfh * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'boxout') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          factor = 1.0 - factor\n          if (Math.abs(x) < halfw * factor && Math.abs(y) < halfh * factor) return old_t\n          else return new_t\n        }\n        else if (effect === 'circlein') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          if (x * x + y * y < (halfw * halfw + halfh * halfh) * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'circleout') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          factor = 1.0 - factor\n          if (x * x + y * y > (halfw * halfw + halfh * halfh) * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'random') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          if (Math.random() > factor) return old_t\n          else return new_t\n        }\n      }\n      if (this.transition) {\n        this.transitionTimer = (new Date()).getTime()\n        this.transitionDuration = duration || 500\n      }\n    }\n    this.tileFunc = func\n  }\n\n  /// Function: setMaskFunc\n  /// Sets the function to be called to fetch mask information according to coordinates.\n  /// If mask function returns false to some coordinates, then that tile is not rendered.\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (x, y) and returning a true if the tile is visible\n  public setMaskFunc(func: (x: number, y: number) => boolean) { this.maskFunc = func }\n\n  /// Function: setShaderFunc\n  /// Sets the function to be called to post-process / shade each visible tile.\n  /// Shader function is called even if caching is enabled, see <Engine.setCacheEnabled>.\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (tile, x, y) and returning an ut.Tile\n  public setShaderFunc(func: (tile: Tile, x: number, y: number) => Tile) { this.shaderFunc = func }\n\n  /// Function: setWorldSize\n  /// Tiles outside of the range x = [0,width[ y = [0,height[ are not fetched.\n  /// Set to undefined in order to make the world infinite.\n  ///\n  /// Parameters:\n  ///   width - (integer) new world width\n  ///   height - (integer) new world height\n  public setWorldSize(width: number, height: number) {\n    this.w = width\n    this.h = height\n  }\n\n  /// Function: setCacheEnabled\n  /// Enables or disables the usage of tile cache. This means that\n  /// extra measures are taken to not call the tile function unnecessarily.\n  /// This means that all animating must be done in a shader function,\n  /// see <Engine.setShaderFunc>.\n  /// Cache is off by default, but should be enabled if the tile function\n  /// does more computation than a simple array look-up.\n  ///\n  /// Parameters:\n  ///   mode - true to enable, false to disable\n  public setCacheEnabled(mode: boolean) {\n    this.cacheEnabled = mode\n    this.refreshCache = true\n  }\n\n  /// Function: update\n  /// Updates the viewport according to the given player coordinates.\n  /// The algorithm goes as follows:\n  ///   * Record the current time\n  ///   * For each viewport tile:\n  ///   * Check if the tile is visible by testing the mask\n  ///   * If not visible, continue to the next tile in the viewport\n  ///   * Otherwise, if cache is enabled try to fetch the tile from there\n  ///   * Otherwise, call the tile function and check for shader function presence\n  ///   * If there is shader function, apply it to the tile, passing the recorded time\n  ///   * Put the tile to viewport\n  ///\n  /// Parameters:\n  ///   x - (integer) viewport center x coordinate in the tile world\n  ///   y - (integer) viewport center y coordinate in the tile world\n  public update(x?: number, y?: number) {\n    x = x || 0\n    y = y || 0\n\n    // World coords of upper left corner of the viewport\n    const xx = x - this.viewport.cx\n    const yy = y - this.viewport.cy\n    const timeNow = (new Date()).getTime() // For passing to shaderFunc\n    let transTime\n    if (this.transition && this.transitionTimer) transTime = (timeNow - this.transitionTimer) / this.transitionDuration\n    if (transTime && transTime >= 1.0) this.transition = undefined\n\n    let tile: Tile\n\n    // For each tile in viewport...\n    for (let j = 0; j < this.viewport.h; ++j) {\n      for (let i = 0; i < this.viewport.w; ++i) {\n        const ixx = i + xx, jyy = j + yy\n        // Check horizontal bounds if requested\n        if (this.w && (ixx < 0 || ixx >= this.w)) {\n          tile = NULLTILE\n        // Check vertical bounds if requested\n        } else if (this.h && (jyy < 0 || jyy >= this.h)) {\n          tile = NULLTILE\n        // Check mask\n        } else if (this.maskFunc && !this.maskFunc(ixx, jyy)) {\n          tile = NULLTILE\n        // Check transition effect\n        } else if (this.transition && !this.refreshCache) {\n          tile = this.transition(\n            i,\n            j,\n            this.viewport.w,\n            this.viewport.h,\n            this.tileFunc(ixx, jyy),\n            this.tileCache[j][i],\n            transTime || 0\n          )\n        // Check cache\n        } else if (this.cacheEnabled && !this.refreshCache) {\n          const lookupx = ixx - this.cachex\n          const lookupy = jyy - this.cachey\n          if (lookupx >= 0 && lookupx < this.viewport.w && lookupy >= 0 && lookupy < this.viewport.h) {\n            tile = this.tileCache[lookupy][lookupx]\n            if (tile === NULLTILE) tile = this.tileFunc(ixx, jyy)\n          } else // Cache miss\n            tile = this.tileFunc(ixx, jyy)\n        // If all else fails, call tileFunc\n        } else tile = this.tileFunc(ixx, jyy)\n        // Save the tile to cache (always due to transition effects)\n        this.tileCache2[j][i] = tile\n        // Apply shader function\n        if (this.shaderFunc && tile !== NULLTILE)\n          tile = this.shaderFunc(tile, ixx, jyy, timeNow)\n        // Put shaded tile to viewport\n        this.viewport.unsafePut(tile, i, j)\n      }\n    }\n    // Cache stuff is enabled always, because it is also required by transitions\n    // Save the new cache origin\n    this.cachex = xx\n    this.cachey = yy\n\n    // Swap cache buffers\n    const tempCache = this.tileCache\n    this.tileCache = this.tileCache2\n    this.tileCache2 = tempCache\n    this.refreshCache = false\n  }\n}\n","import { Renderer, Viewport } from './unicodetiles'\n\n/// Class: CanvasRenderer\n/// Renders the <Viewport> into an HTML5 <canvas> element.\n///\n/// *Note:* This is an internal class used by <Viewport>\nclass CanvasRenderer implements Renderer {\n  private canvas: HTMLCanvasElement\n  private offscreen: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n  private ctx2: CanvasRenderingContext2D\n\n  private th?: number\n  private tw?: number\n  private gap?: number\n\n  constructor(private view: Viewport) {\n    this.canvas = document.createElement('canvas')\n    if (!this.canvas.getContext) throw('Canvas not supported')\n    this.ctx2 = this.canvas.getContext('2d')\n    if (!this.ctx2 || !this.ctx2.fillText) throw('Canvas not supported')\n    view.elem.appendChild(this.canvas)\n\n    // Create an offscreen canvas for rendering\n    this.offscreen = document.createElement('canvas')\n    this.ctx = this.offscreen.getContext('2d')\n    this.updateStyle()\n    this.canvas.width = (view.squarify ? this.th : this.tw) * view.w\n    this.canvas.height = this.th * view.h\n    this.offscreen.width = this.canvas.width\n    this.offscreen.height = this.canvas.height\n    // Doing this again since setting canvas w/h resets the state\n    this.updateStyle()\n  }\n\n  public getRendererString(): string { return 'canvas' }\n\n  public updateStyle(s?: any) {\n    s = s || window.getComputedStyle(this.view.elem, null)\n    this.ctx.font = `${s.fontSize}/${s.lineHeight} ${s.fontFamily}`\n    this.ctx.textBaseline = 'middle'\n    this.tw = this.ctx.measureText('M').width\n    this.th = parseInt(s.fontSize, 10)\n    this.gap = this.view.squarify ? (this.th - this.tw) : 0\n    if (this.view.squarify) this.tw = this.th\n  }\n\n  public clear() { /* No op */ }\n\n  public render() {\n    let tile, ch, fg, bg, x, y\n    const view = this.view,\n          buffer = this.view.buffer,\n          w = view.w, h = view.h,\n          hth = 0.5 * this.th,\n          hgap = 0.5 * this.gap // Squarification\n\n    // Clearing with one big rect is much faster than with individual char rects\n    this.ctx.fillStyle = view.defaultBackground\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height)\n    y = hth // half because textBaseline is middle\n    for (let j = 0; j < h; ++j) {\n      x = 0\n      for (let i = 0; i < w; ++i) {\n        tile = buffer[j][i]\n        ch = tile.ch\n        fg = tile.getColorRGB()\n        bg = tile.getBackgroundRGB()\n        // Only render background if the color is non-default\n        if (bg.length && bg !== view.defaultBackground) {\n          this.ctx.fillStyle = bg\n          this.ctx.fillRect(x, y - hth, this.tw, this.th)\n        }\n        // Do not attempt to render empty char\n        if (ch.length) {\n          if (!fg.length) fg = view.defaultColor\n          this.ctx.fillStyle = fg\n          this.ctx.fillText(ch, x + hgap, y)\n        }\n        x += this.tw\n      }\n      y += this.th\n    }\n    this.ctx2.drawImage(this.offscreen, 0, 0)\n  }\n}\n\nexport const canvasRenderer = function(viewport: Viewport): Renderer {\n  return new CanvasRenderer(viewport)\n}\n","import { Renderer, Viewport } from './unicodetiles'\n\nconst VERTEX_SHADER = `\nattribute vec2 position;\nattribute vec2 texCoord;\nattribute vec3 color;\nattribute vec3 bgColor;\nattribute float charIndex;\nuniform vec2 uResolution;\nuniform vec2 uTileCounts;\nuniform vec2 uPadding;\nvarying vec2 vTexCoord;\nvarying vec3 vColor;\nvarying vec3 vBgColor;\n\nvoid main() {\n  vec2 tileCoords = floor(vec2(mod(charIndex, uTileCounts.x), charIndex / uTileCounts.x));\n  vTexCoord = (texCoord + tileCoords) / uTileCounts;\n  vTexCoord += (0.5 - texCoord) * uPadding;\n  vColor = color;\n  vBgColor = bgColor;\n  vec2 pos = position / uResolution * 2.0 - 1.0;\n  gl_Position = vec4(pos.x, -pos.y, 0.0, 1.0);\n}\n`\n\nconst FRAGMENT_SHADER = `\nprecision mediump float;\nuniform sampler2D uFont;\nvarying vec2 vTexCoord;\nvarying vec3 vColor;\nvarying vec3 vBgColor;\n\nvoid main() {\n  vec4 color = texture2D(uFont, vTexCoord);\n  color.rgb = mix(vBgColor, vColor, color.rgb);\n  gl_FragColor = color;\n}\n`\n\n/// Class: WebGLRenderer\n/// Renders the <Viewport> with WebGL.\n/// Given decent GPU drivers and browser support, this is the fastest renderer.\n///\n/// *Note:* This is an internal class used by <Viewport>\nclass WebGLRenderer implements Renderer {\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n  private offscreen: HTMLCanvasElement\n\n  public gl: WebGLRenderingContext\n\n  private charMap: any\n  private charArray: any\n  private defaultColors: any\n  private attribs: any\n\n  private th?: number\n  private tw?: number\n  private gap?: number\n  private pad?: number\n\n  private tileCountsLocation: WebGLUniformLocation\n  private paddingLocation: WebGLUniformLocation\n\n  constructor(private view: Viewport) {\n    this.view = view\n    this.canvas = document.createElement('canvas')\n    // Try to fetch the context\n    if (!this.canvas.getContext) throw('Canvas not supported')\n    this.gl = this.canvas.getContext('experimental-webgl')\n    if (!this.gl) throw('WebGL not supported')\n    view.elem.appendChild(this.canvas)\n\n    this.charMap = {}\n    this.charArray = []\n    this.defaultColors = { r: 1.0, g: 1.0, b: 1.0, br: 0.0, bg: 0.0, bb: 0.0 }\n\n    this.attribs = {\n      position:  { buffer: null, data: null, itemSize: 2, location: null, hint: this.gl.STATIC_DRAW },\n      texCoord:  { buffer: null, data: null, itemSize: 2, location: null, hint: this.gl.STATIC_DRAW },\n      color:     { buffer: null, data: null, itemSize: 3, location: null, hint: this.gl.DYNAMIC_DRAW },\n      bgColor:   { buffer: null, data: null, itemSize: 3, location: null, hint: this.gl.DYNAMIC_DRAW },\n      charIndex: { buffer: null, data: null, itemSize: 1, location: null, hint: this.gl.DYNAMIC_DRAW }\n    }\n\n\n    // Create an offscreen canvas for rendering text to texture\n    if (!this.offscreen)\n      this.offscreen = document.createElement('canvas')\n    this.offscreen.style.position = 'absolute'\n    this.offscreen.style.top = '0px'\n    this.offscreen.style.left = '0px'\n    this.ctx = this.offscreen.getContext('2d')\n    if (!this.ctx) throw 'Failed to acquire offscreen canvas drawing context'\n    // WebGL drawing canvas\n    this.updateStyle()\n    this.canvas.width = (view.squarify ? this.th : this.tw) * view.w\n    this.canvas.height = this.th * view.h\n    this.offscreen.width = 0\n    this.offscreen.height = 0\n    // Doing this again since setting canvas w/h resets the state\n    this.updateStyle()\n\n    this.gl.viewport(0, 0, this.canvas.width, this.canvas.height)\n\n    let vertexShader = this.compileShader(this.gl.VERTEX_SHADER, VERTEX_SHADER)\n    let fragmentShader = this.compileShader(this.gl.FRAGMENT_SHADER, FRAGMENT_SHADER)\n    let program = this.gl.createProgram()\n    this.gl.attachShader(program, vertexShader)\n    this.gl.attachShader(program, fragmentShader)\n    this.gl.linkProgram(program)\n    this.gl.deleteShader(vertexShader)\n    this.gl.deleteShader(fragmentShader)\n    const ok = this.gl.getProgramParameter(program, this.gl.LINK_STATUS)\n    if (!ok) {\n      const msg = `Error linking program: ${this.gl.getProgramInfoLog(program)}`\n      this.gl.deleteProgram(program)\n      throw msg\n    }\n    this.gl.useProgram(program)\n\n    // Get attribute locations\n    this.attribs.position.location  = this.gl.getAttribLocation(program, 'position')\n    this.attribs.texCoord.location  = this.gl.getAttribLocation(program, 'texCoord')\n    this.attribs.color.location     = this.gl.getAttribLocation(program, 'color')\n    this.attribs.bgColor.location   = this.gl.getAttribLocation(program, 'bgColor')\n    this.attribs.charIndex.location = this.gl.getAttribLocation(program, 'charIndex')\n\n    // Setup buffers and uniforms\n    this.initBuffers()\n    let resolutionLocation = this.gl.getUniformLocation(program, 'uResolution')\n    this.gl.uniform2f(resolutionLocation, this.canvas.width, this.canvas.height)\n    this.tileCountsLocation = this.gl.getUniformLocation(program, 'uTileCounts')\n    this.gl.uniform2f(this.tileCountsLocation, this.view.w, this.view.h)\n    this.paddingLocation = this.gl.getUniformLocation(program, 'uPadding')\n    this.gl.uniform2f(this.paddingLocation, 0.0, 0.0)\n\n    // Setup texture\n    // view.elem.appendChild(this.offscreen) // Debug offscreen\n    let texture = this.gl.createTexture()\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture)\n    this.cacheChars(` !\\\"#$%&'()*+,-./0123456789:<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_\\`abcdefghijklmnopqrstuvwxyz{|}~`)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE)\n    this.gl.activeTexture(this.gl.TEXTURE0)\n\n    setTimeout(() => {\n      this.updateStyle()\n      this.buildTexture()\n      this.render()\n    }, 100)\n  }\n\n  public getRendererString(): string { return 'webgl' }\n\n  private buildTexture() {\n    let w = this.offscreen.width / (this.tw + this.pad),\n          h = this.offscreen.height / (this.th + this.pad)\n    // Check if need to resize the canvas\n    const charCount = this.charArray.length\n    if (charCount > Math.floor(w) * Math.floor(h)) {\n      w = Math.ceil(Math.sqrt(charCount))\n      h = w + 2 // Allocate some extra space too\n      this.offscreen.width = w * (this.tw + this.pad)\n      this.offscreen.height = h * (this.th + this.pad)\n      this.updateStyle()\n      this.gl.uniform2f(this.tileCountsLocation, w, h)\n    }\n    this.gl.uniform2f(this.paddingLocation, this.pad / this.offscreen.width, this.pad / this.offscreen.height)\n\n    let c = 0, ch: string\n    this.ctx.fillStyle = '#000000'\n    this.ctx.fillRect(0, 0, this.offscreen.width, this.offscreen.height)\n    this.ctx.fillStyle = '#ffffff'\n\n    const halfGap = 0.5 * this.gap // Squarification\n    const tw = this.tw + this.pad,\n          th = this.th + this.pad\n    let y = 0.5 * th // Half because textBaseline is middle\n    for (let j = 0; j < h; ++j) {\n      let x = this.pad * 0.5\n      for (let i = 0; i < w; ++i, ++c) {\n        ch = this.charArray[c]\n        if (ch === undefined) break\n        this.ctx.fillText(ch, x + halfGap, y)\n        x += tw\n      }\n      if (!ch) break\n      y += th\n    }\n    this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.offscreen)\n  }\n\n  private cacheChars(chars: string, build: boolean = true) {\n    if (!this.gl) return // Nothing to do if not using WebGL renderer\n    let changed = false\n    for (let i = 0; i < chars.length; ++i) {\n      if (!this.charMap[chars[i]]) {\n        changed = true\n        this.charArray.push(chars[i])\n        this.charMap[chars[i]] = this.charArray.length - 1\n      }\n    }\n\n    if (changed && build) this.buildTexture()\n  }\n\n  public updateStyle(s?: any) {\n    s = s || window.getComputedStyle(this.view.elem, null)\n    this.ctx.font = s.fontSize + '/' + s.lineHeight + ' ' + s.fontFamily\n    this.ctx.textBaseline = 'middle'\n    this.ctx.fillStyle = '#ffffff'\n    this.tw = this.ctx.measureText('幅').width // TODO: Make a parameter\n    this.th = parseInt(s.fontSize, 10)\n    this.gap = this.view.squarify ? (this.th - this.tw) : 0\n    if (this.view.squarify) this.tw = this.th\n    this.pad = Math.ceil(this.th * 0.2) * 2.0 // Must be even number\n\n    const color = s.color.match(/\\d+/g)\n    const bgColor = s.backgroundColor.match(/\\d+/g)\n    this.defaultColors.r = parseInt(color[0], 10) / 255\n    this.defaultColors.g = parseInt(color[1], 10) / 255\n    this.defaultColors.b = parseInt(color[2], 10) / 255\n    this.defaultColors.br = parseInt(bgColor[0], 10) / 255\n    this.defaultColors.bg = parseInt(bgColor[1], 10) / 255\n    this.defaultColors.bb = parseInt(bgColor[2], 10) / 255\n  }\n\n  public clear() { /* No op */ }\n\n  public render() {\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT)\n    const w = this.view.w,\n      h = this.view.h\n\n    // Create new tile data\n    let tiles = this.view.buffer\n    let defaultColor = this.view.defaultColor\n    let defaultBgColor = this.view.defaultBackground\n    let newChars = false\n\n    for (let j = 0; j < h; ++j) {\n      for (let i = 0; i < w; ++i) {\n        const tile = tiles[j][i]\n        let ch = this.charMap[tile.ch]\n        if (ch === undefined) { // Auto-cache new characters\n          this.cacheChars(tile.ch, false)\n          newChars = true\n          ch = this.charMap[tile.ch]\n        }\n        const k = this.attribs.color.itemSize * 6 * (j * w + i)\n        const kk = this.attribs.charIndex.itemSize * 6 * (j * w + i)\n        const r = tile.r === undefined ? this.defaultColors.r : tile.r / 255\n        const g = tile.g === undefined ? this.defaultColors.g : tile.g / 255\n        const b = tile.b === undefined ? this.defaultColors.b : tile.b / 255\n        const br = tile.br === undefined ? this.defaultColors.br : tile.br / 255\n        const bg = tile.bg === undefined ? this.defaultColors.bg : tile.bg / 255\n        const bb = tile.bb === undefined ? this.defaultColors.bb : tile.bb / 255\n        for (let m = 0; m < 6; ++m) {\n          const n = k + m * this.attribs.color.itemSize\n          this.attribs.color.data[n + 0] = r\n          this.attribs.color.data[n + 1] = g\n          this.attribs.color.data[n + 2] = b\n          this.attribs.bgColor.data[n + 0] = br\n          this.attribs.bgColor.data[n + 1] = bg\n          this.attribs.bgColor.data[n + 2] = bb\n          this.attribs.charIndex.data[kk + m] = ch\n        }\n      }\n    }\n\n    // Upload\n    if (newChars) this.buildTexture()\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.color.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.color.data, this.attribs.color.hint)\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.bgColor.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.bgColor.data, this.attribs.bgColor.hint)\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.charIndex.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.charIndex.data, this.attribs.charIndex.hint)\n\n    const attrib = this.attribs.position\n    this.gl.drawArrays(this.gl.TRIANGLES, 0, attrib.data.length / attrib.itemSize)\n  }\n\n  // Setup GLSL\n  private compileShader(type: number, source: string) {\n    const shader = this.gl.createShader(type)\n    this.gl.shaderSource(shader, source)\n    this.gl.compileShader(shader)\n    const ok = this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)\n    if (!ok) {\n      const msg = 'Error compiling shader: ' + this.gl.getShaderInfoLog(shader)\n      this.gl.deleteShader(shader)\n      throw msg\n    }\n    return shader\n  }\n\n  private initBuffers() {\n    let a, attrib, attribs = this.attribs\n\n    const w = this.view.w,\n          h = this.view.h\n\n    // Allocate data arrays\n    for (a in this.attribs) {\n      attrib = attribs[a]\n      attrib.data = new Float32Array(attrib.itemSize * 6 * w * h)\n    }\n    // Generate static data\n    for (let j = 0; j < h; ++j) {\n      for (let i = 0; i < w; ++i) {\n        // Position & texCoords\n        const k = attribs.position.itemSize * 6 * (j * w + i)\n        this.insertQuad(attribs.position.data, k, i * this.tw, j * this.th, this.tw, this.th)\n        this.insertQuad(attribs.texCoord.data, k, 0.0, 0.0, 1.0, 1.0)\n      }\n    }\n    // Upload\n    for (a in this.attribs) {\n      attrib = attribs[a]\n      if (attrib.buffer) this.gl.deleteBuffer(attrib.buffer)\n      attrib.buffer = this.gl.createBuffer()\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, attrib.buffer)\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, attrib.data, attrib.hint)\n      this.gl.enableVertexAttribArray(attrib.location)\n      this.gl.vertexAttribPointer(attrib.location, attrib.itemSize, this.gl.FLOAT, false, 0, 0)\n    }\n  }\n\n  private insertQuad(arr: number[], i: number, x: number, y: number, w: number, h: number) {\n    const x1 = x,\n          y1 = y,\n          x2 = x + w,\n          y2 = y + h\n\n    arr[  i] = x1\n    arr[++i] = y1\n    arr[++i] = x2\n    arr[++i] = y1\n    arr[++i] = x1\n    arr[++i] = y2\n    arr[++i] = x1\n    arr[++i] = y2\n    arr[++i] = x2\n    arr[++i] = y1\n    arr[++i] = x2\n    arr[++i] = y2\n  }\n}\n\nexport const webGLRenderer = function(viewport: Viewport): Renderer {\n  return new WebGLRenderer(viewport)\n}\n","import { Tile } from '../vendor/unicodetiles.ts/src/index'\n\nimport {\n  Item,\n  ItemGroup,\n} from '../src/engine'\n\nconst DEFAULT_GREY: number = 120\nconst IMPORTANT_GREY: number = 180\nconst DEFAULT_LIT = { r: 255, g: 165, b: 0 }\n\nexport class DisplayTile extends Tile {\n  public lighted(degree: number): Tile {\n    return this\n  }\n\n  constructor(char: string, r = DEFAULT_GREY, g = DEFAULT_GREY, b = DEFAULT_GREY) {\n    super(char, r, g, b)\n  }\n\n  protected litBackground(tile: Tile, degree: number): Tile {\n    tile.setBackground(\n      DEFAULT_LIT.r * degree,\n      DEFAULT_LIT.g * degree,\n      DEFAULT_LIT.b * degree,\n    )\n    return tile\n  }\n\n  protected litColor(tile: Tile, degree: number): Tile {\n    tile.setColor(\n      DEFAULT_LIT.r * degree,\n      DEFAULT_LIT.g * degree,\n      DEFAULT_LIT.b * degree,\n    )\n    return tile\n  }\n}\n\nabstract class ImportantTile extends DisplayTile {\n  constructor(char: string) {\n    super(char, IMPORTANT_GREY, IMPORTANT_GREY, IMPORTANT_GREY)\n  }\n}\n\nexport class CreatureTile extends ImportantTile {\n  constructor(\n    char: string,\n    public vr: number,\n    public vg: number,\n    public vb: number,\n  ) {\n    super(char)\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    tile.setColor(this.vr, this.vg, this.vb)\n\n    return tile\n  }\n}\n\nexport class DoorTile extends DisplayTile {\n  constructor() {\n    super('戸')\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    this.litColor(tile, degree)\n    tile.swapColors()\n\n    return tile\n  }\n}\n\nexport class FloorTile extends DisplayTile {\n  constructor() {\n    super('・')\n  }\n\n  public lighted(degree: number) {\n    return this.litColor(this.clone(), degree)\n  }\n}\n\nexport class WallTile extends DisplayTile {\n  constructor() {\n    super('＃')\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    this.litBackground(tile, degree)\n    tile.backgroundToColor()\n\n    return tile\n  }\n}\n\nexport class StairwayDown extends DisplayTile {\n  constructor() {\n    super('＞')\n  }\n}\n\nexport class StairwayUp extends DisplayTile {\n  constructor() {\n    super('＜')\n  }\n}\n\nexport class ItemTile extends DisplayTile {\n  constructor(\n    char: string,\n    public vr: number,\n    public vg: number,\n    public vb: number,\n  ) {\n    super(char)\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    tile.setColor(this.vr, this.vg, this.vb)\n\n    return tile\n  }\n}\n\nconst WEAPON = new ItemTile('刀', 200, 200, 200)\nconst CORPSE = new ItemTile('体', 200, 200, 200)\nconst BODY_ARMOR = new ItemTile('胸', 200, 200, 200)\nconst MISSILE = new ItemTile('石', 200, 200, 200)\n\nexport const displayItem = function(item: Item): ItemTile {\n  switch (item.group) {\n    case ItemGroup.OneHandWeapon:\n      return WEAPON\n    case ItemGroup.Consumable:\n      return CORPSE\n    case ItemGroup.BodyArmor:\n      return BODY_ARMOR\n    case ItemGroup.Missile:\n      return MISSILE\n    default:\n      throw `Unknown group ${item} with type ${item.group}`\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport Stats from './stats.vue'\n\nimport {\n  domRenderer,\n  canvasRenderer,\n  webGLRenderer,\n  Engine,\n  Viewport,\n  Tile,\n} from '../vendor/unicodetiles.ts/src/index'\n\nimport {\n  CreatureTile,\n  DoorTile,\n  FloorTile,\n  ItemTile,\n  WallTile,\n  StairwayUp,\n  StairwayDown,\n  DisplayTile,\n\n  displayItem,\n} from './scene_tiles'\n\nconst HUMAN  = new CreatureTile('俺', 0, 255, 0)\nconst HUMAN2 = new CreatureTile('俺', 255, 0, 0)\nconst HUMAN3 = new CreatureTile('俺', 0, 0, 255)\nconst HUMAN4 = new CreatureTile('俺', 255, 0, 255)\nconst HUMAN5 = new CreatureTile('俺', 0, 255, 255)\n\nconst RAT = new CreatureTile('ｄ', 197, 65, 38)\n\nconst DOOR = new DoorTile()\nconst WALL = new WallTile()\nconst FLOOR = new FloorTile()\nconst STAIRWAY_DOWN = new StairwayDown()\nconst STAIRWAY_UP = new StairwayUp()\nconst NULLTILE = new DisplayTile('　', 0, 0, 0)\n\nconst nextItemAnimation = [\n  new ItemTile('｜', 200, 200, 200),\n  new ItemTile('／', 200, 200, 200),\n  new ItemTile('ー', 200, 200, 200),\n  new ItemTile('＼', 200, 200, 200),\n]\n\nexport default Vue.extend({\n  props: ['level', 'player'],\n  data() {\n    return {\n      wholeMap: false,\n      term: null,\n      eng: null,\n      drawInterval: null,\n      ts: Date.now(),\n      fps: 0,\n      counter: 0,\n      interval: 100,\n      step: 0,\n    }\n  },\n  components: {\n    Stats\n  },\n  methods: {\n    getTile(x, y) {\n      const effect = this.stage.at(x, y).effect\n      if (effect) {\n        return new DisplayTile(effect, 200, 200, 0)\n      }\n\n      const tile = this.wholeMap ? this.stage.at(x, y) : this.stage.at(x, y).tile\n\n      if (!tile) {\n        return NULLTILE\n      }\n\n      if (tile.creature) {\n        if (tile.creature.name() == 'Rat') {\n          return RAT\n        }\n\n        switch (tile.creature.id % 5) {\n          case 0:\n            return HUMAN5\n          case 1:\n            return HUMAN4\n          case 2:\n            return HUMAN3\n          case 3:\n            return HUMAN2\n          case 4:\n            return HUMAN\n        }\n      }\n\n      if (tile.items) {\n        switch (tile.items.bunch.length) {\n        case 0:\n          break;\n        case 1:\n          return displayItem(tile.items.bunch[0].item)\n        default:\n          const frame = this.step % (this.animationFps * 3 + 4)\n          if (frame < nextItemAnimation.length) {\n            return nextItemAnimation[frame]\n          } else {\n            const itemId = Math.floor(this.step / (this.animationFps * 3 + 4))\n\n            return displayItem(tile.items.bunch[itemId % tile.items.bunch.length].item)\n          }\n        }\n      }\n\n      switch (tile.display) {\n      case '#':\n        return WALL\n      case '+':\n        return DOOR\n      case ' ':\n        return FLOOR\n      case '<':\n        return STAIRWAY_UP\n      case '>':\n        return STAIRWAY_DOWN\n      default:\n        return NULLTILE\n      }\n    },\n    initViewport() {\n      this.term = new Viewport(\n        this.$refs.scene,\n        this.level.width,\n        this.level.height,\n        webGLRenderer,\n        true,\n      )\n\n      this.eng = new Engine(\n        this.term,\n        (x, y) => this.getTile(x, y),\n        this.level.width,\n        this.level.height,\n      )\n\n      this.eng.setMaskFunc((x, y) => {\n        return this.wholeMap || this.stage.at(x, y).seen\n      });\n\n      this.eng.setShaderFunc((tile, x, y, time) => {\n        return this.lighting(tile, x, y, time)\n      })\n\n      clearInterval(this.drawInterval)\n      this.drawInterval = setInterval(() => { this.drawScene() }, this.interval)\n    },\n    drawScene() {\n      const ts = Date.now()\n      if (this.ts + 1000 < ts) {\n        this.fps = this.counter\n        this.counter = 0\n        this.ts = ts\n      }\n\n      // this.eng.update(this.player.x, this.player.y);\n      this.eng.update(this.term.cx, this.term.cy);\n      this.term.render();\n\n      this.counter += 1\n      this.step += 1\n    },\n    lighting(tile, x, y, time) {\n      if (this.wholeMap) {\n        return tile.lighted(1)\n      }\n      const fovTile = this.stage.at(x, y)\n\n      if (fovTile.visible && tile.lighted) {\n        return tile.lighted(fovTile.degree)\n      }\n\n      return tile\n    },\n  },\n  computed: {\n    stage() {\n      return this.wholeMap ? this.level : this.player.stageMemory(this.level.id)\n    },\n    animationFps() {\n      return 1000 / this.interval\n    },\n    tileItems() {\n      let items = this.stage.at(this.player.pos.x, this.player.pos.y).items()\n      return items && items.bunch\n    }\n  },\n  mounted() {\n    this.initViewport()\n  },\n  beforeDestroy() {\n    clearInterval(this.drawInterval)\n  },\n  watch: {\n    interval() {\n      this.initViewport()\n    }\n  }\n})\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Scene.vue?vue&type=template&id=8e7ef5a0\"\nimport script from \"./Scene.vue?vue&type=script&lang=ts\"\nexport * from \"./Scene.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Scene.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"scene\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col mr-0\"},[_c('div',{ref:\"scene\",staticClass:\"unicodetiles\"})]),_vm._v(\" \"),_c('div',{staticClass:\"col pl-0\"},[_c('div',{staticClass:\"fps mb-2 \"},[_vm._v(\"FPS \"+_vm._s(_vm.fps))]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n        MAP \"+_vm._s(_vm.level.id)+\"\\n        \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.wholeMap),expression:\"wholeMap\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.wholeMap)?_vm._i(_vm.wholeMap,null)>-1:(_vm.wholeMap)},on:{\"change\":function($event){var $$a=_vm.wholeMap,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.wholeMap=$$a.concat([$$v]))}else{$$i>-1&&(_vm.wholeMap=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.wholeMap=$$c}}}})]),_vm._v(\" \"),_c('Stats',{attrs:{\"creature\":_vm.player}}),_vm._v(\" \"),_c('ul',_vm._l((_vm.tileItems),function(group){return _c('li',{key:group.item.name},[_vm._v(\"\\n          \"+_vm._s(group.count)+\": \"+_vm._s(group.item.name)+\"\\n        \")])}))],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IdleScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IdleScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\nimport Vue from 'vue'\nimport { IdleInputKey } from '../../src/engine'\n\nexport default Vue.extend({\n  name: 'IdleScreen',\n  props: ['screen'],\n  methods: {\n    close(inputKey) {\n      this.screen.onInput(inputKey)\n    },\n    onEvent(event) {\n      switch (event.key) {\n      case 'l':\n      case 'ArrowRight':\n        return this.close(IdleInputKey.Right)\n\n      case 'h':\n      case 'ArrowLeft':\n        return this.close(IdleInputKey.Left)\n\n      case 'k':\n      case 'ArrowUp':\n        return this.close(IdleInputKey.Up)\n\n      case 'j':\n      case 'ArrowDown':\n        return this.close(IdleInputKey.Down)\n\n      case 'y':\n        return this.close(IdleInputKey.UpLeft)\n      case 'u':\n        return this.close(IdleInputKey.UpRight)\n      case 'b':\n        return this.close(IdleInputKey.DownLeft)\n      case 'n':\n        return this.close(IdleInputKey.DownRight)\n\n      case 'H':\n        return this.close(IdleInputKey.Handle)\n\n      case 'i':\n        return this.close(IdleInputKey.Inventory)\n      case ',':\n        return this.close(IdleInputKey.PickUp)\n      case 'd':\n        return this.close(IdleInputKey.Drop)\n      }\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./IdleScreen.vue?vue&type=template&id=0540edd5\"\nimport script from \"./IdleScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./IdleScreen.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nexport default Vue.extend({\n  props: ['screen'],\n  data() {\n    return {\n      picked: null\n    }\n  },\n  methods: {\n    close(doubleClickOption) {\n      this.screen.onInput(doubleClickOption || this.picked)\n    },\n    onEvent(event) {\n      switch(event.key) {\n      case 'a':\n        this.picked = this.screen.options[0]\n        break\n      case 'b':\n        this.picked = this.screen.options[1]\n        break\n      case ' ':\n      case 'Enter':\n        this.close()\n      default:\n        return\n      }\n    },\n    iconPath(professionId: number) {\n      return 'assets/professions/' + [\n        'acrobatic.svg',\n        'button-finger.svg',\n        'disintegrate.svg',\n        'flying-fox.svg',\n        'amputation.svg',\n        'catch.svg',\n        'divert.svg',\n        'fruiting.svg',\n        'annexation.svg',\n        'conversation.svg',\n        'dodging.svg',\n        'grab.svg',\n        'arrest.svg',\n        'convince.svg',\n        'drinking.svg',\n        'journey.svg',\n        'back-forth.svg',\n        'coronation.svg',\n        'drop-weapon.svg',\n        'juggler.svg',\n        'backstab.svg',\n        'crafting.svg',\n        'drowning.svg',\n        'jump-across.svg',\n        'boot-stomp.svg',\n        'crush.svg',\n        'eating.svg',\n        'kindle.svg',\n        'bowman.svg',\n        'discussion.svg',\n        'expander.svg',\n        'kneeling.svg',\n      ][professionId]\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./ProfessionPickingScreen.vue?vue&type=template&id=55ebf7fd\"\nimport script from \"./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal text-center\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.screen.title))]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},_vm._l((_vm.screen.options),function(option){return _c('div',{key:option.id,staticClass:\"option p-2 m-3\",class:{ 'picked': _vm.picked && _vm.picked.id === option.id },on:{\"click\":function($event){_vm.picked = option},\"dblclick\":function($event){_vm.close(option)}}},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.iconPath(option.id)}}),_vm._v(\" \"),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(option.name))])])})),_vm._v(\" \"),_c('div',{staticClass:\"bottom\"},[(_vm.picked !== null)?_c('b-btn',{attrs:{\"variant\":\"success\"},on:{\"click\":_vm.close}},[_vm._v(\"Подтвердить\")]):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nconst LETTER_OFFSET = 97\n\nexport default Vue.extend({\n  name: 'Inventory',\n  props: ['screen'],\n  data() {\n    return {\n      page: 0,\n      perPage: 20,\n      selected: [],\n    }\n  },\n  computed: {\n    player() {\n      return this.screen.player\n    }\n  },\n  methods: {\n    onEvent(event) {\n      switch (event.key) {\n      case 'Escape':\n        return this.screen.close()\n      case 'Enter':\n      case ' ':\n        return this.screen.pickUpItems(this.selected.map(index => this.screen.positions[index]))\n      default:\n        return this.selectAt(event.key.charCodeAt(0) - LETTER_OFFSET)\n      }\n    },\n    selectAt(i: number) {\n      if (i >= 0 && i < Math.min(this.perPage, this.screen.positions.length)) {\n        if (this.screen.singleItemMode) {\n          this.screen.withItem(this.screen.positions[i])\n        } else if (this.selected.indexOf(i) >= 0) {\n          this.selected.splice(this.selected.indexOf(i), 1)\n        } else {\n          this.selected.push(i)\n        }\n      }\n    },\n    indexLetter(i: number): string {\n      return String.fromCharCode(LETTER_OFFSET + i)\n    },\n    positionSelected(index) {\n      return this.selected.indexOf(index) >= 0\n    },\n    positionStatus(position) {\n      if (!position.item) {\n        return ''\n      } else {\n        return 'text-success'\n      }\n    }\n  }\n})\n","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./ItemsListingScreen.vue?vue&type=template&id=518ccf38\"\nimport script from \"./ItemsListingScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./ItemsListingScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.screen.title))]),_vm._v(\" \"),_c('table',{staticClass:\"container positions-list\"},_vm._l((_vm.screen.positions),function(position,index){return _c('tr',{key:index,class:_vm.positionStatus(position)},[_c('td',{staticClass:\"selected\"},[(_vm.positionSelected(index))?_c('div',{staticClass:\"sign\"},[_vm._v(\"\\n          +\\n        \")]):_vm._e()]),_vm._v(\" \"),_c('td',{staticClass:\"letter\"},[_vm._v(\"\\n        \"+_vm._s(_vm.indexLetter(index))+\"\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"separator\"},[_vm._v(\"\\n        —\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"name\"},[_vm._v(\"\\n        \"+_vm._s(position.item.name)+\" (\"+_vm._s(position.count)+\")\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"weight\"},[_vm._v(\"\\n        [\"+_vm._s(position.item.weight)+\"g]\\n      \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import {\n  dungeon,\n  drawn,\n  addDoors,\n  addCreatures,\n  addItems,\n  centralize,\n  addOnTile,\n  connectMaps,\n  Creature,\n  Clan,\n  Player,\n  Specie,\n  allAbilities,\n  Dispatcher,\n  OneHandWeapon,\n  Item,\n  LevelMap,\n  Pool,\n  BodyArmor,\n  Modifier,\n  Characteristics,\n  Game,\n  Point,\n  Level,\n  Ability,\n  Missile,\n  ProfessionPicker,\n  Profession,\n  GroupedItem,\n  MissileSlot,\n  PlayerAI,\n  Talent,\n} from './engine'\nimport { includes, sample } from 'lodash'\n\nexport type GeneratorOptions = {\n  minSize: number\n  maxSize: number\n  roomsCount: number\n\n  addDoors: boolean\n}\n\nexport let baseConfig = {\n  addDoors: false,\n  minSize: 3,\n  maxSize: 10,\n  roomsCount: 10,\n}\n\nconst weapons = new Pool<null, Item>([\n  [1, () => new OneHandWeapon('Katana', new Modifier({ attack: 10 }))],\n  [3, () => new OneHandWeapon('Axe', new Modifier({ attack: 7 }))],\n  [7, () => new OneHandWeapon('Dagger', new Modifier({ attack: 3 }))],\n  [5, () => new OneHandWeapon('Hammer', new Modifier({ attack: 5 }))],\n  [5, () => new Missile('Rock', new Modifier({}))],\n])\n\nconst itemsPool = new Pool<null, Item>([\n  [1, () => new BodyArmor('Кольчуга', new Modifier({ defense: 10 }))],\n  [5, () => new BodyArmor('Латы', new Modifier({ defense: 5 }))],\n  [10, () => new BodyArmor('Роба', new Modifier({ defense: 1 }))],\n])\n\nconst newCreature = (characteristics: Characteristics, name: string) => {\n  return new Creature(\n    characteristics,\n    new Dispatcher(),\n    new Specie(name, Clan.PlayerOnlyEnemy, [])\n  )\n}\n\nconst floatingEye = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 1,\n      defense: 1,\n      dexterity: 1,\n      health: 100,\n      radius: 5,\n      speed: 200,\n    }),\n    'Floating eye'\n  )\n}\n\nconst rat = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 1,\n      defense: 1,\n      dexterity: 1,\n      health: 1,\n      radius: 5,\n      speed: 90,\n    }),\n    'Rat'\n  )\n}\n\nconst orc = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 3,\n      defense: 3,\n      dexterity: 2,\n      health: 5,\n      radius: 5,\n      speed: 100,\n    }),\n    'Orc'\n  )\n}\n\nconst undead = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 2,\n      defense: 7,\n      dexterity: 1,\n      health: 10,\n      radius: 5,\n      speed: 120,\n    }),\n    'Undead'\n  )\n}\n\nconst robot = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 5,\n      defense: 5,\n      dexterity: 3,\n      health: 7,\n      radius: 7,\n      speed: 90,\n    }),\n    'Robot'\n  )\n}\n\nconst dragon = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 7,\n      defense: 7,\n      dexterity: 7,\n      health: 30,\n      radius: 5,\n      speed: 100,\n    }),\n    'Dragon'\n  )\n}\n\nconst creaturesPool1 = new Pool<null, Creature>([[1, rat]])\nconst creaturesPool2 = new Pool<null, Creature>([[1, rat], [2, orc]])\nconst creaturesPool3 = new Pool<null, Creature>([\n  [1, rat],\n  [1, orc],\n  [2, undead],\n])\nconst creaturesPool4 = new Pool<null, Creature>([[2, undead], [2, robot]])\nconst creaturesPool5 = new Pool<null, Creature>([[2, robot], [1, dragon]])\n\nexport class OnisunProfessionPicker extends ProfessionPicker {\n  constructor(\n    private pool: Profession[],\n    private maxLevel: number,\n    private maxTaken: number\n  ) {\n    super()\n  }\n\n  public available(player: Player): Profession[] {\n    let professions: Profession[] = []\n\n    if (this.canUpdate(player)) {\n      professions.push(this.updatableProfession(player))\n    } else if (this.canTakeNewProfession(player)) {\n      professions.push(this.newFromPool(player))\n    }\n\n    if (this.canTakeNewProfession(player)) {\n      professions.push(\n        this.newFromPool(player, professions.map(profession => profession.id))\n      )\n    } else if (this.canUpdate(player)) {\n      professions.push(\n        this.updatableProfession(\n          player,\n          professions.map(profession => profession.id)\n        )\n      )\n    }\n\n    return professions\n  }\n\n  protected canUpdate(player: Player): boolean {\n    return player.professions.some(\n      profession => profession.level < this.maxLevel\n    )\n  }\n\n  protected updatableProfession(\n    player: Player,\n    excludeProfessions: number[] = []\n  ): Profession {\n    return sample(\n      player.professions.filter(\n        profession => !includes(excludeProfessions, profession.id)\n      )\n    )\n  }\n\n  protected canTakeNewProfession(player: Player): boolean {\n    return player.professions.length < this.maxTaken\n  }\n\n  protected newFromPool(\n    player: Player,\n    excludeProfessions: number[] = []\n  ): Profession {\n    const excluding = excludeProfessions.concat(\n      player.professions.map(profession => profession.id)\n    )\n    return sample(\n      this.pool.filter(profession => !includes(excluding, profession.id))\n    )\n  }\n}\n\nexport enum OnisunTalentId {\n  AttackerTwoHandedWeapons,\n  AttackerHeavyWeapons,\n  AttackerLightWeapons,\n  AttackerTwoWeapons,\n  AttackerDoubleTwoHandedWeapons,\n  AttackerStrongGrip,\n}\n\nexport class OnisunTalent extends Talent {\n  constructor(\n    public readonly id: OnisunTalentId,\n    name: string,\n    depth: number,\n    rank: number,\n    maxRank: number,\n    description: string = ''\n  ) {\n    super(name, depth, rank, maxRank, description)\n  }\n}\n\nexport class OnisunDefenderProfession extends Profession {\n  public readonly depthCost: number = 3\n\n  constructor(\n    public readonly id: number,\n    public readonly name: string,\n    public level: number = 1\n  ) {\n    super(id, name, level)\n\n    // TODO: Validate all Talent's ids are uniq\n\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerTwoHandedWeapons,\n        'Двуручные оружия',\n        0,\n        0,\n        3\n      )\n    )\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerLightWeapons,\n        'Легкие оружия',\n        0,\n        0,\n        3\n      )\n    )\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerHeavyWeapons,\n        'Тяжелые оружия',\n        0,\n        0,\n        3\n      )\n    )\n\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerTwoWeapons,\n        'Два оружия',\n        1,\n        0,\n        1,\n        'Позволяет брать оружие в каждую руку'\n      )\n    )\n    // this.talents.push(new OnisunTalent(OnisunTalentId.Defender, 'Быстрые удары', 1, 0, 3))\n    // this.talents.push(new OnisunTalent(OnisunTalentId.Defender, 'Мощный удар', 1, 0, 4))\n    // this.talents.push(new OnisunTalent(OnisunTalentId.Defender, 'Выбивание оружия', 1, 0, 5))\n\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerDoubleTwoHandedWeapons,\n        'Два двуручных оружия',\n        2,\n        0,\n        2\n      )\n    )\n    // this.talents.push(new OnisunTalent(OnisunTalentId.Defender, '- серия', 2, 0, 2))\n    this.talents.push(\n      new OnisunTalent(\n        OnisunTalentId.AttackerStrongGrip,\n        'Крепкий хват',\n        2,\n        0,\n        2,\n        'Оружие не выбивается из рук'\n      )\n    )\n  }\n}\n\nexport class Onisun extends Game {\n  constructor(generatorOptions: GeneratorOptions) {\n    let pool: Profession[] = []\n    ;[\n      'ботаник',\n      'библиотекарь',\n      'архитектор',\n\n      'ученый',\n      'флорист',\n      'художник',\n\n      'судья',\n      'солдат',\n      'спасатель',\n\n      'программист',\n      'портной',\n      'повар',\n    ].forEach((name, i) => {\n      pool.push(new Profession(i, name, 1))\n    })\n\n    super(new OnisunProfessionPicker(pool, 3, 6))\n\n    this.player = this.initPlayer()\n\n    this.player.professions.push(new OnisunDefenderProfession(1, 'Оружейник'))\n    this.player.professions.push(new OnisunDefenderProfession(2, 'Воин'))\n    this.player.professions.push(new OnisunDefenderProfession(3, 'Маг'))\n    this.player.professions.push(new OnisunDefenderProfession(4, ' Повар'))\n    this.player.professions.push(new OnisunDefenderProfession(5, 'Колдун'))\n\n    let map1 = this.generateMap(generatorOptions)\n    let map2 = this.generateMap(generatorOptions)\n    // let map3 = this.generateMap(generatorOptions)\n    // let map4 = this.generateMap(generatorOptions)\n    // let map5 = this.generateMap(generatorOptions)\n\n    // addCreatures(0.05, map1, creaturesPool1)\n    // addCreatures(0.06, map2, creaturesPool2)\n    // addCreatures(0.07, map3, creaturesPool3)\n    // addCreatures(0.08, map4, creaturesPool4)\n    // addCreatures(0.09, map5, creaturesPool5)\n\n    connectMaps(map1, map2)\n    // connectMaps(map2, map3)\n    // connectMaps(map3, map4)\n    // connectMaps(map4, map5)\n\n    this.currentMap = map1\n\n    rat().addToMap(new Point(1, 3), this.currentMap)\n    rat().addToMap(new Point(1, 4), this.currentMap)\n\n    addOnTile(\n      this.currentMap,\n      tile => tile.isFloor() && tile.passibleThrough(),\n      (x, y) => {\n        this.player.addToMap(new Point(x, y), this.currentMap)\n      }\n    )\n  }\n\n  protected initPlayer(): Player {\n    const playerSpecie = new Specie('Player', Clan.Player, allAbilities)\n\n    let player = new Player(\n      new Level([1, 1, 1, 3, 10]),\n      new Characteristics({\n        attack: 1,\n        defense: 4,\n        dexterity: 3,\n        health: 10,\n        radius: 10,\n        speed: 100,\n      }),\n      new PlayerAI(),\n      // new Dispatcher(),\n      playerSpecie\n    )\n\n    const dagger = new OneHandWeapon('Dagger', new Modifier({ attack: 3 }))\n    const katana = new OneHandWeapon('Katana', new Modifier({ attack: 10 }))\n    const rock = new Missile('Rock', new Modifier({}))\n    player.inventory.putToBag(dagger, 2)\n    player.inventory.putToBag(katana, 1)\n    player.inventory.putToBag(rock, 30)\n    // player.putOn(RightHandSlot, dagger)\n    // player.putOn(MissileSlot, rock)\n\n    return player\n  }\n\n  protected generateMap(options: GeneratorOptions): LevelMap {\n    let map = dungeon(\n      20,\n      40,\n      options.minSize,\n      options.maxSize,\n      options.roomsCount\n    )\n\n    map = drawn([\n      'WWWWWWWWWWW',\n      'WRRRRRRRRRW',\n      'WRRRRRRRRRW',\n      'WRRRRRRRRRW',\n      'WRRRRRRRRRW',\n      'WRRRRRRRRRW',\n      'WWWWWWWWWWW',\n    ])\n\n    if (options.addDoors) {\n      addDoors(map)\n    }\n    centralize(map)\n    map.game = this\n\n    addItems(0.05, map, weapons.merge(itemsPool))\n\n    return map\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { OnisunTalentId } from 'src/onisun'\n\nexport default Vue.extend({\n  props: ['screen'],\n  data() {\n    return {\n      pickedId: null,\n      professionIndex: 0\n    }\n  },\n  computed: {\n    profession() {\n      return this.screen.player.professions[this.professionIndex]\n    },\n    groupedTalents() {\n      let groups = new Array(5)\n      for (let i = 0; i < groups.length; i++) {\n        groups[i] = []\n      }\n\n      this.profession.talents.forEach(talent => groups[talent.depth].push(talent))\n\n      return groups\n    }\n  },\n  methods: {\n    close(doubleClickOption) {\n      if (doubleClickOption) {\n        switch (this.talentStatus(doubleClickOption)) {\n          case '-completed':\n          case '-unavailable':\n            return\n        }\n      }\n\n      this.screen.onInput(this.profession.id, (doubleClickOption && doubleClickOption.id) || this.pickedId)\n      this.pickedId = null\n    },\n    pickTalent(talent) {\n      if (this.talentStatus(talent) === '-available') {\n        this.pickedId = talent.id\n      }\n    },\n    onEvent(event) {\n\n    },\n    talentTip(talent) {\n      let tip = `${talent.rank}/${talent.maxRank}`\n      if (talent.rank >= talent.maxRank) {\n        return tip\n      } else {\n        return `a ${tip}`\n      }\n    },\n    talentStatus(talent) {\n      if (this.pickedId === talent.id) {\n        return '-selected'\n      } else if (talent.rank === talent.maxRank) {\n        return '-completed'\n      } else if (talent.depth * this.profession.depthCost > this.profession.points) {\n        return '-unavailable'\n      } else {\n        return '-available'\n      }\n    },\n    iconPath(talentId) {\n      switch(talentId) {\n        case OnisunTalentId.AttackerTwoHandedWeapons:\n          return 'AttackerTwoHandedWeapons.svg'\n        case OnisunTalentId.AttackerHeavyWeapons:\n          return 'AttackerHeavyWeapons.svg'\n        case OnisunTalentId.AttackerLightWeapons:\n          return 'AttackerLightWeapons.svg'\n        case OnisunTalentId.AttackerTwoWeapons:\n          return 'AttackerTwoWeapons.svg'\n        case OnisunTalentId.AttackerDoubleTwoHandedWeapons:\n          return 'AttackerDoubleTwoHandedWeapons.svg'\n        case OnisunTalentId.AttackerStrongGrip:\n          return 'AttackerStrongGrip.svg'\n      }\n    }\n  },\n  mounted() {\n  }\n})\n","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./TalentsTreeScreen.vue?vue&type=template&id=154713f6\"\nimport script from \"./TalentsTreeScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./TalentsTreeScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ability-picking text-center\",attrs:{\"id\":\"talents-tree-container\"}},[_c('b-tabs',{staticClass:\"tabs-list\",attrs:{\"card\":\"\"},model:{value:(_vm.professionIndex),callback:function ($$v) {_vm.professionIndex=$$v},expression:\"professionIndex\"}},_vm._l((_vm.screen.player.professions),function(profession){return _c('b-tab',{key:profession.id,attrs:{\"title\":profession.name,\"no-body\":\"\"}})})),_vm._v(\" \"),_c('table',{staticClass:\"content\"},_vm._l((_vm.groupedTalents),function(group,i){return _c('tr',{key:i},_vm._l((group),function(talent,j){return _c('td',{key:j,staticClass:\"cell\"},[(talent)?_c('div',{staticClass:\"talent-cell\",class:_vm.talentStatus(talent),attrs:{\"id\":j + 'exPopover1-'+i,\"variant\":\"primary\"},on:{\"click\":function($event){_vm.pickTalent(talent)},\"dblclick\":function($event){_vm.close(talent)}}},[_c('img',{staticClass:\"icon\",attrs:{\"src\":'assets/talents/' + _vm.iconPath(talent.id)}}),_vm._v(\" \"),_c('span',{staticClass:\"level\"},[_vm._v(_vm._s(_vm.talentTip(talent)))]),_vm._v(\" \"),_c('b-popover',{attrs:{\"target\":j + 'exPopover1-'+i,\"triggers\":\"hover\",\"container\":\"talents-tree-container\"}},[[_c('p',{staticClass:\"name\"},[_vm._v(\"\\n                  \"+_vm._s(talent.name)+\"\\n                \")]),_vm._v(\" \"),_c('small',[_c('p',{staticClass:\"rank\"},[_vm._v(\"\\n                    Уровень \"+_vm._s(talent.rank)+\"/\"+_vm._s(talent.maxRank)+\"\\n                  \")]),_vm._v(\" \"),(_vm.talentStatus(talent) === '-unavailable')?_c('p',{staticClass:\"requirements\"},[_vm._v(\"\\n                    Требуется \"+_vm._s(talent.depth * _vm.profession.depthCost)+\" очков в \"+_vm._s(_vm.profession.name)+\"\\n                  \")]):_vm._e(),_vm._v(\" \"),_c('p',{staticClass:\"description\"},[_vm._v(\"\\n                    \"+_vm._s(talent.description)+\"\\n                  \")])])]],2)],1):_vm._e()])}))})),_vm._v(\" \"),(_vm.pickedId !== null)?_c('b-btn',{attrs:{\"variant\":\"default\"},on:{\"click\":function($event){_vm.close()}}},[_vm._v(\"Подтвердить\")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport {\n  LeftHandSlot,\n  RightHandSlot,\n  BodySlot,\n  MissileSlot,\n} from '../../src/engine'\n\nimport {\n  displayItem,\n} from './../scene_tiles'\n\nconst LETTER_OFFSET = 97\n\nexport default Vue.extend({\n  name: 'Inventory',\n  props: ['screen'],\n  data() {\n    return {\n      page: 0,\n      perPage: 20,\n    }\n  },\n  computed: {\n    player() {\n      return this.screen.player\n    }\n  },\n  methods: {\n    onEvent(event) {\n      switch (event.key) {\n      case ' ':\n      case 'Escape':\n        return this.screen.close()\n      case 'Enter':\n      case ',':\n        return this.screen.pickUpItems(this.selected.map(index => this.screen.positions[index]))\n      default:\n        return this.selectAt(event.key.charCodeAt(0) - LETTER_OFFSET)\n      }\n    },\n    selectAt(i: number) {\n      if (i >= 0 && i < Math.min(this.perPage, this.screen.positions.length)) {\n        const position = this.screen.positions[i]\n        if (position.item) {\n          this.screen.takeOff(position)\n        } else if (position.availableItems.length) {\n          this.screen.putOn(position)\n        }\n      }\n    },\n    indexLetter(i: number): string {\n      return String.fromCharCode(LETTER_OFFSET + i)\n    },\n    positionSelected(index) {\n      return this.selected.indexOf(index) >= 0\n    },\n    positionStatus(position) {\n      if (!position.item) {\n        return ''\n      } else {\n        return 'text-success'\n      }\n    },\n    displayBodyPart(bodyPart) {\n      switch (bodyPart.id) {\n        case LeftHandSlot.id:\n          return 'Левая рука'\n        case RightHandSlot.id:\n          return 'Правая рука'\n        // case BodyPart.Legs:\n        //   return '足'\n        // case BodyPart.Finger:\n        //   return '指'\n        // case BodyPart.Head:\n        //   return '頭'\n        // case BodyPart.Eye:\n        //   return '目'\n        // case BodyPart.Neck:\n        //   return '首'\n        // case BodyPart.Back:\n        //   return '背'\n        case BodySlot.id:\n          return 'Корпус'\n        // case BodyPart.MissileWeapon:\n        //   return 'MissileWeapon'\n        case MissileSlot.id:\n          return 'Снаряды'\n        default:\n          throw `Unknow body part ${bodyPart}`\n      }\n    },\n    displayItem(item) {\n      if (item) {\n        return `${displayItem(item).getChar()} ${item.name}`\n      }\n    },\n    itemName(position) {\n      if (position.item) {\n        return `${position.item.name} (${position.count})`\n      } else {\n        return '-'\n      }\n    },\n    itemWeight(position) {\n      if (position.item) {\n        return `[${position.item.weight}g]`\n      }\n    },\n    available(position) {\n      return position.item || position.availableItems.length\n    },\n    availableStatus(position) {\n      return this.available(position) ? '-available' : '-unavailable'\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./InventoryScreen.vue?vue&type=template&id=c5310062\"\nimport script from \"./InventoryScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./InventoryScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"Инвентарь\")]),_vm._v(\" \"),_c('table',{staticClass:\"content inventory-list\"},_vm._l((_vm.screen.positions),function(position,index){return _c('tr',{key:index,class:_vm.availableStatus(position)},[_c('td',{staticClass:\"slot\"},[_c('span',{staticClass:\"letter\"},[_vm._v(\"\\n          \"+_vm._s(_vm.indexLetter(index))+\"\\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"dash\"},[_vm._v(\"\\n          —\\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"part\"},[_vm._v(\"\\n          \"+_vm._s(_vm.displayBodyPart(position.inventorySlot))+\"\\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"separator float-right\"},[_vm._v(\"\\n            :\\n        \")])]),_vm._v(\" \"),_c('td',{staticClass:\"name\",class:_vm.positionStatus(position)},[_vm._v(\"\\n        \"+_vm._s(_vm.itemName(position))+\"\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"weight\"},[_vm._v(\"\\n        \"+_vm._s(_vm.itemWeight(position))+\"\\n      \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport * as _ from 'lodash'\n\nimport Cell from './Cell.vue'\nimport Logger from './Logger.vue'\nimport Scene from './Scene.vue'\n\nimport Idle from './screens/IdleScreen.vue'\nimport ProfessionPickingScreen from './screens/ProfessionPickingScreen.vue'\nimport ItemsListingScreen from './screens/ItemsListingScreen.vue'\nimport TalentsTreeScreen from './screens/TalentsTreeScreen.vue'\nimport InventoryScreen from './screens/InventoryScreen.vue'\n\nimport { LevelMap, ScreenType, Screen } from '../src/engine'\n\nimport {\n  Onisun,\n  baseConfig,\n} from '../src/onisun'\nimport { setInterval, clearInterval } from 'timers';\n\nexport default Vue.extend({\n  data() {\n    return {\n      game: new Onisun(baseConfig),\n      ts: Date.now(),\n      generatorOptions: baseConfig,\n      loopIntervalId: undefined\n    }\n  },\n  components: {\n    Cell,\n    Logger,\n    Scene,\n  },\n  computed: {\n    screenComponent() {\n      switch (this.game.screen && this.game.screen.type) {\n      case ScreenType.AbilitiesPicking:\n        return TalentsTreeScreen\n      case ScreenType.ProfessionPicking:\n        return ProfessionPickingScreen\n      case ScreenType.Idle:\n        return Idle\n      case ScreenType.ItemsListing:\n        return ItemsListingScreen\n      case ScreenType.Inventory:\n        return InventoryScreen\n      }\n    }\n  },\n  methods: {\n    generateMap() {\n      this.game = new Onisun(\n        this.generatorOptions,\n      )\n    },\n    loop() {\n      this.game.turn()\n    },\n    onEvent(event) {\n      const screen = this.$refs.screenComponent\n      if (screen) {\n        screen.onEvent(event)\n      }\n    }\n  },\n  created() {\n    this.loopIntervalId = setInterval(this.loop, 10)\n    document.addEventListener('keydown', this.onEvent)\n  },\n  beforeDestroy() {\n    clearInterval(this.loopIntervalId)\n    document.removeEventListener('keydown', this.onEvent)\n  }\n})\n","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2e07df2d\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.game)?_c('div',{staticClass:\"container\",attrs:{\"id\":\"app\"}},[(_vm.game.player && !_vm.game.player.dead)?_c('Scene',{attrs:{\"level\":_vm.game.currentMap,\"player\":_vm.game.player}}):_vm._e(),_vm._v(\" \"),(_vm.game.player && _vm.game.player.dead)?_c('div',[_vm._v(\"You are dead\")]):_vm._e(),_vm._v(\" \"),(_vm.game.screen)?_c(_vm.screenComponent,{ref:\"screenComponent\",tag:\"component\",attrs:{\"screen\":_vm.game.screen}}):_vm._e(),_vm._v(\" \"),_c('Logger',{attrs:{\"logger\":_vm.game.logger}}),_vm._v(\" \"),_c('div',{},[_c('div',{},[_c('div',{staticClass:\"form-group row\"},[_c('div',{staticClass:\"col-sm-2\"},[_vm._v(\"\\n          Map\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"col-sm-10\"},[_c('div',{staticClass:\"form-check\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.addDoors),expression:\"generatorOptions.addDoors\"}],staticClass:\"form-check-input\",attrs:{\"id\":\"doors\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.generatorOptions.addDoors)?_vm._i(_vm.generatorOptions.addDoors,null)>-1:(_vm.generatorOptions.addDoors)},on:{\"change\":function($event){var $$a=_vm.generatorOptions.addDoors,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.generatorOptions, \"addDoors\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.generatorOptions, \"addDoors\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.generatorOptions, \"addDoors\", $$c)}}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"doors\"}},[_vm._v(\"\\n              Add doors\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.roomsCount),expression:\"generatorOptions.roomsCount\"}],staticClass:\"form-control\",attrs:{\"id\":\"roomsCount\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.roomsCount)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"roomsCount\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"roomsCount\"}},[_vm._v(\"\\n              roomsCount\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.minSize),expression:\"generatorOptions.minSize\"}],staticClass:\"form-control\",attrs:{\"id\":\"minSize\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.minSize)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"minSize\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"minSize\"}},[_vm._v(\"\\n              minSize\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.maxSize),expression:\"generatorOptions.maxSize\"}],staticClass:\"form-control\",attrs:{\"id\":\"maxSize\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.maxSize)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"maxSize\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"maxSize\"}},[_vm._v(\"\\n              maxSize\\n            \")])])])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group row\"},[_c('div',{staticClass:\"col-sm-10\"},[_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){_vm.generateMap()}}},[_vm._v(\"\\n            Rebuild!\\n          \")])])])])])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue'\nimport App from './App.vue'\nimport BootstrapVue from 'bootstrap-vue'\n\nVue.use(BootstrapVue)\n\nimport './application.scss'\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport 'bootstrap-vue/dist/bootstrap-vue.css'\n\nnew Vue({\n  el: '#app',\n  render: h => h(App)\n})\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=style&index=0&lang=scss\"","var map = {\n\t\"./af\": 141,\n\t\"./af.js\": 141,\n\t\"./ar\": 140,\n\t\"./ar-dz\": 139,\n\t\"./ar-dz.js\": 139,\n\t\"./ar-kw\": 138,\n\t\"./ar-kw.js\": 138,\n\t\"./ar-ly\": 137,\n\t\"./ar-ly.js\": 137,\n\t\"./ar-ma\": 136,\n\t\"./ar-ma.js\": 136,\n\t\"./ar-sa\": 135,\n\t\"./ar-sa.js\": 135,\n\t\"./ar-tn\": 134,\n\t\"./ar-tn.js\": 134,\n\t\"./ar.js\": 140,\n\t\"./az\": 133,\n\t\"./az.js\": 133,\n\t\"./be\": 132,\n\t\"./be.js\": 132,\n\t\"./bg\": 131,\n\t\"./bg.js\": 131,\n\t\"./bm\": 130,\n\t\"./bm.js\": 130,\n\t\"./bn\": 129,\n\t\"./bn.js\": 129,\n\t\"./bo\": 128,\n\t\"./bo.js\": 128,\n\t\"./br\": 127,\n\t\"./br.js\": 127,\n\t\"./bs\": 126,\n\t\"./bs.js\": 126,\n\t\"./ca\": 125,\n\t\"./ca.js\": 125,\n\t\"./cs\": 124,\n\t\"./cs.js\": 124,\n\t\"./cv\": 123,\n\t\"./cv.js\": 123,\n\t\"./cy\": 122,\n\t\"./cy.js\": 122,\n\t\"./da\": 121,\n\t\"./da.js\": 121,\n\t\"./de\": 120,\n\t\"./de-at\": 119,\n\t\"./de-at.js\": 119,\n\t\"./de-ch\": 118,\n\t\"./de-ch.js\": 118,\n\t\"./de.js\": 120,\n\t\"./dv\": 117,\n\t\"./dv.js\": 117,\n\t\"./el\": 116,\n\t\"./el.js\": 116,\n\t\"./en-au\": 115,\n\t\"./en-au.js\": 115,\n\t\"./en-ca\": 114,\n\t\"./en-ca.js\": 114,\n\t\"./en-gb\": 113,\n\t\"./en-gb.js\": 113,\n\t\"./en-ie\": 112,\n\t\"./en-ie.js\": 112,\n\t\"./en-il\": 111,\n\t\"./en-il.js\": 111,\n\t\"./en-nz\": 110,\n\t\"./en-nz.js\": 110,\n\t\"./eo\": 109,\n\t\"./eo.js\": 109,\n\t\"./es\": 108,\n\t\"./es-do\": 107,\n\t\"./es-do.js\": 107,\n\t\"./es-us\": 106,\n\t\"./es-us.js\": 106,\n\t\"./es.js\": 108,\n\t\"./et\": 105,\n\t\"./et.js\": 105,\n\t\"./eu\": 104,\n\t\"./eu.js\": 104,\n\t\"./fa\": 103,\n\t\"./fa.js\": 103,\n\t\"./fi\": 102,\n\t\"./fi.js\": 102,\n\t\"./fo\": 101,\n\t\"./fo.js\": 101,\n\t\"./fr\": 100,\n\t\"./fr-ca\": 99,\n\t\"./fr-ca.js\": 99,\n\t\"./fr-ch\": 98,\n\t\"./fr-ch.js\": 98,\n\t\"./fr.js\": 100,\n\t\"./fy\": 97,\n\t\"./fy.js\": 97,\n\t\"./gd\": 96,\n\t\"./gd.js\": 96,\n\t\"./gl\": 95,\n\t\"./gl.js\": 95,\n\t\"./gom-latn\": 94,\n\t\"./gom-latn.js\": 94,\n\t\"./gu\": 93,\n\t\"./gu.js\": 93,\n\t\"./he\": 92,\n\t\"./he.js\": 92,\n\t\"./hi\": 91,\n\t\"./hi.js\": 91,\n\t\"./hr\": 90,\n\t\"./hr.js\": 90,\n\t\"./hu\": 89,\n\t\"./hu.js\": 89,\n\t\"./hy-am\": 88,\n\t\"./hy-am.js\": 88,\n\t\"./id\": 87,\n\t\"./id.js\": 87,\n\t\"./is\": 86,\n\t\"./is.js\": 86,\n\t\"./it\": 85,\n\t\"./it.js\": 85,\n\t\"./ja\": 84,\n\t\"./ja.js\": 84,\n\t\"./jv\": 83,\n\t\"./jv.js\": 83,\n\t\"./ka\": 82,\n\t\"./ka.js\": 82,\n\t\"./kk\": 81,\n\t\"./kk.js\": 81,\n\t\"./km\": 80,\n\t\"./km.js\": 80,\n\t\"./kn\": 79,\n\t\"./kn.js\": 79,\n\t\"./ko\": 78,\n\t\"./ko.js\": 78,\n\t\"./ky\": 77,\n\t\"./ky.js\": 77,\n\t\"./lb\": 76,\n\t\"./lb.js\": 76,\n\t\"./lo\": 75,\n\t\"./lo.js\": 75,\n\t\"./lt\": 74,\n\t\"./lt.js\": 74,\n\t\"./lv\": 73,\n\t\"./lv.js\": 73,\n\t\"./me\": 72,\n\t\"./me.js\": 72,\n\t\"./mi\": 71,\n\t\"./mi.js\": 71,\n\t\"./mk\": 70,\n\t\"./mk.js\": 70,\n\t\"./ml\": 69,\n\t\"./ml.js\": 69,\n\t\"./mn\": 68,\n\t\"./mn.js\": 68,\n\t\"./mr\": 67,\n\t\"./mr.js\": 67,\n\t\"./ms\": 66,\n\t\"./ms-my\": 65,\n\t\"./ms-my.js\": 65,\n\t\"./ms.js\": 66,\n\t\"./mt\": 64,\n\t\"./mt.js\": 64,\n\t\"./my\": 63,\n\t\"./my.js\": 63,\n\t\"./nb\": 62,\n\t\"./nb.js\": 62,\n\t\"./ne\": 61,\n\t\"./ne.js\": 61,\n\t\"./nl\": 60,\n\t\"./nl-be\": 59,\n\t\"./nl-be.js\": 59,\n\t\"./nl.js\": 60,\n\t\"./nn\": 58,\n\t\"./nn.js\": 58,\n\t\"./pa-in\": 57,\n\t\"./pa-in.js\": 57,\n\t\"./pl\": 56,\n\t\"./pl.js\": 56,\n\t\"./pt\": 55,\n\t\"./pt-br\": 54,\n\t\"./pt-br.js\": 54,\n\t\"./pt.js\": 55,\n\t\"./ro\": 53,\n\t\"./ro.js\": 53,\n\t\"./ru\": 52,\n\t\"./ru.js\": 52,\n\t\"./sd\": 51,\n\t\"./sd.js\": 51,\n\t\"./se\": 50,\n\t\"./se.js\": 50,\n\t\"./si\": 49,\n\t\"./si.js\": 49,\n\t\"./sk\": 48,\n\t\"./sk.js\": 48,\n\t\"./sl\": 47,\n\t\"./sl.js\": 47,\n\t\"./sq\": 46,\n\t\"./sq.js\": 46,\n\t\"./sr\": 45,\n\t\"./sr-cyrl\": 44,\n\t\"./sr-cyrl.js\": 44,\n\t\"./sr.js\": 45,\n\t\"./ss\": 43,\n\t\"./ss.js\": 43,\n\t\"./sv\": 42,\n\t\"./sv.js\": 42,\n\t\"./sw\": 41,\n\t\"./sw.js\": 41,\n\t\"./ta\": 40,\n\t\"./ta.js\": 40,\n\t\"./te\": 39,\n\t\"./te.js\": 39,\n\t\"./tet\": 38,\n\t\"./tet.js\": 38,\n\t\"./tg\": 37,\n\t\"./tg.js\": 37,\n\t\"./th\": 36,\n\t\"./th.js\": 36,\n\t\"./tl-ph\": 35,\n\t\"./tl-ph.js\": 35,\n\t\"./tlh\": 34,\n\t\"./tlh.js\": 34,\n\t\"./tr\": 33,\n\t\"./tr.js\": 33,\n\t\"./tzl\": 32,\n\t\"./tzl.js\": 32,\n\t\"./tzm\": 31,\n\t\"./tzm-latn\": 30,\n\t\"./tzm-latn.js\": 30,\n\t\"./tzm.js\": 31,\n\t\"./ug-cn\": 29,\n\t\"./ug-cn.js\": 29,\n\t\"./uk\": 28,\n\t\"./uk.js\": 28,\n\t\"./ur\": 27,\n\t\"./ur.js\": 27,\n\t\"./uz\": 26,\n\t\"./uz-latn\": 25,\n\t\"./uz-latn.js\": 25,\n\t\"./uz.js\": 26,\n\t\"./vi\": 24,\n\t\"./vi.js\": 24,\n\t\"./x-pseudo\": 23,\n\t\"./x-pseudo.js\": 23,\n\t\"./yo\": 22,\n\t\"./yo.js\": 22,\n\t\"./zh-cn\": 21,\n\t\"./zh-cn.js\": 21,\n\t\"./zh-hk\": 20,\n\t\"./zh-hk.js\": 20,\n\t\"./zh-tw\": 19,\n\t\"./zh-tw.js\": 19\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 179;","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--0-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=style&index=0&lang=css\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--0-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=style&index=0&lang=css\""],"sourceRoot":""}