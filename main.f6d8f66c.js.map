{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./components/Cell.vue?7813","webpack:///./components/Cell.vue?334d","webpack:///./components/Cell.vue","webpack:///./components/Cell.vue?3316","webpack:///./src/engine/utils.ts","webpack:///./src/engine/fov.ts","webpack:///./src/engine/characteristics.ts","webpack:///./src/engine/items/internal.ts","webpack:///./src/engine/inventory.ts","webpack:///./src/engine/screens/internal.ts","webpack:///./src/engine/profession.ts","webpack:///./src/engine/creature.ts","webpack:///./src/engine/screens/talents_tree_screen.ts","webpack:///./src/engine/screens/profession_picking_screen.ts","webpack:///./src/engine/ai/internal.ts","webpack:///./src/engine/ai/attacker.ts","webpack:///./src/engine/ai/chaser.ts","webpack:///./src/engine/ai/meta_ai.ts","webpack:///./src/engine/ai/dispatcher.ts","webpack:///./src/engine/ai/escaper.ts","webpack:///./src/engine/ai/explorer.ts","webpack:///./src/engine/ai/loiter.ts","webpack:///./src/engine/ai/patrol.ts","webpack:///./src/engine/ai/player_ai.ts","webpack:///./src/engine/ai/picker.ts","webpack:///./src/engine/ai/selfhealer.ts","webpack:///./src/engine/ai/descender.ts","webpack:///./src/engine/effect.ts","webpack:///./src/engine/ai/thrower.ts","webpack:///./src/engine/tile.ts","webpack:///./src/engine/logger.ts","webpack:///./src/engine/timeline.ts","webpack:///./src/engine/map.ts","webpack:///./src/engine/level.ts","webpack:///./src/engine/memory.ts","webpack:///./src/engine/game.ts","webpack:///./src/engine/pool.ts","webpack:///./src/engine/generator/post.ts","webpack:///./src/engine/generator/drawn.ts","webpack:///./src/engine/generator/dungeon.ts","webpack:///./src/engine/screens/idle_screen.ts","webpack:///./src/engine/screens/inventory_screen.ts","webpack:///./src/engine/screens/missile_screen.ts","webpack:///./src/engine/controllers/internal.ts","webpack:///./src/engine/screens/items_listing.ts","webpack:///./components/Logger.vue?c1ad","webpack:///./components/Logger.vue?9375","webpack:///./components/Logger.vue","webpack:///./components/Logger.vue?e2af","webpack:///./components/stats.vue?fdb0","webpack:///./components/stats.vue?8458","webpack:///./src/engine/ai/waiter.ts","webpack:///./components/stats.vue","webpack:///./components/stats.vue?2da8","webpack:///./vendor/unicodetiles.ts/src/unicodetiles.ts","webpack:///./vendor/unicodetiles.ts/src/CanvasRenderer.ts","webpack:///./vendor/unicodetiles.ts/src/WebGLRenderer.ts","webpack:///./components/scene_tiles.ts","webpack:///./components/Scene.vue?a156","webpack:///./components/Scene.vue?4292","webpack:///./components/Scene.vue","webpack:///./components/Scene.vue?d5e0","webpack:///./components/screens/IdleScreen.vue?afe3","webpack:///./components/screens/IdleScreen.vue?432f","webpack:///./components/screens/IdleScreen.vue","webpack:///./components/screens/IdleScreen.vue?fd7a","webpack:///./components/screens/ProfessionPickingScreen.vue?ecdd","webpack:///./components/screens/ProfessionPickingScreen.vue?f603","webpack:///./components/screens/ProfessionPickingScreen.vue","webpack:///./components/screens/ProfessionPickingScreen.vue?75f2","webpack:///./components/screens/ItemsListingScreen.vue?f414","webpack:///./src/onisun/talents.ts","webpack:///./src/onisun/professions.ts","webpack:///./components/screens/ItemsListingScreen.vue?bb87","webpack:///./components/screens/ItemsListingScreen.vue","webpack:///./components/screens/ItemsListingScreen.vue?9f88","webpack:///./src/onisun.ts","webpack:///./src/onisun/potions.ts","webpack:///./components/screens/TalentsTreeScreen.vue?b3a5","webpack:///./components/screens/TalentsTreeScreen.vue?7f6a","webpack:///./components/screens/TalentsTreeScreen.vue","webpack:///./components/screens/TalentsTreeScreen.vue?41f5","webpack:///./components/screens/InventoryScreen.vue?a91d","webpack:///./components/screens/InventoryScreen.vue?29af","webpack:///./components/screens/InventoryScreen.vue","webpack:///./components/screens/InventoryScreen.vue?70d0","webpack:///./components/screens/MissileScreen.vue?cb9b","webpack:///./components/screens/MissileScreen.vue?5228","webpack:///./components/screens/MissileScreen.vue","webpack:///./components/screens/MissileScreen.vue?a439","webpack:///./components/App.vue?91d1","webpack:///./components/App.vue?b7e9","webpack:///./components/App.vue","webpack:///./components/App.vue?300a","webpack:///./components/index.ts","webpack:///./components/App.vue?7ea9","webpack:///./components/screens/InventoryScreen.vue?e463","webpack:///./components/screens/TalentsTreeScreen.vue?c9d5","webpack:///./components/screens/ItemsListingScreen.vue?d62f","webpack:///./components/screens/ProfessionPickingScreen.vue?936d","webpack:///./components/Scene.vue?c20d","webpack:///./components/Logger.vue?c164","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./components/Cell.vue?b975"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","components_Cellvue_type_script_lang_ts","vue_runtime_esm","extend","props","computed","[object Object]","this","player","cell","isWall","isDoor","display","Cell","componentNormalizer","_h","$createElement","_self","_c","_v","Rect","x","y","w","h","succ","String","fromCharCode","charCodeAt","rand","max","Math","floor","random","twoDimArray","width","height","field","Array","min","list","Point","point","abs","dxy","map","add","Mapped","on","forEach","column","tile","cycle","dx","pop","unshift","bresenham","p0","p1","x0","x1","y0","y1","steps","delta","round","bresenhamInclusion","Direction","super","up","down","left","right","upLeft","upRight","downLeft","downRight","Fov","startx","starty","radius","checkSolid","markVisible","doubleRadius","dy","castLight","row","start","end","xx","xy","yx","yy","newStart","blocked","distance","deltaY","deltaX","currentX","currentY","leftSlope","rightSlope","doubleDistance","characteristics_Attribute","current","modifiers","modifier","increase","decrease","lodash","val","PositiveAttribute","currentValue","AttributeSet","attack","defense","dexterity","health","speed","pairSet","Modifier","weight","Characteristics","with","char","mod","addModifier","removeModifier","victim","dex","pow","misses","missile","regenerationValue","specie","constantIncrease","Usage","ItemGroup","internal_Item","group","usages","id","getId","lastId","creature","characteristics","item","inventoryItemId","GroupedItem","count","groupsWith","internal_ItemsBunch","bunch","find","invItem","inventoryItem","inv","groupedItem","put","Corpse","Consumable","Potion","Missile","Throw","BodyArmor","WearsOnBody","OneHandWeapon","WeaponOneHand","RightHandSlot","useSingleItem","LeftHandSlot","BodySlot","MissileSlot","allInventorySlots","inventory_Inventory","parts","wearings","bag","inventorySlot","slot","wearing","matchingEquip","equipment","actor","onTakeOff","undefined","some","wearSlot","groupItem","putToBag","remove","onPutOn","ScreenType","TalentStatus","Clan","Ability","Screen","type","game","Profession","level","points","talents","depthCost","profession_ProfessionPicker","pool","maxLevel","maxTaken","professions","canUpdate","updatableProfession","canTakeNewProfession","newFromPool","profession","excludeProfessions","filter","excluding","concat","Talent","depth","rank","maxRank","description","talents_tree_screen_TalentsTreeScreen","AbilitiesPicking","options","talent","assign","status","professionId","talentId","levelUps","levelUp","screen","profession_picking_screen_ProfessionPickingScreen","Completed","Unavailable","Available","ProfessionPicking","professionPicker","available","title","pickedProfession","playerProfession","allAbilities","keys","Specie","clan","abilities","creature_Phantom","refToReal","ability","Event","AttackEvent","subject","currentLevel","logger","missMessage","Reaction","DODGE","damage","damageTo","creature_AddExperienceEvent","killMessage","die","DIE","hurtMessage","HURT","ThrowEvent","throwMisses","throwMissMessage","THROW_DODGE","throwDamageTo","throwKillMessage","throwHurtMessage","Player","NOTHING","creature_Creature","ai","stageMemories","inventory","pos","previousPos","copy","previousLevel","addCreature","visionMask","removeCreature","at","addItem","wears","cares","event","affect","levelId","stage","act","nextPoint","phantom","stageMemory","resetVisible","memory_Memory","isSolid","degree","see","calc","visibleThrough","dead","dest","move","FIRST_STEP","internal_AI","prevAI","destination","eq","path","leePath","nextTo","randomDestination","pointsToVisit","pointsToCheck","step","wavePoints","inRange","tangible","wrappers","dist","buildRoad","lastPoint","chain","dp","visit","tileVisited","visible","enemy","FreeForAll","PlayerOnlyEnemy","FollowTargetAI","foundNewTarget","goTo","onMove","onReach","onCantMove","moveTo","GoToTileAI","metaAI","matcher","attacker_Attacker","canAttack","firstTurn","victimInAccess","pickNewVictim","findCreature","enemies","real","condition","memory","chaser_Chaser","reset","victimId","victimSet","buildVictimPath","foundNewVictim","followTo","withinView","AIEvent","meta_ai_AIItemPickedEvent","items","whereToWear","AIPutOnItem","matches","usage","weightModifier","reduce","acc","withWeight","f","meta_ai_MetaAI","aiToRun","events","resetEvents","dispatcher_Dispatcher","firstCallPatrol","escaper","escaper_Escaper","explorer","explorer_Explorer","chaser","attacker","picker","picker_Picker","patrol","patrol_Patrol","loiter","loiter_Loiter","thrower","thrower_Thrower","descender","descender_Descender","regenerateEvery","regenerate","runEvents","feelsGood","setAi","seesItems","pickItem","explore","healthCritical","rest","maximum","trackMovement","addNode","selfhealer_SelfHealer","STEP_DISTANCE","escapesFrom","foundEnemies","buildPath","minDistance","seen","NEW_POINT_EVERY","graph","graphlib","lastNodeVisit","markNodeVisited","currentNodeID","nodes","moveToTarget","targetNodeID","pickUpNewTarget","shouldAddNode","setNode","setEdge","node","seenLastID","seenLastStep","neighbors","nodeID","buildNewPath","player_ai_PlayerAI","idle_screen_IdleScreen","desiredItemId","can","Inventory","findItem","pushEvent","atMax","kind","TileTypes","StairwayDown","canDescend","GoStairwayDown","go","Effect","onDone","ItemFlightEffect","frames","done","effect","patchMemory","Throwing","hasMissile","missiles","removeWearing","previousVictim","addEffect","inSlot","obstacles","target","tile_Tile","Floor","Wall","Door","StairwayUp","isFloor","retrieve","clone","repository","Stairway","currentMap","leave","adjacentMap","enter","enterPos","LogLevel","LogMessage","ts","message","logger_Logger","messages","debug","warning","addMessage","DEBUG","INFO","WARNING","DANGER","moment","timeline_Timeline","turns","element","parseInt","actors","map_LevelMap","creatures","timeline","addToMap","passibleThrough","actorId","next","Level","requires","currentExperience","doneLeveling","requiredExperience","exp","MemoryTile","baseTile","each","game_Game","running","turn","rebuildVision","pool_Pool","totalWeight","ceil","input","pick","totalPool","addDoors","addDoor","setTile","addItems","chance","itemsPool","centralize","minX","minY","maxX","maxY","addOnTile","match","onValid","iters","connectMaps","map1","map2","downTile","ux","uy","upTile","drawn","drawMap","charAt","THICKNESS","newRoomSpace","newCorridor","newWall","RAY_TURNS","DELTA_ANGLE","PI","dungeon_Room","rect","dungeon_Road","lined","hx","hy","horizontalLine","vx","vy","verticalLine","IdleInputKey","generator_dungeon","dimX","dimY","minSize","maxSize","roomsCount","dungeon","rooms","fill","_","generateRoom","normalize","ray","roads","buildRoads","pickedRooms","currentRoom","angle","cos","sin","roomToMove","ndx","ndy","every","room","notCross","pointWithin","connectedPoints","point1","point2","currentPoint","pointToConnect","currentDistance","inventory_screen_InventoryScreen","positions","availableItems","position","AITakeOffItem","items_listing_PutOnItemsScreen","Idle","Right","internal_AIMoveEvent","Left","Down","Up","UpRight","UpLeft","DownRight","DownLeft","Handle","internal_AIHandleEnvEvent","PickUp","internal_AIPickUpItemsDialog","internal_AIMissileDialog","Drop","items_listing_DropItemsScreen","Drink","items_listing_DrinkScreen","Bag","BagScreen","missile_screen_MissileScreen","targetEnemyIndex","findEnemies","resetTargetId","updateTarget","direction","targetPos","internal_AIMissileAttack","resetPath","newPos","drawPath","Controller","ranIntoAnObstacle","howToHandle","noItemsToPickUp","internal_AIPickUpItems","items_listing_PickUpScreen","tileItems","pickedUpItem","internal_AIDropItems","removeFromBag","droppedItem","takeOff","equip","putOn","AIDrinkItem","potion","onDrink","drink","items_listing_ItemsListingScreen","ItemsListing","initPositions","itemGroup","singleItemMode","components_Loggervue_type_script_lang_ts","methods","record","format","components_Logger","_vm","ref","staticClass","_l","class","rowClass","_s","components_statsvue_type_script_lang_ts","aiName","displayAttribute","attribute","mods","join","stats","displayAttributeWithModifiers","unicodetiles_Tile","ch","g","b","br","bg","bb","grey","toString","other","CSSCLASS","NULLTILE","VERTEX_SHADER","FRAGMENT_SHADER","webGLRenderer","viewport","view","canvas","document","createElement","getContext","gl","elem","appendChild","charMap","charArray","defaultColors","attribs","buffer","itemSize","location","hint","STATIC_DRAW","texCoord","color","DYNAMIC_DRAW","bgColor","charIndex","offscreen","style","top","ctx","updateStyle","squarify","th","tw","vertexShader","compileShader","fragmentShader","program","createProgram","attachShader","linkProgram","deleteShader","getProgramParameter","LINK_STATUS","msg","getProgramInfoLog","deleteProgram","useProgram","getAttribLocation","initBuffers","resolutionLocation","getUniformLocation","uniform2f","tileCountsLocation","paddingLocation","texture","createTexture","bindTexture","TEXTURE_2D","cacheChars","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","activeTexture","TEXTURE0","setTimeout","buildTexture","render","pad","charCount","sqrt","fillStyle","fillRect","halfGap","gap","fillText","texImage2D","RGBA","UNSIGNED_BYTE","chars","build","changed","getComputedStyle","font","fontSize","lineHeight","fontFamily","textBaseline","measureText","backgroundColor","clear","COLOR_BUFFER_BIT","tiles","newChars","defaultColor","defaultBackground","k","kk","bindBuffer","ARRAY_BUFFER","bufferData","attrib","drawArrays","TRIANGLES","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","a","Float32Array","insertQuad","deleteBuffer","createBuffer","enableVertexAttribArray","vertexAttribPointer","FLOAT","arr","x2","y2","DEFAULT_GREY","IMPORTANT_GREY","DEFAULT_LIT","scene_tiles_DisplayTile","setBackground","setColor","ImportantTile","CreatureTile","vr","vg","vb","ItemTile","WEAPON","CORPSE","BODY_ARMOR","MISSILE","POTION","displayItem","HUMAN","HUMAN2","HUMAN3","HUMAN4","HUMAN5","RAT","DOOR","litColor","swapColors","WALL","litBackground","backgroundToColor","FLOOR","STAIRWAY_DOWN","STAIRWAY_UP","Scenevue_type_script_lang_ts_NULLTILE","nextItemAnimation","components_Scenevue_type_script_lang_ts","wholeMap","term","eng","drawInterval","Date","now","fps","counter","interval","components","Stats","displayTile","creatureTile","frame","animationFps","itemId","renderer","cx","cy","innerHTML","className","indexOf","updateRenderer","getRendererString","str","len","unsafePut","$refs","scene","tileFunc","refreshCache","cacheEnabled","transitionDuration","cachex","cachey","tileCache","tileCache2","func","duration","transition","new_t","old_t","factor","halfw","halfh","transitionTimer","getTime","maskFunc","shaderFunc","timeNow","transTime","ixx","jyy","lookupx","lookupy","tempCache","getTile","setMaskFunc","setShaderFunc","time","lighting","clearInterval","setInterval","drawScene","update","lighted","fovTile","initViewport","watch","Scene","directives","rawName","expression","attrs","domProps","checked","isArray","_i","change","$event","$$a","$$el","$$c","$$i","screens_IdleScreenvue_type_script_lang_ts","inputKey","onInput","close","screens_IdleScreen","screens_ProfessionPickingScreenvue_type_script_lang_ts","picked","doubleClickOption","option","iconPath","screens_ProfessionPickingScreen","click","dblclick","src","variant","_e","OnisunTalentId","OnisunProfessionId","screens_ItemsListingScreenvue_type_script_lang_ts","page","perPage","selected","pickUpItems","index","selectAt","withItem","indexLetter","positionStatus","screens_ItemsListingScreen","positionSelected","talents_OnisunTalent","AttackerTwoHandedWeapons","professions_OnisunAttackerProfession","Attacker","professions_OnisunDefenderProfession","Defender","professions_OnisunProfessionPicker","defender","baseConfig","simple","weapons","newCreature","rat","orc","undead","robot","onisun_Onisun","generatorOptions","initPlayer","generateMap","playerSpecie","dagger","katana","rock","merge","screens_TalentsTreeScreenvue_type_script_lang_ts","professionIndex","groups","availableIndex","letter","groupedTalents","tip","AttackerHeavyWeapons","AttackerLightWeapons","AttackerTwoWeapons","AttackerDoubleTwoHandedWeapons","AttackerStrongGrip","screens_TalentsTreeScreen","card","model","callback","$$v","no-body","talentStatus","pickTalent","talentTip","triggers","container","screens_InventoryScreenvue_type_script_lang_ts","bodyPart","getChar","itemName","screens_InventoryScreen","availableStatus","displayBodyPart","itemWeight","screens_MissileScreenvue_type_script_lang_ts","moveTarget","nextTarget","previousTarget","screens_MissileScreen","components_Appvue_type_script_lang_ts","loopIntervalId","Logger","screenComponent","onEvent","main","loop","addEventListener","removeEventListener","App","tag","$set","for","composing","use","es","el","./af","./af.js","./ar","./ar-dz","./ar-dz.js","./ar-kw","./ar-kw.js","./ar-ly","./ar-ly.js","./ar-ma","./ar-ma.js","./ar-sa","./ar-sa.js","./ar-tn","./ar-tn.js","./ar.js","./az","./az.js","./be","./be.js","./bg","./bg.js","./bm","./bm.js","./bn","./bn.js","./bo","./bo.js","./br","./br.js","./bs","./bs.js","./ca","./ca.js","./cs","./cs.js","./cv","./cv.js","./cy","./cy.js","./da","./da.js","./de","./de-at","./de-at.js","./de-ch","./de-ch.js","./de.js","./dv","./dv.js","./el","./el.js","./en-au","./en-au.js","./en-ca","./en-ca.js","./en-gb","./en-gb.js","./en-ie","./en-ie.js","./en-il","./en-il.js","./en-nz","./en-nz.js","./eo","./eo.js","./es","./es-do","./es-do.js","./es-us","./es-us.js","./es.js","./et","./et.js","./eu","./eu.js","./fa","./fa.js","./fi","./fi.js","./fo","./fo.js","./fr","./fr-ca","./fr-ca.js","./fr-ch","./fr-ch.js","./fr.js","./fy","./fy.js","./gd","./gd.js","./gl","./gl.js","./gom-latn","./gom-latn.js","./gu","./gu.js","./he","./he.js","./hi","./hi.js","./hr","./hr.js","./hu","./hu.js","./hy-am","./hy-am.js","./id","./id.js","./is","./is.js","./it","./it.js","./ja","./ja.js","./jv","./jv.js","./ka","./ka.js","./kk","./kk.js","./km","./km.js","./kn","./kn.js","./ko","./ko.js","./ky","./ky.js","./lb","./lb.js","./lo","./lo.js","./lt","./lt.js","./lv","./lv.js","./me","./me.js","./mi","./mi.js","./mk","./mk.js","./ml","./ml.js","./mn","./mn.js","./mr","./mr.js","./ms","./ms-my","./ms-my.js","./ms.js","./mt","./mt.js","./my","./my.js","./nb","./nb.js","./ne","./ne.js","./nl","./nl-be","./nl-be.js","./nl.js","./nn","./nn.js","./pa-in","./pa-in.js","./pl","./pl.js","./pt","./pt-br","./pt-br.js","./pt.js","./ro","./ro.js","./ru","./ru.js","./sd","./sd.js","./se","./se.js","./si","./si.js","./sk","./sk.js","./sl","./sl.js","./sq","./sq.js","./sr","./sr-cyrl","./sr-cyrl.js","./sr.js","./ss","./ss.js","./sv","./sv.js","./sw","./sw.js","./ta","./ta.js","./te","./te.js","./tet","./tet.js","./tg","./tg.js","./th","./th.js","./tl-ph","./tl-ph.js","./tlh","./tlh.js","./tr","./tr.js","./tzl","./tzl.js","./tzm","./tzm-latn","./tzm-latn.js","./tzm.js","./ug-cn","./ug-cn.js","./uk","./uk.js","./ur","./ur.js","./uz","./uz-latn","./uz-latn.js","./uz.js","./vi","./vi.js","./x-pseudo","./x-pseudo.js","./yo","./yo.js","./zh-cn","./zh-cn.js","./zh-hk","./zh-hk.js","./zh-tw","./zh-tw.js","webpackContext","req","webpackContextResolve","e","Error","code","resolve"],"mappings":"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IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,aAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,IACAC,OAAA,IACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,IACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,YAAA,GACAC,eAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,QAAA,GACAC,WAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,QAAA,GACAC,WAAA,GACAC,OAAA,GACAC,UAAA,GACAC,QAAA,GACAC,WAAA,GACAC,QAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,WAAA,GACAC,UAAA,GACAC,aAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,OAAA,GACAC,YAAA,GACAC,eAAA,GACAC,UAAA,GACAC,OAAA,GACAC,UAAA,GACAC,aAAA,GACAC,gBAAA,GACAC,OAAA,GACAC,UAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,GACAC,UAAA,GACAC,aAAA,IAIA,SAAAC,EAAAC,GACA,IAAAroC,EAAAsoC,EAAAD,GACA,OAAApzC,EAAA+K,GAEA,SAAAsoC,EAAAD,GACA,IAAAroC,EAAAhG,EAAAquC,GACA,KAAAroC,EAAA,IACA,IAAAuoC,EAAA,IAAAC,MAAA,uBAAAH,EAAA,KAEA,MADAE,EAAAE,KAAA,mBACAF,EAEA,OAAAvoC,EAEAooC,EAAA5hC,KAAA,WACA,OAAAvS,OAAAuS,KAAAxM,IAEAouC,EAAAM,QAAAJ,EACAhzC,EAAAD,QAAA+yC,EACAA,EAAApoC,GAAA,yDC5QkS","file":"main.f6d8f66c.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/onisun/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([196,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nimport { Tile, TileTypes } from '../map'\n\nexport default Vue.extend({\n  props: [\"cell\", 'player'],\n  computed: {\n    style() {\n      if (this.player) {\n        return 'player'\n      } else if (this.cell.isWall()) {\n        return 'wall'\n      } else if (this.cell.isDoor()) {\n        return 'door'\n      }\n\n      return 'floor'\n    },\n    symbol():any {\n      if (this.player) {\n        return ''\n      } else if (this.cell.display == ' ') {\n        return ''\n      } else if (this.cell.display == '+') {\n        return ''\n      } else if (this.cell.display == '#') {\n        return ''\n      } else {\n        return 'E'\n      }\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./Cell.vue?vue&type=template&id=0a1e052e\"\nimport script from \"./Cell.vue?vue&type=script&lang=ts\"\nexport * from \"./Cell.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Cell.vue?vue&type=style&index=0&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_vm._v(\"\\n  :class=\\\"style\\\"\\n  v-text=\\\"symbol\\\"\\n  @click=\\\"$emit('setPosition')\\\"\\n\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class Rect {\n  // TODO: Validate?\n  constructor(\n    public x: number,\n    public y: number,\n    public w: number,\n    public h: number\n  ) {}\n\n  move(x: number, y: number): void {\n    this.x += x\n    this.y += y\n  }\n}\n\nexport const succ = function(c: string): string {\n  return String.fromCharCode(c.charCodeAt(0) + 1)\n}\n\nexport const rand = function(max: number): number {\n  return Math.floor(Math.random() * max)\n}\n\n/* tslint:disable no-any */\nexport const twoDimArray = function(\n  width: number,\n  height: number,\n  value: (x: number, y: number) => any\n): Array<Array<any>> {\n  let field = Array(width)\n\n  for (let i = 0; i < width; i++) {\n    field[i] = new Array(height)\n    for (let j = 0; j < height; j++) {\n      field[i][j] = value(i, j)\n    }\n  }\n\n  return field\n}\n\nexport const max = function(list: Array<number>): number {\n  return Math.max.apply(Math, list)\n}\n\nexport const min = function(list: Array<number>): number {\n  return Math.min.apply(Math, list)\n}\n\nexport class Point {\n  constructor(public x: number, public y: number) {}\n\n  public static readonly dxy = [\n    new Point(-1, -1),\n    new Point(0, -1),\n    new Point(1, -1),\n    new Point(-1, 0),\n    new Point(1, 0),\n    new Point(-1, 1),\n    new Point(0, 1),\n    new Point(1, 1),\n  ]\n\n  public eq(point: Point): boolean {\n    return this.x === point.x && this.y === point.y\n  }\n\n  public nextTo(point: Point): boolean {\n    return Math.abs(this.x - point.x) <= 1 && Math.abs(this.y - point.y) <= 1\n  }\n\n  public copy(): Point {\n    return new Point(this.x, this.y)\n  }\n\n  public add(point: Point): Point {\n    return new Point(this.x + point.x, this.y + point.y)\n  }\n\n  public wrappers(): Point[] {\n    return Point.dxy.map(point => this.add(point))\n  }\n}\n\nexport abstract class Mapped<T> {\n  public readonly width: number\n  public readonly height: number\n\n  constructor(public map: T[][]) {\n    this.width = map.length\n    this.height = map[0].length\n  }\n\n  public at(x, y): T {\n    return this.map[x][y]\n  }\n\n  public inRange(point: Point): boolean {\n    return (\n      point.x >= 0 &&\n      point.y >= 0 &&\n      point.x < this.width &&\n      point.y < this.height\n    )\n  }\n\n  public each(on: (tile: T, x: number, y: number) => any): void {\n    this.map.forEach((column, x) => {\n      column.forEach((tile, y) => {\n        on(tile, x, y)\n      })\n    })\n  }\n}\n\nexport const cycle = function(list: any[], dx: number): any[] {\n  let x\n  if (dx > 0) {\n    for (let i = 0; i < dx; i++) {\n      x = list.pop()\n      list.unshift(x)\n    }\n  } else if (dx < 0) {\n    for (let i = dx; i < 0; i++) {\n      x = list.shift()\n      list.push(x)\n    }\n  }\n\n  return list\n}\n\nexport const bresenham = function(\n  p0: Point,\n  p1: Point,\n  on: (x, y) => void\n): void {\n  let [x0, x1, y0, y1] = [p0.x, p1.x, p0.y, p1.y]\n  let steps = Math.max(Math.abs(x0 - x1), Math.abs(y0 - y1))\n  const delta = new Point((x1 - x0) / steps, (y1 - y0) / steps)\n\n  while (steps > 1) {\n    x0 += delta.x\n    y0 += delta.y\n\n    on(Math.round(x0), Math.round(y0))\n\n    steps -= 1\n  }\n}\n\nexport const bresenhamInclusion = function(\n  p0: Point,\n  p1: Point,\n  on: (x, y) => void\n): void {\n  bresenham(p0, p1, on)\n  on(p1.x, p1.y)\n}\n\nexport class Direction extends Point {\n  private constructor(x, y) {\n    super(x, y)\n  }\n\n  static readonly up = new Direction(0, -1)\n  static readonly down = new Direction(0, 1)\n  static readonly left = new Direction(-1, 0)\n  static readonly right = new Direction(1, 0)\n\n  static readonly upLeft = new Direction(-1, -1)\n  static readonly upRight = new Direction(1, -1)\n  static readonly downLeft = new Direction(-1, 1)\n  static readonly downRight = new Direction(1, 1)\n}\n","export class Fov {\n  private doubleRadius: number\n\n  constructor(\n    private startx: number,\n    private starty: number,\n    private radius: number,\n    private width: number,\n    private height: number,\n    private checkSolid: (x: number, y: number) => boolean,\n    private markVisible: (x: number, y: number, degree: number) => void\n  ) {\n    this.doubleRadius = this.radius * this.radius\n  }\n\n  public calc(): void {\n    this.markVisible(this.startx, this.starty, 1)\n\n    if (!this.checkSolid(this.startx, this.starty)) {\n      ;[[1, 1], [1, -1], [-1, 1], [-1, -1]].forEach(([dx, dy]) => {\n        this.castLight(1, 1.0, 0.0, 0, dx, dy, 0)\n        this.castLight(1, 1.0, 0.0, dx, 0, 0, dy)\n      })\n    }\n  }\n\n  private castLight(\n    row: number,\n    start: number,\n    end: number,\n    xx: number,\n    xy: number,\n    yx: number,\n    yy: number\n  ) {\n    if (start < end) {\n      return\n    }\n\n    let newStart = 0.0\n    let blocked = false\n\n    for (let distance = row; distance <= this.radius && !blocked; distance++) {\n      let deltaY = -distance\n\n      for (let deltaX: number = -distance; deltaX <= 0; deltaX++) {\n        let currentX = Math.round(this.startx + deltaX * xx + deltaY * xy)\n        let currentY = Math.round(this.starty + deltaX * yx + deltaY * yy)\n        let leftSlope = (deltaX - 0.5) / (deltaY + 0.5)\n        let rightSlope = (deltaX + 0.5) / (deltaY - 0.5)\n\n        if (\n          !(\n            currentX >= 0 &&\n            currentY >= 0 &&\n            currentX < this.width &&\n            currentY < this.height\n          ) ||\n          start < rightSlope\n        ) {\n          continue\n        } else if (end > leftSlope) {\n          break\n        }\n\n        // check if it's within the lightable area and light if needed\n        if (this.doubleDistance(deltaX, deltaY) <= this.doubleRadius) {\n          this.markVisible(\n            currentX,\n            currentY,\n            1 - this.doubleDistance(deltaX, deltaY) / this.doubleRadius\n          )\n        }\n\n        if (blocked) {\n          // previous cell was a blocking one\n          if (this.checkSolid(currentX, currentY)) {\n            // hit a wall\n            newStart = rightSlope\n          } else {\n            blocked = false\n            start = newStart\n          }\n        } else {\n          if (this.checkSolid(currentX, currentY) && distance < this.radius) {\n            // hit a wall within sight line\n            blocked = true\n            this.castLight(distance + 1, start, leftSlope, xx, xy, yx, yy)\n            newStart = rightSlope\n          }\n        }\n      }\n    }\n  }\n\n  private doubleDistance(x: number, y: number): number {\n    return x * x + y * y\n  }\n}\n","import { remove, sum } from 'lodash'\nimport { Specie } from './creature'\nimport { Item } from './items'\n\nexport class Attribute {\n  public modifiers: number[] = []\n\n  constructor(protected max: number, protected current: number = max) {}\n\n  public maximum(): number {\n    return this.max\n  }\n\n  public atMax(): boolean {\n    return this.max === this.current\n  }\n\n  public decrease(modifier: number) {\n    this.current -= modifier\n  }\n\n  public increase(modifier: number) {\n    this.current = Math.min(this.current + modifier, this.max)\n  }\n\n  public constantIncrease(modifier: number) {\n    this.max += modifier\n    this.increase(modifier)\n  }\n\n  public constantDecrease(modifier: number) {\n    this.max -= modifier\n    this.decrease(modifier)\n  }\n\n  public addModifier(modifier: number) {\n    this.modifiers.push(modifier)\n  }\n\n  public removeModifier(modifier: number) {\n    remove(this.modifiers, val => val === modifier)\n  }\n\n  public currentValue(): number {\n    return this.current + sum(this.modifiers)\n  }\n}\n\nexport class PositiveAttribute extends Attribute {\n  public currentValue(): number {\n    const value = super.currentValue()\n    return value >= 1 ? value : 1\n  }\n\n  public constantDecrease(modifier: number) {\n    this.max = Math.max(1, this.max - modifier)\n    this.decrease(modifier)\n  }\n\n  public decrease(modifier: number) {\n    this.current = Math.max(1, this.current - modifier)\n  }\n}\n\nexport class AttributeSet<T> {\n  constructor(\n    public attack: T,\n    public defense: T,\n    public dexterity: T,\n    public health: T,\n    public radius: T,\n    public speed: T\n  ) {}\n\n  public with(pairSet: AttributeSet<any>, on: (first: T, second: any) => void) {\n    on(this.attack, pairSet.attack)\n    on(this.defense, pairSet.defense)\n    on(this.health, pairSet.health)\n    on(this.radius, pairSet.radius)\n    on(this.speed, pairSet.speed)\n  }\n}\n\nexport class Modifier extends AttributeSet<number> {\n  constructor({\n    attack = 0,\n    defense = 0,\n    dexterity = 0,\n    health = 0,\n    radius = 0,\n    speed = 0,\n  }) {\n    super(attack, defense, dexterity, health, radius, speed)\n  }\n\n  public withWeight(\n    pairSet: Modifier,\n    weight: Modifier,\n    on: (first: number, second: number, weight: number) => void\n  ) {\n    on(this.attack, pairSet.attack, weight.attack)\n    on(this.defense, pairSet.defense, weight.defense)\n    on(this.health, pairSet.health, weight.health)\n    on(this.radius, pairSet.radius, weight.radius)\n    on(this.speed, pairSet.speed, weight.speed)\n  }\n}\n\nexport class Characteristics extends AttributeSet<Attribute> {\n  constructor({ attack, defense, dexterity, health, radius, speed }) {\n    super(\n      new PositiveAttribute(attack),\n      new PositiveAttribute(defense),\n      new PositiveAttribute(dexterity),\n      new Attribute(health),\n      new PositiveAttribute(radius),\n      new PositiveAttribute(speed)\n    )\n  }\n\n  public addModifier(modifier: Modifier) {\n    this.with(modifier, (char, mod) => {\n      if (mod !== 0) {\n        char.addModifier(mod)\n      }\n    })\n  }\n\n  public removeModifier(modifier: Modifier) {\n    this.with(modifier, (char, mod) => {\n      if (mod !== 0) {\n        char.removeModifier(mod)\n      }\n    })\n  }\n\n  public damageTo(victim: Characteristics): number {\n    return Math.round(\n      (10 * this.attack.currentValue()) / victim.defense.currentValue()\n    )\n  }\n\n  public misses(victim: Characteristics): boolean {\n    let dex = this.dexterity.currentValue()\n\n    return (\n      Math.random() >\n      dex / (dex + Math.pow(victim.dexterity.currentValue() * 0.25, 0.8))\n    )\n  }\n\n  public throwMisses(victim: Characteristics): boolean {\n    return this.misses(victim)\n  }\n\n  public throwDamageTo(victim: Characteristics, missile: Item): number {\n    return 10\n  }\n\n  public regenerate(): void {\n    this.health.increase(this.regenerationValue())\n  }\n\n  protected regenerationValue(): number {\n    return 1\n  }\n\n  public regenerateEvery(): number {\n    return 8\n  }\n\n  public levelUp(specie: Specie) {\n    this.health.constantIncrease(3)\n\n    if (Math.random() > 0.5) {\n      this.attack.constantIncrease(1)\n    } else {\n      this.defense.constantIncrease(1)\n    }\n  }\n}\n","import { Specie, Creature } from '../creature'\nimport { Modifier } from '../characteristics'\n\nimport { remove } from 'lodash'\nimport { Game } from '../game'\n\nexport enum Usage {\n  WeaponOneHand,\n  WearsOnBody,\n  Throw,\n}\n\nexport enum ItemGroup {\n  BodyArmor,\n  OneHandWeapon,\n  Consumable,\n  Missile,\n  Potion,\n}\n\nexport type ItemId = number\n\nexport class Item {\n  private static lastId: ItemId = 0\n  public static getId(): ItemId {\n    return this.lastId++\n  }\n  public weight: number = 100\n\n  constructor(\n    public group: ItemGroup,\n    public name: string,\n    public readonly usages: Usage[] = [],\n    public readonly modifier: Modifier = new Modifier({}),\n    public id: ItemId = Item.getId()\n  ) {}\n\n  public clone(): Item {\n    return new Item(this.group, this.name)\n  }\n\n  public onPutOn(creature: Creature): void {\n    creature.characteristics.addModifier(this.modifier)\n  }\n\n  public onTakeOff(creature: Creature): void {\n    creature.characteristics.removeModifier(this.modifier)\n  }\n\n  public groupsWith(item: Item): boolean {\n    return this.name === item.name\n  }\n}\n\nlet inventoryItemId = 1\nexport class GroupedItem {\n  public id: number\n\n  constructor(public count: number, public item: Item) {\n    this.id = inventoryItemId++\n  }\n\n  public groupsWith(item: Item): boolean {\n    return this.item.groupsWith(item)\n  }\n}\n\nexport class ItemsBunch {\n  public bunch: GroupedItem[] = []\n\n  public find(item: Item): GroupedItem {\n    return this.bunch.find(invItem => invItem.groupsWith(item))\n  }\n\n  public remove(item: Item, count: number): void {\n    const invItem: GroupedItem = this.find(item)\n\n    if (!invItem) {\n      // TODO: Fail if removes item that's not in bunch yet?\n      return\n    } else if (invItem.count === count) {\n      remove(this.bunch, inventoryItem => inventoryItem.id === invItem.id)\n    } else {\n      invItem.count -= count\n    }\n  }\n\n  public put(item: Item, count: number): void {\n    const invItem = this.bunch.find(inv => inv.groupsWith(item))\n\n    if (invItem) {\n      invItem.count += count\n    } else {\n      this.bunch.push(new GroupedItem(count, item))\n    }\n  }\n\n  public clone(): ItemsBunch {\n    let bunch = new ItemsBunch()\n\n    this.bunch.forEach(groupedItem => {\n      bunch.put(groupedItem.item, groupedItem.count)\n    })\n\n    return bunch\n  }\n}\n\nexport class Corpse extends Item {\n  constructor(public readonly specie: Specie) {\n    super(ItemGroup.Consumable, `${specie.name}'s corpse`)\n  }\n}\n\nexport abstract class Potion extends Item {\n  constructor(public name: string) {\n    super(ItemGroup.Potion, name)\n  }\n\n  abstract onDrink(game: Game): void\n}\n\nexport class Missile extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.Missile, name, [Usage.Throw], modifier)\n  }\n}\n\nexport class BodyArmor extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.BodyArmor, name, [Usage.WearsOnBody], modifier)\n  }\n}\n\nexport class OneHandWeapon extends Item {\n  constructor(name: string, modifier: Modifier) {\n    super(ItemGroup.OneHandWeapon, name, [Usage.WeaponOneHand], modifier)\n  }\n}\n","import { Item, GroupedItem, ItemsBunch } from './items'\n\nimport { Usage } from './items/internal'\n\nimport { intersection } from 'lodash'\nimport { Creature } from './creature'\n\nexport interface InventorySlot {\n  id: number // TODO: OMG do something with it\n  // What kind of items can be put in slot\n  usages: Usage[]\n  // Has to put only a single item or can put a bunch of them\n  useSingleItem: boolean\n}\n\nexport const RightHandSlot: InventorySlot = {\n  id: 1,\n  usages: [Usage.WeaponOneHand],\n  useSingleItem: true,\n}\nexport const LeftHandSlot: InventorySlot = {\n  id: 2,\n  usages: [Usage.WeaponOneHand],\n  useSingleItem: true,\n}\nexport const BodySlot: InventorySlot = {\n  id: 3,\n  usages: [Usage.WearsOnBody],\n  useSingleItem: true,\n}\nexport const MissileSlot: InventorySlot = {\n  id: 4,\n  usages: [Usage.Throw],\n  useSingleItem: false,\n}\n\nexport const allInventorySlots = [\n  RightHandSlot,\n  LeftHandSlot,\n  BodySlot,\n  MissileSlot,\n]\n// LeftHand,\n// Legs,\n// Finger,\n// Head,\n// Eye,\n// Neck,\n// Back,\n\n// MissileWeapon,\n\nexport type Wearing = {\n  inventorySlot: InventorySlot\n  equipment?: GroupedItem\n}\n\nexport class Inventory {\n  private wearings: Wearing[] = []\n  private bag: ItemsBunch = new ItemsBunch()\n\n  constructor(parts: InventorySlot[]) {\n    this.wearings = parts.map(inventorySlot => {\n      return { inventorySlot: inventorySlot }\n    })\n  }\n\n  public inSlot(slot: InventorySlot): GroupedItem {\n    const wearing = this.matchingEquip(slot)\n    return wearing && wearing.equipment\n  }\n\n  public removeWearing(\n    actor: Creature,\n    slot: InventorySlot,\n    count: number\n  ): void {\n    let wearing = this.matchingEquip(slot)\n\n    if (wearing && wearing.equipment) {\n      if (wearing.equipment.count === count) {\n        wearing.equipment.item.onTakeOff(actor)\n        wearing.equipment = undefined\n      } else {\n        wearing.equipment.count -= count\n      }\n    } else {\n      // TODO: fail here\n    }\n  }\n\n  public wears(): Wearing[] {\n    return this.wearings\n  }\n\n  public cares(): GroupedItem[] {\n    return this.bag.bunch\n  }\n\n  public canWear(item: Item) {\n    return this.wearings.some(wearing =>\n      intersection(item.usages, wearing.inventorySlot.usages).length > 0\n    )\n  }\n\n  public matchingEquip(slot: InventorySlot): Wearing {\n    return this.wearings.find(wearSlot => wearSlot.inventorySlot.id === slot.id)\n  }\n\n  public equip(actor: Creature, slot: InventorySlot, item: Item) {\n    let wearing = this.matchingEquip(slot),\n      groupItem = this.bag.find(item)\n\n    if (wearing && groupItem) {\n      if (wearing.equipment) {\n        this.putToBag(wearing.equipment.item, wearing.equipment.count)\n        wearing.equipment.item.onTakeOff(actor)\n      }\n\n      // TODO: Check that can't equip more than have in inventory\n\n      const count = slot.useSingleItem ? 1 : groupItem.count\n      wearing.equipment = new GroupedItem(count, item)\n\n      this.bag.remove(item, count)\n      item.onPutOn(actor)\n    } else {\n      // TODO: fail here\n    }\n  }\n\n  public takeOff(actor: Creature, slot: InventorySlot): void {\n    const wearing = this.wearings.find(\n      wearing => wearing.inventorySlot === slot\n    )\n\n    if (wearing && wearing.equipment) {\n      this.putToBag(wearing.equipment.item, wearing.equipment.count)\n      wearing.equipment.item.onTakeOff(actor)\n      wearing.equipment = null\n    }\n\n    // TODO: Fail if nothing to remove?\n  }\n\n  public putToBag(item: Item, count: number): void {\n    this.bag.put(item, count)\n  }\n\n  public removeFromBag(item: Item, count: number): void {\n    this.bag.remove(item, count)\n  }\n}\n","import { Game } from '../game'\nimport { Player } from '../creature'\n\nexport enum ScreenType {\n  ProfessionPicking,\n  Idle,\n  AbilitiesPicking,\n  Inventory,\n  ItemsListing,\n  Missile,\n}\n\nexport abstract class Screen {\n  public player: Player\n\n  constructor(public readonly type: ScreenType, protected game: Game) {\n    this.player = this.game.player\n  }\n\n  public build() {}\n}\n","import { Player } from './creature'\n\nimport { includes, sample, compact } from 'lodash'\nimport { Game } from './game'\n\nexport class Profession {\n  public talents: Talent[] = []\n  public readonly depthCost: number = 3\n\n  constructor(\n    public readonly id: number,\n    public readonly name: string,\n    public level: number = 1,\n    public points: number = 0\n  ) {}\n}\n\nexport class ProfessionPicker {\n  constructor(\n    private pool: Profession[],\n    private maxLevel: number,\n    private maxTaken: number\n  ) {}\n\n  public available(player: Player): Profession[] {\n    let professions: Profession[] = []\n\n    if (this.canUpdate(player)) {\n      professions.push(this.updatableProfession(player))\n    } else if (this.canTakeNewProfession(player)) {\n      professions.push(this.newFromPool(player))\n    }\n\n    if (this.canTakeNewProfession(player)) {\n      professions.push(\n        this.newFromPool(player, professions.map(profession => profession.id))\n      )\n    } else if (this.canUpdate(player)) {\n      professions.push(\n        this.updatableProfession(\n          player,\n          professions.map(profession => profession.id)\n        )\n      )\n    }\n\n    return compact(professions)\n  }\n\n  protected canUpdate(player: Player): boolean {\n    return player.professions.some(\n      profession => profession.level < this.maxLevel\n    )\n  }\n\n  protected updatableProfession(\n    player: Player,\n    excludeProfessions: number[] = []\n  ): Profession {\n    return sample(\n      player.professions.filter(\n        profession => !includes(excludeProfessions, profession.id)\n      )\n    )\n  }\n\n  protected canTakeNewProfession(player: Player): boolean {\n    return (\n      player.professions.length < this.maxTaken &&\n      this.pool.length > player.professions.length\n    )\n  }\n\n  protected newFromPool(\n    player: Player,\n    excludeProfessions: number[] = []\n  ): Profession {\n    const excluding = excludeProfessions.concat(\n      player.professions.map(profession => profession.id)\n    )\n    return sample(\n      this.pool.filter(profession => !includes(excluding, profession.id))\n    )\n  }\n}\n\nexport enum TalentStatus {\n  Available,\n  Completed,\n  Unavailable,\n}\n\nexport abstract class Talent {\n  constructor(\n    public readonly id: number,\n    public readonly name: string,\n    public readonly depth: number,\n    public rank: number,\n    public readonly maxRank: number,\n    public readonly description: string\n  ) {}\n\n  public abstract onObtain(game: Game): void\n}\n","import { Point } from './utils'\nimport { MetaAI } from './ai'\nimport { Fov } from './fov'\n\nimport {\n  Characteristics,\n  Corpse,\n  LevelMap,\n  LevelMapId,\n  Memory,\n} from '../engine'\nimport {\n  Inventory,\n  MissileSlot,\n  BodySlot,\n  RightHandSlot,\n  LeftHandSlot,\n} from './inventory'\n\nimport { Level } from './level'\nimport { includes } from 'lodash'\nimport { Item } from './items'\nimport { Profession } from './profession'\nimport { ProfessionPickingScreen } from './screens/profession_picking_screen'\nimport { TalentsTreeScreen } from './screens/talents_tree_screen'\n\nexport enum Clan {\n  Player,\n  PlayerOnlyEnemy,\n  FreeForAll,\n}\n\nexport enum Ability {\n  GoStairwayDown,\n  Inventory,\n  PutOn,\n  Throwing,\n}\n\nexport const allAbilities = Object.keys(Ability).map(key => Ability[key])\n\nexport class Specie {\n  constructor(\n    public readonly name: string,\n    public readonly clan: Clan,\n    public readonly abilities: Ability[]\n  ) {}\n}\n\nexport type CreatureId = number\n\nexport class Phantom {\n  private static lastId: CreatureId = 0\n  public static getId(): CreatureId {\n    return this.lastId++\n  }\n\n  public refToReal?: Creature\n\n  constructor(public specie: Specie, public id: CreatureId = Phantom.getId()) {}\n\n  public name(): string {\n    return this.specie.name\n  }\n\n  public clan(): Clan {\n    return this.specie.clan\n  }\n\n  public clone(): Phantom {\n    return new Phantom(this.specie, this.id)\n  }\n\n  public real(): Creature {\n    return this.refToReal\n  }\n\n  public can(ability: Ability) {\n    return includes(this.specie.abilities, ability)\n  }\n}\n\nexport abstract class Event {\n  public abstract affect(subject: Creature): Reaction\n}\n\nexport class AttackEvent extends Event {\n  constructor(public actor: Creature) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (this.actor.characteristics.misses(subject.characteristics)) {\n      subject.currentLevel.game.logger.missMessage(this.actor, subject)\n      return Reaction.DODGE\n    }\n\n    const damage = this.actor.characteristics.damageTo(subject.characteristics)\n\n    if (damage >= subject.characteristics.health.currentValue()) {\n      this.actor.on(new AddExperienceEvent(subject))\n      subject.currentLevel.game.logger.killMessage(damage, this.actor, subject)\n      subject.die()\n      return Reaction.DIE\n    } else {\n      subject.characteristics.health.decrease(damage)\n      subject.currentLevel.game.logger.hurtMessage(damage, this.actor, subject)\n      return Reaction.HURT\n    }\n  }\n}\n\nexport class ThrowEvent extends Event {\n  constructor(public actor: Creature, public missile: Item) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (this.actor.characteristics.throwMisses(subject.characteristics)) {\n      subject.currentLevel.game.logger.throwMissMessage(\n        this.actor,\n        subject,\n        this.missile\n      )\n      return Reaction.THROW_DODGE\n    }\n\n    const damage = this.actor.characteristics.throwDamageTo(\n      subject.characteristics,\n      this.missile\n    )\n\n    if (damage >= subject.characteristics.health.currentValue()) {\n      this.actor.on(new AddExperienceEvent(subject))\n      subject.currentLevel.game.logger.throwKillMessage(\n        damage,\n        this.actor,\n        subject,\n        this.missile\n      )\n      subject.die()\n      return Reaction.DIE\n    } else {\n      subject.characteristics.health.decrease(damage)\n      subject.currentLevel.game.logger.throwHurtMessage(\n        damage,\n        this.actor,\n        subject,\n        this.missile\n      )\n      return Reaction.HURT\n    }\n  }\n}\n\nexport class AddExperienceEvent extends Event {\n  constructor(public actor: Creature) {\n    super()\n  }\n\n  public affect(subject: Creature): Reaction {\n    if (subject instanceof Player) {\n      const game = subject.currentLevel.game\n\n      subject.levelUps += subject.level.add(1)\n\n      if (subject.levelUps > 0) {\n        game.screen =\n          (subject.level.current - subject.levelUps + 1) % 3 === 0\n            ? new ProfessionPickingScreen(game)\n            : new TalentsTreeScreen(game)\n      }\n    }\n\n    return Reaction.NOTHING\n  }\n}\n\nexport enum Reaction {\n  DIE,\n  HURT,\n  DODGE,\n  THROW_DODGE,\n  NOTHING,\n}\n\nexport class Creature extends Phantom {\n  public ai: MetaAI\n  public stageMemories: { [key: string]: Memory } = {}\n  public currentLevel: LevelMap\n  public inventory: Inventory\n\n  public previousPos: Point\n  public previousLevel: LevelMap\n  public pos: Point\n\n  constructor(\n    public characteristics: Characteristics,\n    ai: MetaAI,\n    specie: Specie\n  ) {\n    super(specie)\n    this.ai = ai\n\n    this.inventory = new Inventory([\n      RightHandSlot,\n      LeftHandSlot,\n      BodySlot,\n      MissileSlot,\n    ])\n  }\n\n  public addToMap(pos: Point, level: LevelMap) {\n    this.pos = pos\n    this.previousPos = this.pos.copy()\n    this.previousLevel = this.currentLevel\n    this.currentLevel = level\n    level.addCreature(this)\n    this.visionMask(level)\n  }\n\n  public die(): void {\n    this.currentLevel.removeCreature(this)\n\n    let tile = this.currentLevel.at(this.pos.x, this.pos.y)\n    tile.addItem(new Corpse(this.specie), 1)\n\n    this.inventory.wears().forEach(({ equipment }) => {\n      if (equipment) {\n        tile.addItem(equipment.item, equipment.count)\n      }\n    })\n\n    this.inventory.cares().forEach(invItem => {\n      tile.addItem(invItem.item, invItem.count)\n    })\n  }\n\n  public on(event: Event): Reaction {\n    return event.affect(this)\n  }\n\n  public real(): Creature {\n    return this\n  }\n\n  public speed(): number {\n    return this.characteristics.speed.currentValue()\n  }\n\n  public radius(): number {\n    return this.characteristics.radius.currentValue()\n  }\n\n  public stageMemory(levelId: LevelMapId = this.currentLevel.id): Memory {\n    return this.stageMemories[levelId]\n  }\n\n  public act(stage: LevelMap) {\n    this.visionMask(stage)\n    this.previousPos = this.pos.copy()\n    this.ai.act(this, true)\n\n    let previousPosLevel = this.previousLevel || this.currentLevel\n    previousPosLevel.at(\n      this.previousPos.x,\n      this.previousPos.y\n    ).creature = undefined\n    this.currentLevel.at(this.pos.x, this.pos.y).creature = this\n\n    this.previousLevel = undefined\n  }\n\n  public move(nextPoint: Point) {\n    this.pos = nextPoint.copy()\n  }\n\n  public clone(): Phantom {\n    let phantom = new Phantom(this.specie, this.id)\n    phantom.refToReal = this\n    return phantom\n  }\n\n  public visionMask(stage: LevelMap): void {\n    if (!this.stageMemories[stage.id]) {\n      this.stageMemories[stage.id] = new Memory(stage.width, stage.height)\n    } else {\n      this.stageMemory().resetVisible()\n    }\n\n    const see = (x: number, y: number, degree: number): void => {\n      this.stageMemory()\n        .at(x, y)\n        .see(stage.at(x, y), degree)\n    }\n\n    new Fov(\n      this.pos.x,\n      this.pos.y,\n      this.radius(),\n      stage.width,\n      stage.height,\n      this.isSolid(stage),\n      see\n    ).calc()\n  }\n\n  private isSolid(stage: LevelMap): (x: number, y: number) => boolean {\n    return (x: number, y: number) => {\n      if (stage.visibleThrough(x, y)) {\n        return false\n      } else {\n        return !(\n          stage.at(x, y).isDoor() &&\n          this.pos.x === x &&\n          this.pos.y === y\n        )\n      }\n    }\n  }\n}\n\nexport class Player extends Creature {\n  public dead: boolean = false\n\n  public levelUps: number = 0\n  public professions: Profession[] = []\n\n  constructor(\n    public level: Level,\n    characteristics: Characteristics,\n    ai: MetaAI,\n    specie: Specie\n  ) {\n    super(characteristics, ai, specie)\n  }\n\n  public act(stage: LevelMap): void {\n    super.act(stage)\n    // TODO: Simplify this? No need to move here\n  }\n\n  public move(dest: Point) {\n    super.move(dest)\n\n    let previousPosLevel = this.previousLevel || this.currentLevel\n    previousPosLevel.at(\n      this.previousPos.x,\n      this.previousPos.y\n    ).creature = undefined\n    this.currentLevel.at(this.pos.x, this.pos.y).creature = this\n\n    this.previousLevel = undefined\n  }\n\n  public die(): void {\n    super.die() // We do not want player to act after they death\n    this.dead = true\n  }\n\n  public rebuildVision(): void {\n    this.visionMask(this.currentLevel)\n  }\n}\n","import { Screen, ScreenType } from './internal'\nimport { Game, ProfessionPickingScreen } from '../../engine'\nimport { Profession, Talent, TalentStatus } from '../profession'\n\ninterface TalentWithStatus extends Talent {\n  status: TalentStatus\n}\n\ninterface TalentsTreeScreenProfession {\n  profession: Profession\n  talents: TalentWithStatus[]\n}\n\nexport class TalentsTreeScreen extends Screen {\n  public options: TalentsTreeScreenProfession[] = []\n\n  constructor(game: Game) {\n    super(ScreenType.AbilitiesPicking, game)\n\n    this.options = this.player.professions.map(profession => {\n      return {\n        profession,\n        talents: profession.talents.map(talent => {\n          return Object.assign({}, talent, {\n            status: this.status(talent, profession),\n          })\n        }),\n      }\n    })\n  }\n\n  public onInput(professionId: number, talentId: number) {\n    const profession = this.player.professions.find(\n      profession => profession.id === professionId\n    )\n    profession.talents.find(talent => talent.id === talentId).rank += 1\n    profession.points += 1\n\n    this.player.levelUps -= 1\n    this.player.characteristics.levelUp(this.player.specie)\n\n    if (this.player.levelUps > 0) {\n      this.game.screen =\n        (this.player.level.current - this.player.levelUps + 1) % 3 === 0\n          ? new ProfessionPickingScreen(this.game)\n          : new TalentsTreeScreen(this.game)\n    } else {\n      this.game.screen = undefined\n    }\n  }\n\n  private status(talent: Talent, profession: Profession): TalentStatus {\n    if (talent.rank === talent.maxRank) {\n      return TalentStatus.Completed\n    } else if (talent.depth * profession.depthCost > profession.points) {\n      return TalentStatus.Unavailable\n    } else {\n      return TalentStatus.Available\n    }\n  }\n}\n","import { Game } from '../game'\nimport { ScreenType, Screen } from './internal'\nimport { Profession } from '../profession'\nimport { TalentsTreeScreen } from './talents_tree_screen'\n\nexport class ProfessionPickingScreen extends Screen {\n  public options: Profession[]\n  public title: string\n\n  constructor(game: Game) {\n    super(ScreenType.ProfessionPicking, game)\n    this.options = this.game.professionPicker.available(this.player)\n\n    this.title = `Gained ${this.player.level.current -\n      this.player.levelUps +\n      1} level`\n  }\n\n  public onInput(pickedProfession: Profession) {\n    let playerProfession = this.player.professions.find(\n      profession => profession.id === pickedProfession.id\n    )\n    if (playerProfession) {\n      playerProfession.level += 1\n    } else {\n      this.player.professions.push(pickedProfession)\n    }\n\n    this.game.screen = new TalentsTreeScreen(this.game)\n  }\n}\n","import { Point, twoDimArray } from '../utils'\nimport { Creature, Phantom, Clan } from '../creature'\n\nimport { sample } from 'lodash'\nimport { MetaAI } from './meta_ai'\nimport { MemoryTile } from '../memory'\n\nconst FIRST_STEP: number = 1\n\ntype AIId = number\n\nexport abstract class AI {\n  private static lastId: AIId = 0\n  public static getId(): AIId {\n    return this.lastId++\n  }\n\n  constructor(public prevAI?: MetaAI, public id: AIId = AI.getId()) {}\n\n  public abstract act(actor: Creature, firstTurn: boolean): void\n\n  public abstract available(actor: Creature): boolean\n\n  public reset(): void {}\n\n  protected moveTo(actor: Creature, destination: Point): boolean {\n    // TODO: Rethink of it\n    if (actor.pos.eq(destination)) {\n      return true\n    }\n\n    const path = this.leePath(actor, point => destination.eq(point))\n\n    if (path.length) {\n      actor.move(path[0])\n    }\n\n    return !!path.length\n  }\n\n  protected followTo(actor: Creature, destination: Point): boolean {\n    const path = this.leePath(actor, point => destination.nextTo(point))\n\n    if (path.length) {\n      actor.move(path[0])\n    }\n\n    return !!path.length\n  }\n\n  protected leePath(\n    actor: Creature,\n    destination: (point: Point, tile: MemoryTile) => boolean,\n    randomDestination: boolean = false\n  ): Point[] {\n    const map = actor.stageMemory()\n\n    let stageMemory: number[][] = twoDimArray(\n      map.width,\n      map.height,\n      () => undefined\n    )\n    let pointsToVisit: Point[] = []\n    let pointsToCheck: Point[] = [actor.pos]\n\n    let step = 0\n    while (pointsToCheck.length && !pointsToVisit.length) {\n      let wavePoints: Array<Point> = []\n\n      pointsToCheck.forEach((point: Point) => {\n        if (!map.inRange(point)) {\n          return\n        }\n\n        const tile = map.at(point.x, point.y)\n        // TODO: Compare, current value might be lower\n        if (\n          tile.tangible(actor) ||\n          stageMemory[point.x][point.y] !== undefined\n        ) {\n          return\n        }\n\n        stageMemory[point.x][point.y] = step\n        if (destination(point, tile)) {\n          pointsToVisit.push(point)\n        } else {\n          point.wrappers().forEach(dist => wavePoints.push(dist))\n        }\n      })\n      step++\n\n      pointsToCheck = wavePoints\n    }\n\n    if (pointsToVisit.length) {\n      if (randomDestination) {\n        return this.buildRoad(sample(pointsToVisit), stageMemory)\n      } else {\n        return this.buildRoad(pointsToVisit[0], stageMemory)\n      }\n    } else {\n      return []\n    }\n  }\n\n  private buildRoad(point: Point, stageMemory: number[][]): Point[] {\n    let lastPoint = point\n    let chain = [lastPoint]\n\n    let delta: Point = undefined\n\n    while (stageMemory[lastPoint.x][lastPoint.y] !== FIRST_STEP) {\n      delta = Point.dxy.find(\n        (dp): boolean => {\n          return (\n            stageMemory[lastPoint.x + dp.x] &&\n            stageMemory[lastPoint.x + dp.x][lastPoint.y + dp.y] ===\n              stageMemory[lastPoint.x][lastPoint.y] - 1\n          )\n        }\n      )\n\n      if (!delta) {\n        return []\n      }\n\n      lastPoint = lastPoint.add(delta)\n\n      chain.unshift(lastPoint)\n    }\n\n    return chain\n  }\n\n  protected withinView(\n    actor: Creature,\n    visit: (point: Point, tile: MemoryTile) => void\n  ): void {\n    const map = actor.stageMemory()\n\n    let tileVisited: boolean[][] = twoDimArray(\n      map.width,\n      map.height,\n      () => false\n    )\n    let pointsToCheck: Point[] = [actor.pos]\n\n    while (pointsToCheck.length) {\n      let wavePoints: Array<Point> = []\n\n      pointsToCheck.forEach((point: Point) => {\n        if (!map.inRange(point)) {\n          return\n        }\n\n        const tile = map.at(point.x, point.y)\n        if (!tile.visible || tileVisited[point.x][point.y]) {\n          return\n        }\n\n        tileVisited[point.x][point.y] = true\n\n        visit(point, tile)\n\n        point.wrappers().forEach(dist => wavePoints.push(dist))\n      })\n\n      pointsToCheck = wavePoints\n    }\n  }\n\n  public enemies(actor: Phantom, enemy: Phantom): boolean {\n    if (actor.id === enemy.id) {\n      return false\n    }\n\n    if (actor.clan() === Clan.FreeForAll || enemy.clan() === Clan.FreeForAll) {\n      return true\n    }\n\n    if (actor.clan() === Clan.Player && enemy.clan() === Clan.PlayerOnlyEnemy) {\n      return true\n    }\n\n    if (enemy.clan() === Clan.Player && actor.clan() === Clan.PlayerOnlyEnemy) {\n      return true\n    }\n\n    return false\n  }\n}\n\nexport abstract class FollowTargetAI extends AI {\n  public destination: Point = undefined\n\n  public available(actor: Creature): boolean {\n    return this.foundNewTarget(actor) || !!this.destination\n  }\n\n  public act(actor: Creature): void {\n    if (!this.destination) {\n      throw `FollowTargetAI's act got called when there is no destination!`\n    }\n\n    if (this.goTo(actor)) {\n      this.onMove(actor)\n      // If got the destination\n      if (this.destination.eq(actor.pos)) {\n        this.destination = undefined\n        this.onReach(actor)\n      }\n    } else {\n      // If can not move\n      this.destination = undefined\n      this.onCantMove(actor)\n    }\n  }\n\n  public reset(): void {\n    this.destination = undefined\n  }\n\n  protected goTo(actor: Creature): boolean {\n    return this.moveTo(actor, this.destination)\n  }\n\n  protected abstract foundNewTarget(actor: Creature): boolean\n  protected onMove(actor: Creature): void {}\n  protected onReach(actor: Creature): void {}\n  protected onCantMove(actor: Creature): void {}\n}\n\nexport abstract class GoToTileAI extends FollowTargetAI {\n  constructor(\n    metaAI: MetaAI,\n    protected matcher: (tile: MemoryTile) => boolean\n  ) {\n    super(metaAI)\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    const path = this.leePath(actor, (point, tile) => this.matcher(tile), true)\n\n    if (path.length) {\n      this.destination = path.pop()\n      return true\n    } else {\n      return false\n    }\n  }\n}\n","import { AI } from './internal'\nimport { Phantom, Creature, Reaction, AttackEvent } from '../creature'\n\nexport class Attacker extends AI {\n  public victim?: Creature\n\n  public available(actor: Creature): boolean {\n    return this.canAttack(actor)\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    if (this.victimInAccess(actor)) {\n      this.attack(actor)\n    } else {\n      if (!firstTurn) {\n        throw 'Attacker got called twice'\n      }\n\n      this.pickNewVictim(actor)\n      this.act(actor, false)\n    }\n  }\n\n  protected attack(actor: Creature) {\n    if (this.victim.on(new AttackEvent(actor)) === Reaction.DIE) {\n      this.victim = undefined\n    }\n  }\n\n  private canAttack(actor: Creature): boolean {\n    const creature = this.findCreature(actor, creature =>\n      this.enemies(actor, creature)\n    )\n    return !!creature\n  }\n\n  private victimInAccess(actor: Creature): boolean {\n    if (this.victim === undefined) {\n      return false\n    }\n\n    const creature = this.findCreature(\n      actor,\n      creature => creature.id === this.victim.id\n    )\n    return !!creature\n  }\n\n  private pickNewVictim(actor: Creature) {\n    this.victim = this.findCreature(actor, creature =>\n      this.enemies(actor, creature)\n    ).real()\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): Phantom {\n    const memory = actor.stageMemory()\n    return actor.pos\n      .wrappers()\n      .map(({ x, y }) => memory.at(x, y).creature())\n      .find(creature => creature && condition(creature))\n  }\n}\n","import { FollowTargetAI } from './internal'\nimport { Phantom, Creature, CreatureId } from '../creature'\nimport { Point } from '../utils'\n\nexport class Chaser extends FollowTargetAI {\n  private victimId?: CreatureId\n\n  public reset(): void {\n    super.reset()\n    this.victimId = undefined\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    // Is there a victim and a path to it?\n    return (\n      (this.victimSet() && this.buildVictimPath(actor)) ||\n      this.foundNewVictim(actor)\n    )\n  }\n\n  protected onCantMove(): void {\n    this.victimId = undefined\n  }\n\n  protected onReach(): void {\n    this.victimId = undefined\n  }\n\n  private victimSet(): boolean {\n    return !!this.victimId\n  }\n\n  protected goTo(actor: Creature): boolean {\n    return this.followTo(actor, this.destination)\n  }\n\n  private buildVictimPath(actor: Creature): boolean {\n    return this.findCreature(actor, creature => creature.id === this.victimId)\n  }\n\n  private foundNewVictim(actor: Creature): boolean {\n    // Found new victim and built path to it\n    return (\n      this.findCreature(actor, creature => this.enemies(actor, creature)) &&\n      this.buildVictimPath(actor)\n    )\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): boolean {\n    let result: boolean = false\n\n    this.withinView(actor, ({ x, y }, tile) => {\n      const creature = tile.creature()\n\n      if (!result && creature && condition(creature)) {\n        this.destination = new Point(x, y)\n        this.victimId = creature.id\n        result = true\n      }\n    })\n\n    return result\n  }\n}\n","import { AI } from './internal'\nimport { Creature, Player } from '../creature'\nimport { ItemsBunch, Item } from '../items/internal'\nimport { Tile } from '../tile'\nimport { Logger } from '../logger'\nimport {\n  Game,\n  Wearing,\n  allInventorySlots,\n  Modifier,\n  AIPutOnItem,\n} from '../../engine'\n\nimport { compact, flatten, includes } from 'lodash'\n\nexport abstract class AIEvent {\n  protected logger: Logger\n  protected player: Player\n\n  constructor(protected game: Game) {\n    this.player = game.player\n    this.logger = game.logger\n  }\n\n  public abstract act(): void\n\n  protected tile(): Tile {\n    return this.player.currentLevel.at(this.player.pos.x, this.player.pos.y)\n  }\n}\n\nexport class AIItemPickedEvent extends AIEvent {\n  constructor(public items: ItemsBunch, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    this.player.inventory.cares().forEach(item => {\n      const wearing = this.whereToWear(item.item)\n\n      if (wearing) {\n        // TODO: Use matching slot\n        new AIPutOnItem(wearing.inventorySlot, item.item, this.game).act()\n      }\n    })\n  }\n\n  private whereToWear(item: Item): Wearing {\n    const matches: Wearing[] = compact(\n      flatten(\n        item.usages.map(usage =>\n          allInventorySlots.filter(slot => includes(slot.usages, usage))\n        )\n      ).map(slot => this.player.inventory.matchingEquip(slot))\n    )\n\n    if (matches.length === 0) {\n      return null\n    }\n\n    const weightModifier = new Modifier({\n      attack: 1,\n      defense: 1,\n      health: 1,\n      radius: 0.5,\n      speed: 1,\n    })\n\n    const { wearing } = matches.reduce(\n      (acc, wearing) => {\n        let weight = 0\n\n        if (wearing.equipment) {\n          item.modifier.withWeight(\n            wearing.equipment.item.modifier,\n            weightModifier,\n            (f, s, w) => (weight += w * (f - s))\n          )\n        } else {\n          item.modifier.with(weightModifier, (f, w) => (weight += f * w))\n        }\n\n        if (acc.weight > weight) {\n          return acc\n        } else {\n          return { weight, wearing }\n        }\n      },\n      { weight: 0, wearing: null }\n    )\n\n    return wearing\n  }\n}\n\nexport abstract class MetaAI extends AI {\n  constructor(public aiToRun: AI = null) {\n    super()\n  }\n  protected events: AIEvent[] = []\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n\n  public pushEvent(event: AIEvent) {\n    this.events.push(event)\n  }\n\n  protected resetEvents(): void {\n    this.events = []\n  }\n\n  public runEvents(): void {\n    this.events.forEach(event => {\n      event.act()\n    })\n\n    this.resetEvents()\n  }\n}\n","import {\n  AI,\n  Attacker,\n  Chaser,\n  Escaper,\n  Explorer,\n  Loiter,\n  Picker,\n  Patrol,\n  SelfHealer,\n  Descender,\n  Thrower,\n} from '../ai'\nimport { Creature } from '../creature'\nimport { MetaAI } from './meta_ai'\n\nexport class Dispatcher extends MetaAI {\n  private escaper: Escaper\n  private explorer: Explorer\n  private chaser: Chaser\n  private attacker: Attacker\n  private picker: Picker\n  private patrol: Patrol\n  private loiter: Loiter\n  private thrower: Thrower\n\n  private descender: Descender\n\n  private firstCallPatrol: boolean = true\n\n  private step: number = 0\n\n  constructor() {\n    super()\n    this.escaper = new Escaper(this)\n    this.explorer = new Explorer(this)\n    this.chaser = new Chaser(this)\n    this.attacker = new Attacker(this)\n    this.picker = new Picker(this)\n    this.patrol = new Patrol(this)\n    this.loiter = new Loiter(this)\n    this.thrower = new Thrower(this)\n\n    this.descender = new Descender(this)\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    // Never dispatch twice\n    if (!firstTurn) {\n      throw 'Meta AI called recursively'\n    }\n\n    this.step += 1\n\n    if (this.step % actor.characteristics.regenerateEvery() === 0) {\n      actor.characteristics.regenerate()\n    }\n\n    this.runEvents()\n\n    if (this.feelsGood(actor)) {\n      if (this.attacker.available(actor)) {\n        this.setAi(this.attacker)\n      } else if (this.thrower.available(actor)) {\n        this.setAi(this.thrower)\n      } else if (this.chaser.available(actor)) {\n        this.setAi(this.chaser)\n      } else if (this.seesItems(actor)) {\n        this.pickItem(actor)\n      } else {\n        this.explore(actor)\n      }\n    } else if (this.healthCritical(actor) && this.escaper.available(actor)) {\n      this.setAi(this.escaper)\n    } else if (this.attacker.available(actor)) {\n      this.setAi(this.attacker)\n    } else if (this.thrower.available(actor)) {\n      this.setAi(this.thrower)\n    } else if (this.chaser.available(actor)) {\n      this.setAi(this.chaser)\n    } else {\n      this.rest(actor)\n    }\n\n    this.resetEvents()\n    this.aiToRun.act(actor, firstTurn)\n  }\n\n  private feelsGood(actor: Creature): boolean {\n    return (\n      actor.characteristics.health.currentValue() >\n      actor.characteristics.health.maximum() * 0.9\n    )\n  }\n\n  private healthCritical(actor: Creature): boolean {\n    return (\n      actor.characteristics.health.currentValue() <\n      actor.characteristics.health.maximum() / 4\n    )\n  }\n\n  private seesItems(actor: Creature): boolean {\n    return this.picker.available(actor)\n  }\n\n  private pickItem(actor: Creature): void {\n    this.setAi(this.picker)\n  }\n\n  private explore(actor: Creature): void {\n    if (this.explorer.available(actor)) {\n      this.patrol.trackMovement(actor)\n      this.setAi(this.explorer)\n    } else if (this.descender.available(actor)) {\n      this.setAi(this.descender)\n    } else if (this.patrol.available(actor)) {\n      if (this.firstCallPatrol) {\n        this.firstCallPatrol = false\n        this.patrol.addNode(actor.pos.x, actor.pos.y)\n      }\n      this.setAi(this.patrol)\n    } else {\n      this.setAi(this.loiter)\n    }\n  }\n\n  private rest(actor: Creature): void {\n    this.setAi(new SelfHealer(this))\n  }\n\n  private setAi(ai: AI): void {\n    if (this.aiToRun && this.aiToRun.id !== ai.id) {\n      this.aiToRun.reset()\n    }\n\n    this.aiToRun = ai\n  }\n}\n","import { FollowTargetAI } from './internal'\nimport { Phantom, Creature } from '../creature'\n\nimport { sumBy } from 'lodash'\nimport { Point } from '../../engine'\n\nconst STEP_DISTANCE = 2\n\nexport class Escaper extends FollowTargetAI {\n  private escapesFrom: [Point, Phantom][] = []\n\n  protected foundNewTarget(actor: Creature): boolean {\n    return this.foundEnemies(actor) && this.buildPath(actor)\n  }\n\n  private buildPath(\n    actor: Creature,\n    minDistance: number = actor.radius() / 2\n  ): boolean {\n    if (minDistance <= 1) {\n      this.destination = undefined\n      return false\n    }\n\n    const path = this.leePath(\n      actor,\n      ({ x, y }) => {\n        const score = sumBy(this.escapesFrom, ([pos, enemy]) => {\n          // I don't use pathfinding since it should try\n          // to run away from those who are visible, so the path\n          // to them should be straightforward.\n          return Math.max(Math.abs(x - pos.x), Math.abs(y - pos.y))\n        })\n\n        return score >= minDistance\n      },\n      true\n    )\n\n    if (path.length) {\n      this.destination = path.pop()\n      return true\n    } else {\n      return this.buildPath(actor, minDistance - STEP_DISTANCE)\n    }\n  }\n\n  private foundEnemies(actor: Creature): boolean {\n    this.escapesFrom = []\n\n    this.withinView(actor, (point, tile) => {\n      const creature = tile.creature()\n\n      if (creature && this.enemies(actor, creature)) {\n        this.escapesFrom.push([point, creature])\n      }\n    })\n\n    return this.escapesFrom.length > 0\n  }\n}\n","import { GoToTileAI } from '../ai'\nimport { MetaAI } from './meta_ai'\n\nexport class Explorer extends GoToTileAI {\n  constructor(metaAI: MetaAI) {\n    super(metaAI, tile => !tile.seen)\n  }\n}\n","import { AI } from './internal'\nimport { Creature } from '../creature'\n\nexport class Loiter extends AI {\n  // private turns: number = 0\n\n  act(actor: Creature, firstTurn: boolean = true): void {\n    // if (this.turns > 1) {\n    //   actor.ai = this.prevAI\n    //   this.prevAI.act(actor, false)\n    //   return\n    // }\n\n    const path = this.leePath(actor, point => !actor.pos.eq(point), true)\n\n    if (path.length) {\n      // this.turns += 1\n      actor.move(path[0])\n    }\n  }\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n}\n","import { AI } from './internal'\n\nimport { Point, succ } from '../utils'\nimport { Creature } from '../creature'\n\nimport * as graphlib from 'graphlib'\nimport { Loiter } from './loiter'\nimport { MetaAI } from './meta_ai'\n\ntype NodeID = string\n\nconst NEW_POINT_EVERY: number = 10\n\nexport class Patrol extends AI {\n  private i: NodeID\n  private graph: graphlib.Graph\n  private lastNodeVisit: { [key: string]: number }\n  private currentNodeID: NodeID\n  private targetNodeID: NodeID\n  private path: Point[]\n  private step: number = NEW_POINT_EVERY\n\n  constructor(ai: MetaAI) {\n    super(ai)\n    this.i = 'a'\n\n    this.graph = new graphlib.Graph()\n\n    this.lastNodeVisit = {}\n\n    this.markNodeVisited(this.currentNodeID)\n    this.path = []\n  }\n\n  public available(actor: Creature): boolean {\n    return this.graph.nodes().length > 1\n  }\n\n  public act(actor: Creature, firstTurn: boolean = true): void {\n    if (this.path.length) {\n      this.moveToTarget(actor, firstTurn)\n    } else {\n      if (this.targetNodeID) {\n        this.markNodeVisited(this.targetNodeID)\n        this.currentNodeID = this.targetNodeID\n      }\n\n      this.pickUpNewTarget(actor)\n      this.moveToTarget(actor, firstTurn)\n    }\n    this.step += 1\n  }\n\n  public reset(): void {\n    this.path = []\n  }\n\n  public trackMovement(actor: Creature): void {\n    if (this.step >= NEW_POINT_EVERY || this.shouldAddNode(actor)) {\n      this.addNode(actor.pos.x, actor.pos.y)\n    }\n    this.step += 1\n  }\n\n  // TODO: If close enough to another node, use it instead.\n  public addNode(x: number, y: number): void {\n    this.graph.setNode(this.i, new Point(x, y))\n    if (this.currentNodeID && this.currentNodeID !== this.i) {\n      this.graph.setEdge(this.currentNodeID, this.i)\n    }\n    this.currentNodeID = this.i\n    this.i = succ(this.i)\n    this.step = 0\n  }\n\n  private buildNewPath(actor: Creature): void {\n    const pos: Point = this.graph.node(this.targetNodeID)\n\n    this.path = this.leePath(actor, point => pos.eq(point))\n  }\n\n  private pickUpNewTarget(actor: Creature): void {\n    let seenLastID: NodeID = this.graph.nodes()[0]\n    let seenLastStep: number = this.lastNodeVisit[seenLastID]\n\n    this.graph.neighbors(this.currentNodeID).forEach((nodeID: NodeID) => {\n      if (seenLastStep > (this.lastNodeVisit[nodeID] || 0)) {\n        seenLastID = nodeID\n        seenLastStep = this.lastNodeVisit[seenLastID]\n      }\n    })\n\n    this.targetNodeID = seenLastID\n    this.buildNewPath(actor)\n  }\n\n  private moveToTarget(actor: Creature, firstTurn: boolean): void {\n    const nextPoint: Point = this.path.shift()\n\n    if (!nextPoint) {\n      if (firstTurn) {\n        this.path = []\n        this.act(actor, false)\n      } else {\n        new Loiter(this.prevAI).act(actor, firstTurn)\n      }\n    } else if (\n      actor\n        .stageMemory()\n        .at(nextPoint.x, nextPoint.y)\n        .tangible()\n    ) {\n      this.buildNewPath\n\n      if (this.path.length) {\n        return this.act(actor, false)\n      }\n    } else {\n      actor.move(nextPoint)\n    }\n  }\n\n  private markNodeVisited(nodeID: NodeID): void {\n    this.lastNodeVisit[nodeID] = this.step\n  }\n\n  private shouldAddNode(actor: Creature): boolean {\n    return actor\n      .stageMemory()\n      .at(actor.previousPos.x, actor.previousPos.y)\n      .tile.isDoor()\n  }\n}\n","import { MetaAI } from './meta_ai'\nimport { Player } from '../creature'\nimport { IdleScreen, ProfessionPickingScreen } from '../../engine'\n\nexport class PlayerAI extends MetaAI {\n  public act(player: Player): void {\n    const game = player.currentLevel.game\n\n    // this.runEvents(player)\n    game.screen = new IdleScreen(game)\n\n    if (player.levelUps > 0) {\n      // TODO: Should never get here\n      player.currentLevel.game.screen = new ProfessionPickingScreen(game)\n    }\n  }\n}\n","import { FollowTargetAI } from '../ai'\nimport { Creature, Ability } from '../creature'\nimport { Item, ItemId } from '../items'\nimport { Point } from '../utils'\nimport { AIItemPickedEvent } from './meta_ai'\n\nexport class Picker extends FollowTargetAI {\n  private desiredItemId: ItemId = null\n\n  public available(actor: Creature): boolean {\n    return actor.can(Ability.Inventory) && super.available(actor)\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    return (\n      this.findItem(actor, item => item.id === this.desiredItemId) ||\n      this.findItem(actor, item => true)\n    )\n  }\n\n  protected onReach(actor: Creature): void {\n    const tile = actor.currentLevel.at(actor.pos.x, actor.pos.y)\n    this.prevAI.pushEvent(\n      new AIItemPickedEvent(tile.items, actor.currentLevel.game)\n    )\n\n    tile.items.bunch.forEach(groupedItem => {\n      actor.inventory.putToBag(groupedItem.item, groupedItem.count)\n    })\n\n    tile.items = undefined\n\n    this.desiredItemId = null\n  }\n\n  private findItem(\n    actor: Creature,\n    condition: (item: Item) => boolean\n  ): boolean {\n    let result: boolean = false\n\n    this.withinView(actor, ({ x, y }, tile) => {\n      if (!tile.items()) {\n        return\n      }\n\n      const item = tile\n        .items()\n        .bunch.find(groupedItem => condition(groupedItem.item))\n\n      if (item && !result) {\n        this.desiredItemId = item.id\n        this.destination = new Point(x, y)\n        result = true\n      }\n    })\n\n    return result\n  }\n}\n","import { AI } from '../ai'\nimport { Creature } from '../creature'\n\nexport class SelfHealer extends AI {\n  public available(actor: Creature): boolean {\n    return !actor.characteristics.health.atMax()\n  }\n\n  public act(actor: Creature): void {\n    // Does nothing, just waiting\n    // actor.characteristics.regenerate()\n  }\n}\n","import { GoToTileAI, MetaAI } from '../ai'\nimport { Ability, Creature, StairwayDown, TileTypes } from '../../engine'\n\nexport class Descender extends GoToTileAI {\n  private canDescend: boolean = false\n\n  constructor(metaAI: MetaAI) {\n    super(metaAI, tile => tile.tile.kind === TileTypes.StairwayDown)\n  }\n\n  public available(actor: Creature): boolean {\n    return actor.can(Ability.GoStairwayDown) && super.available(actor)\n  }\n\n  public reset(): void {\n    super.reset()\n    this.canDescend = false\n  }\n\n  protected foundNewTarget(actor: Creature): boolean {\n    // When we are on a stairway\n    this.canDescend = this.matcher(\n      actor.stageMemory().at(actor.pos.x, actor.pos.y)\n    )\n\n    if (this.canDescend) {\n      this.destination = actor.pos\n      return true\n    } else {\n      return super.foundNewTarget(actor)\n    }\n  }\n\n  protected onReach(actor: Creature) {\n    // Should stay here at least for a turn\n    const tile = actor.currentLevel.at(actor.pos.x, actor.pos.y)\n    if (this.canDescend && tile instanceof StairwayDown) {\n      tile.go(actor)\n    }\n  }\n}\n","import { Item } from './items/internal'\nimport { Point } from './utils'\nimport { Memory } from './memory'\n\nexport abstract class Effect {\n  constructor(public onDone: () => void) {}\n\n  public abstract done(): boolean\n  public abstract patchMemory(memory: Memory): void\n  public speed(): number {\n    return -1\n  }\n}\n\nexport class ItemFlightEffect extends Effect {\n  constructor(\n    public readonly item: Item,\n    private frames: Point[],\n    onDone: () => void\n  ) {\n    super(onDone)\n  }\n\n  public patchMemory(memory: Memory): void {\n    if (this.done()) {\n      return\n    }\n\n    const [point] = this.frames.splice(0, 1)\n    const tile = memory.at(point.x, point.y)\n\n    if (tile.visible) {\n      tile.effect = '-'\n    } else {\n      // Skipping effect if it's not visible\n      this.patchMemory(memory)\n    }\n  }\n\n  public done(): boolean {\n    return this.frames.length === 0\n  }\n}\n","import { AI } from './internal'\nimport {\n  Creature,\n  Ability,\n  Phantom,\n  Reaction,\n  ThrowEvent,\n} from '../creature'\nimport { GroupedItem } from '../items/internal'\nimport { Point, bresenham } from '../utils'\nimport { ItemFlightEffect } from '../effect'\nimport { MissileSlot } from '../inventory'\n\nexport class Thrower extends AI {\n  public victim: Creature\n  public previousVictim: Creature\n  public missiles: GroupedItem\n\n  public available(actor: Creature): boolean {\n    return (\n      actor.can(Ability.Throwing) &&\n      this.hasMissile(actor) &&\n      this.canAttack(actor)\n    )\n  }\n\n  public act(actor: Creature): void {\n    const missile = this.missiles.item\n    actor.inventory.removeWearing(actor, MissileSlot, 1)\n\n    let path = []\n\n    bresenham(actor.pos, this.victim.pos, (x, y) => path.push(new Point(x, y)))\n\n    const effect = new ItemFlightEffect(missile, path, () => {\n      if (this.victim.on(new ThrowEvent(actor, missile)) === Reaction.DIE) {\n        this.victim = undefined\n        this.previousVictim = undefined\n      }\n    })\n\n    actor.currentLevel.addEffect(effect)\n  }\n\n  private hasMissile(actor: Creature): boolean {\n    this.missiles = actor.inventory.inSlot(MissileSlot)\n    return this.missiles !== undefined\n  }\n\n  private canAttack(actor: Creature): boolean {\n    this.previousVictim = this.victim\n    this.victim = undefined\n\n    if (this.previousVictim) {\n      if (\n        this.findCreature(\n          actor,\n          creature => this.previousVictim.id === creature.id\n        )\n      ) {\n        return true\n      }\n    }\n\n    return this.findCreature(actor, creature => this.enemies(actor, creature))\n  }\n\n  private findCreature(\n    actor: Creature,\n    condition: (creature: Phantom) => boolean\n  ): boolean {\n    this.withinView(actor, (point, tile) => {\n      const creature = tile.creature()\n\n      if (\n        !this.victim &&\n        creature &&\n        condition(creature) &&\n        !this.obstacles(actor, point)\n      ) {\n        this.victim = actor.currentLevel.at(point.x, point.y).creature.real()\n      }\n    })\n\n    return !!this.victim\n  }\n\n  private obstacles(actor: Creature, target: Point): boolean {\n    let obstacles = false\n\n    bresenham(actor.pos, target, (x, y) => {\n      obstacles =\n        obstacles ||\n        actor\n          .stageMemory()\n          .at(x, y)\n          .tangible(actor)\n    })\n\n    return obstacles\n  }\n}\n","import { Phantom, Creature } from './creature'\nimport { Item } from './items'\nimport { Point } from './utils'\nimport { LevelMap } from './map'\nimport { ItemsBunch } from './items/internal'\n\nexport enum TileTypes {\n  Wall,\n  Door,\n  Floor,\n  StairwayDown,\n  StairwayUp,\n}\n\nexport class Tile {\n  public creature?: Phantom\n  public items: ItemsBunch\n\n  private static repository: { [key: string]: Tile } = {}\n\n  public static retrieve(key: string): Tile {\n    switch (key) {\n      case 'R':\n        return new Tile('R', ' ', TileTypes.Floor)\n      case 'C':\n        return new Tile('C', ' ', TileTypes.Floor)\n      case 'W':\n        return new Tile('W', '#', TileTypes.Wall)\n      case 'D':\n        return new Tile('D', '+', TileTypes.Door)\n      case '>':\n        return new Tile('>', '>', TileTypes.StairwayDown)\n      case '<':\n        return new Tile('<', '<', TileTypes.StairwayUp)\n      default:\n        throw `Tile '${key}' is not registered!`\n    }\n  }\n\n  protected constructor(\n    public key: string,\n    public display: string,\n    public kind: TileTypes\n  ) {}\n\n  public addItem(item: Item, count: number): void {\n    if (!this.items) {\n      this.items = new ItemsBunch()\n    }\n\n    this.items.put(item, count)\n  }\n\n  public isDoor(): boolean {\n    return this.kind === TileTypes.Door\n  }\n\n  public isWall(): boolean {\n    return this.kind === TileTypes.Wall\n  }\n\n  public isFloor(): boolean {\n    return this.kind === TileTypes.Floor\n  }\n\n  public isStairway(): boolean {\n    return (\n      this.kind === TileTypes.StairwayDown || this.kind === TileTypes.StairwayUp\n    )\n  }\n\n  public visibleThrough(): boolean {\n    return (\n      this.isFloor() ||\n      this.kind === TileTypes.StairwayDown ||\n      this.kind === TileTypes.StairwayUp\n    )\n  }\n\n  public passibleThrough(actor?: Creature): boolean {\n    if (actor && this.creature) {\n      return this.kind !== TileTypes.Wall && this.creature.id === actor.id\n    }\n\n    return this.kind !== TileTypes.Wall && !this.creature\n  }\n\n  public clone(): Tile {\n    let tile = Tile.retrieve(this.key)\n    if (this.creature) {\n      tile.creature = this.creature.clone()\n    }\n    tile.items = this.items && this.items.clone()\n    return tile\n  }\n\n  protected uniq(): boolean {\n    return this.creature !== undefined\n  }\n}\n\nabstract class Stairway extends Tile {\n  protected currentMap: LevelMap\n  protected adjacentMap: LevelMap\n  protected enterPos: Point\n\n  public go(actor: Creature): void {\n    this.currentMap.leave(actor)\n    this.adjacentMap.enter(actor, this.enterPos)\n\n    this.adjacentMap.game.currentMap = this.adjacentMap\n  }\n}\n\nexport class StairwayDown extends Stairway {\n  constructor(\n    protected currentMap: LevelMap,\n    protected adjacentMap: LevelMap,\n    protected enterPos: Point\n  ) {\n    super('>', '>', TileTypes.StairwayDown)\n  }\n}\n\nexport class StairwayUp extends Stairway {\n  constructor(\n    protected currentMap: LevelMap,\n    protected adjacentMap: LevelMap,\n    protected enterPos: Point\n  ) {\n    super('<', '<', TileTypes.StairwayUp)\n  }\n}\n","import * as moment from 'moment'\nimport { Creature } from './creature'\nimport { Moment } from 'moment'\nimport { Item, Potion } from './items/internal'\n\nexport enum LogLevel {\n  DEBUG,\n  INFO,\n  WARNING,\n  DANGER,\n}\n\nexport class LogMessage {\n  constructor(\n    public level: LogLevel,\n    public ts: Moment,\n    public message: string\n  ) {}\n}\n\nexport class Logger {\n  public messages: LogMessage[] = []\n\n  public hurtMessage(damage: number, actor: Creature, target: Creature) {\n    this.debug(`${target.name()} got ${damage} damage from ${actor.name()}`)\n  }\n\n  public killMessage(damage: number, actor: Creature, target: Creature) {\n    this.warning(\n      `${target.name()} got ${damage} damage from ${actor.name()} causes them to die`\n    )\n  }\n\n  public missMessage(actor: Creature, target: Creature) {\n    this.debug(`${actor.name()} misses ${target.name()}!`)\n  }\n\n  public throwMissMessage(actor: Creature, target: Creature, missile: Item) {\n    this.debug(\n      `${actor.name()} throws ${missile.name} in ${target.name()}, but misses!`\n    )\n  }\n\n  public throwKillMessage(\n    damage: number,\n    actor: Creature,\n    target: Creature,\n    missile: Item\n  ) {\n    this.warning(\n      `${target.name()} got ${damage} damage from ${actor.name()} by ${\n        missile.name\n      } causes them to die`\n    )\n  }\n\n  public throwHurtMessage(\n    damage: number,\n    actor: Creature,\n    target: Creature,\n    missile: Item\n  ) {\n    this.debug(\n      `${target.name()} got ${damage} damage from ${actor.name()} by ${\n        missile.name\n      }`\n    )\n  }\n\n  public ranIntoAnObstacle(): void {\n    this.addMessage(LogLevel.DEBUG, 'You ran into a wall')\n  }\n\n  public howToHandle(): void {\n    this.addMessage(LogLevel.DEBUG, \"Don't know how to handle it\")\n  }\n\n  public noItemsToPickUp(): void {\n    this.addMessage(LogLevel.DEBUG, \"You don't see anything to pick up\")\n  }\n\n  public takeOff(item: Item): void {\n    this.addMessage(LogLevel.DEBUG, `You took off ${item.name}`)\n  }\n\n  public putOn(item: Item): void {\n    this.addMessage(LogLevel.DEBUG, `You put on ${item.name}`)\n  }\n\n  public drink(item: Potion): void {\n    this.addMessage(LogLevel.INFO, `You drunk ${item.name}`)\n  }\n\n  public pickedUpItem(item: Item, count: number): void {\n    if (count === 1) {\n      this.addMessage(LogLevel.INFO, `You picked up ${item.name}`)\n    } else {\n      this.addMessage(LogLevel.INFO, `You picked up ${count} ${item.name}`)\n    }\n  }\n\n  public droppedItem(item: Item, count: number): void {\n    if (count === 1) {\n      this.addMessage(LogLevel.INFO, `You dropped a ${item.name}`)\n    } else {\n      this.addMessage(LogLevel.INFO, `You dropped ${count} ${item.name}`)\n    }\n  }\n\n  protected debug(message: string): void {\n    this.addMessage(LogLevel.DEBUG, message)\n  }\n\n  protected info(message: string): void {\n    this.addMessage(LogLevel.INFO, message)\n  }\n\n  protected warning(message: string): void {\n    this.addMessage(LogLevel.WARNING, message)\n  }\n\n  protected danger(message: string): void {\n    this.addMessage(LogLevel.DANGER, message)\n  }\n\n  protected addMessage(level: LogLevel, message: string): void {\n    this.messages.push(new LogMessage(level, moment(), message))\n  }\n}\n","import { forEach, keys, min, remove, size, pullAt } from 'lodash'\n\nexport class Timeline<T> {\n  private step: number = 0\n  private turns: { [key: number]: T[] } = {}\n\n  public add(item: T, delta: number): void {\n    const ts = this.step + delta\n\n    if (this.turns[ts]) {\n      this.turns[ts].push(item)\n    } else {\n      this.turns[ts] = [item]\n    }\n  }\n\n  public remove(item: T): void {\n    forEach(this.turns, (value, key) => {\n      remove(value, element => element === item)\n    })\n  }\n\n  public next(): T {\n    this.step = min(keys(this.turns).map(x => parseInt(x)))\n\n    const [element] = pullAt(this.turns[this.step], 0)\n\n    if (this.turns[this.step].length === 0) {\n      delete this.turns[this.step]\n    }\n\n    return element\n  }\n\n  public actors(): T[] {\n    if (size(this.turns) === 0) {\n      return []\n    }\n\n    this.step = min(keys(this.turns).map(x => parseInt(x)))\n    const actors = this.turns[this.step]\n\n    delete this.turns[this.step]\n\n    return actors\n  }\n}\n","import { Creature, CreatureId } from './creature'\nimport { Mapped, Point } from './utils'\nimport { Timeline } from './timeline'\nimport { Game } from './game'\nimport { Tile } from './tile'\n\nimport { remove } from 'lodash'\nimport { Effect } from '../engine'\n\nexport type LevelMapId = number\n\nexport type TimeEvent = [CreatureId, Effect]\n\nexport class LevelMap extends Mapped<Tile> {\n  public creatures: Creature[] = []\n  public id: LevelMapId\n  public game: Game\n  public timeline: Timeline<TimeEvent>\n\n  private static lastId: LevelMapId = 0\n  public static getId(): LevelMapId {\n    return this.lastId++\n  }\n\n  constructor(map: Tile[][]) {\n    super(map)\n    this.id = LevelMap.getId()\n    this.timeline = new Timeline()\n  }\n\n  public reset(): void {\n    this.timeline = new Timeline()\n  }\n\n  public leave(actor: Creature): void {\n    this.reset()\n    this.removeCreature(actor)\n  }\n\n  public enter(actor: Creature, enterPos: Point): void {\n    this.reset()\n    this.creatures.forEach(creature =>\n      this.timeline.add([creature.id, undefined], creature.speed())\n    )\n\n    actor.addToMap(enterPos, this)\n  }\n\n  public addCreature(creature: Creature) {\n    this.creatures.push(creature)\n    // TODO fail if taken\n    this.at(creature.pos.x, creature.pos.y).creature = creature\n    this.timeline.add([creature.id, undefined], creature.speed())\n  }\n\n  public removeCreature(creature: Creature) {\n    let tile = this.at(creature.pos.x, creature.pos.y)\n    tile.creature = undefined\n    remove(this.creatures, c => c.id === creature.id)\n    this.timeline.remove([creature.id, undefined])\n  }\n\n  public visibleThrough(x: number, y: number): boolean {\n    return this.map[x][y].visibleThrough()\n  }\n\n  public passibleThrough(x: number, y: number): boolean {\n    return this.map[x][y].passibleThrough()\n  }\n\n  public setTile(x: number, y: number, tile: Tile): void {\n    this.map[x][y] = tile\n  }\n\n  public addEffect(effect: Effect): void {\n    this.timeline.add([undefined, effect], effect.speed())\n  }\n\n  public turn(): Effect {\n    const [actorId, effect] = this.timeline.next()\n\n    if (actorId !== undefined) {\n      const actor = this.creatures.find(creature => actorId === creature.id)\n\n      if (actor) {\n        actor.act(this)\n\n        // If they are still on a map\n        if (this.creatures.find(creature => actorId === creature.id)) {\n          this.timeline.add([actorId, undefined], actor.speed())\n        }\n      }\n      return\n    } else if (effect) {\n      if (effect.done()) {\n        effect.onDone()\n      } else {\n        this.timeline.add([undefined, effect], effect.speed())\n      }\n\n      return effect\n    } else {\n      throw 'Timeline event is empty!'\n    }\n  }\n}\n","export class Level {\n  public current: number = 1\n  public currentExperience: number = 0\n  public requiredExperience: number\n\n  private doneLeveling: boolean = false\n\n  constructor(private requires: number[]) {\n    this.requiredExperience = this.requires[0]\n  }\n\n  public add(exp: number): number {\n    if (this.doneLeveling) {\n      return\n    }\n\n    this.currentExperience += exp\n\n    let levelUps = 0\n\n    while (\n      !this.doneLeveling &&\n      this.currentExperience >= this.requiredExperience\n    ) {\n      levelUps += 1\n      this.levelUp()\n    }\n\n    return levelUps\n  }\n\n  protected levelUp(): void {\n    this.current += 1\n\n    let level = this.requires[this.current - 1]\n\n    if (level) {\n      this.currentExperience -= this.requiredExperience\n      this.requiredExperience = level\n    } else {\n      this.currentExperience = this.requiredExperience\n      this.doneLeveling = true\n    }\n  }\n}\n","import { Tile } from './tile'\nimport { Creature, Phantom, twoDimArray } from '../engine'\nimport { ItemsBunch } from './items/internal'\nimport { Mapped } from './utils'\n\nexport class MemoryTile {\n  public visible: boolean = false\n  public degree: number = 0\n  public seen: boolean = false\n  public effect?: string\n\n  constructor(public tile?: Tile) {}\n\n  public see(tile: Tile, degree: number) {\n    this.visible = true\n    this.degree = degree\n    this.seen = true\n    this.tile = tile.clone()\n  }\n\n  public items(): ItemsBunch {\n    return this.tile.items\n  }\n\n  public tangible(actor?: Creature): boolean {\n    return this.seen && !this.tile.passibleThrough(actor)\n  }\n\n  public creature(): Phantom {\n    return this.tile && this.tile.creature\n  }\n\n  public reset(): void {\n    this.visible = false\n    this.effect = undefined\n    this.tile.creature = undefined\n  }\n}\n\nexport class Memory extends Mapped<MemoryTile> {\n  constructor(width: number, height: number) {\n    const baseTile = Tile.retrieve('W')\n    super(twoDimArray(width, height, () => new MemoryTile(baseTile)))\n  }\n\n  public resetVisible(): void {\n    this.each(tile => tile.reset())\n  }\n}\n","import { Logger, LevelMap, Player, Screen } from '../engine'\nimport { ProfessionPicker } from './profession'\n\nexport abstract class Game {\n  public logger: Logger = new Logger()\n  public currentMap: LevelMap\n  public player: Player\n  public screen: Screen = null\n  public running: boolean = false\n  public professionPicker: ProfessionPicker\n\n  public turn() {\n    if (this.running || this.screen) {\n      return\n    }\n\n    this.player.ai.runEvents()\n\n    this.running = true\n\n    while (!this.player.dead && !this.screen) {\n      const effect = this.player.currentLevel.turn()\n\n      if (effect) {\n        this.player.rebuildVision()\n        effect.patchMemory(this.player.stageMemory())\n\n        this.running = false\n        return\n      }\n    }\n\n    this.player.rebuildVision()\n\n    this.running = false\n  }\n}\n","import { random } from 'lodash'\n\nexport class Pool<Input, Output> {\n  private totalWeight: number = 0\n  private items: [number, (Input) => Output][] = []\n\n  constructor(items: [number, (Input) => Output][]) {\n    items.forEach(([weight, item]) => this.add(weight, item))\n  }\n\n  public add(weight: number, item: (Input) => Output): void {\n    if (weight < 1) {\n      throw `Item's weight is lower than 1`\n    }\n\n    this.items.push([weight, item])\n    this.totalWeight += Math.ceil(weight)\n  }\n\n  public pick(input: Input): Output {\n    if (this.items.length === 0) {\n      throw 'Tried to use empty pool'\n    }\n\n    let pick = random(this.totalWeight)\n\n    return this.items.find(([weight, item]) => {\n      pick -= weight\n\n      return pick <= 0\n    })[1](input)\n  }\n\n  public merge(pool: Pool<Input, Output>): Pool<Input, Output> {\n    let totalPool = new Pool<Input, Output>([])\n\n    this.items.forEach(([weight, item]) => totalPool.add(weight, item))\n    pool.items.forEach(([weight, item]) => totalPool.add(weight, item))\n\n    return totalPool\n  }\n}\n","import { LevelMap, Tile, StairwayDown, StairwayUp, Item } from '../../engine'\nimport { Pool } from '../pool'\nimport { Creature } from '../creature'\nimport { Point, cycle } from '../utils'\n\nimport { random } from 'lodash'\n\nexport const addDoors = function(\n  level: LevelMap,\n  addDoor: () => boolean = () => true\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width; i++) {\n      const tile = level.at(i, j),\n        up = level.at(i, j - 1),\n        down = level.at(i, j + 1),\n        left = level.at(i - 1, j),\n        right = level.at(i + 1, j)\n\n      if (!addDoor() || tile.key !== 'C') {\n        continue\n      }\n\n      if (\n        left.key === 'D' ||\n        right.key === 'D' ||\n        up.key === 'D' ||\n        down.key === 'D'\n      ) {\n        continue\n      }\n\n      if (\n        left.key !== 'R' &&\n        right.key !== 'R' &&\n        up.key !== 'R' &&\n        down.key !== 'R'\n      ) {\n        continue\n      }\n\n      if (\n        (left.key === 'W' && right.key === 'W') ||\n        (up.key === 'W' && down.key === 'W')\n      ) {\n        level.setTile(i, j, Tile.retrieve('D'))\n      }\n    }\n  }\n\n  return level\n}\n\nexport const addCreatures = function(\n  chance: number,\n  level: LevelMap,\n  creaturesPool: Pool<null, Creature>\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      if (level.at(i, j).passibleThrough() && Math.random() < chance) {\n        creaturesPool.pick(null).addToMap(new Point(i, j), level)\n      }\n    }\n  }\n\n  return level\n}\n\nexport const addItems = function(\n  chance: number,\n  level: LevelMap,\n  itemsPool: Pool<null, Item>\n): LevelMap {\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      const tile = level.at(i, j)\n      if (tile.passibleThrough() && Math.random() < chance) {\n        tile.addItem(itemsPool.pick(null), 1)\n      }\n    }\n  }\n\n  return level\n}\n\nexport const centralize = function(level: LevelMap): LevelMap {\n  let minX = level.width,\n    minY = level.height,\n    maxX = 0,\n    maxY = 0\n\n  for (let j = 1; j < level.height - 1; j++) {\n    for (let i = 1; i < level.width - 1; i++) {\n      if (!level.at(i, j).passibleThrough()) {\n        continue\n      }\n\n      maxY = Math.max(j, maxY)\n      maxX = Math.max(i, maxX)\n      minY = Math.min(j, minY)\n      minX = Math.min(i, minX)\n    }\n  }\n\n  const dx = Math.floor((level.width - (maxX - minX)) / 2) - minX,\n    dy = Math.floor((level.height - (maxY - minY)) / 2) - minY\n\n  cycle(level.map, dx)\n  level.map.forEach(row => cycle(row, dy))\n\n  return level\n}\n\nexport const addOnTile = function(\n  level: LevelMap,\n  match: (tile: Tile) => boolean,\n  onValid: (x: number, y: number) => void\n): LevelMap {\n  let iters = level.width * level.height\n\n  while (iters > 0) {\n    const x = random(0, level.width - 1),\n      y = random(0, level.height - 1)\n\n    if (match(level.at(x, y))) {\n      onValid(x, y)\n      return level\n    }\n\n    iters--\n  }\n\n  throw 'post add failed to add tile'\n}\n\nexport const connectMaps = function(map1: LevelMap, map2: LevelMap) {\n  addOnTile(\n    map1,\n    tile => tile.isFloor() && tile.passibleThrough(),\n    (dx, dy) => {\n      let downTile\n\n      addOnTile(\n        map2,\n        tile => tile.isFloor() && tile.passibleThrough(),\n        (ux, uy) => {\n          const upTile = new StairwayUp(map2, map1, new Point(dx, dy))\n          map2.setTile(ux, uy, upTile)\n\n          downTile = new StairwayDown(map1, map2, new Point(ux, uy))\n        }\n      )\n\n      map1.setTile(dx, dy, downTile)\n    }\n  )\n}\n","import { twoDimArray } from '../utils'\nimport { LevelMap, Tile } from '../../engine'\n\nexport default function(drawMap: string[]): LevelMap {\n  return new LevelMap(\n    twoDimArray(drawMap[0].length, drawMap.length, (x, y) =>\n      Tile.retrieve(drawMap[y].charAt(x))\n    )\n  )\n}\n","import { Rect, Point, rand, min, twoDimArray } from '../utils'\nimport { LevelMap, Tile } from '../../engine'\n\nconst THICKNESS = 0\n\nconst newRoomSpace = function(): Tile {\n  return Tile.retrieve('R')\n}\n\nconst newCorridor = function(): Tile {\n  return Tile.retrieve('C')\n}\n\nconst newWall = function(): Tile {\n  return Tile.retrieve('W')\n}\n\ntype Stage = Tile[][]\n\nconst RAY_TURNS = 60\nconst DELTA_ANGLE = Math.PI / (RAY_TURNS * 2)\n\nclass Room extends Rect {\n  notCross(rect: Rect): boolean {\n    return (\n      rect.x - THICKNESS > this.x + this.w ||\n      rect.y - THICKNESS > this.y + this.h ||\n      rect.x + rect.w < this.x - THICKNESS ||\n      rect.y + rect.h < this.y - THICKNESS\n    )\n  }\n\n  pointWithin(): Point {\n    return new Point(\n      this.x + 1 + rand(this.w - 1),\n      this.y + 1 + rand(this.h - 1)\n    )\n  }\n\n  add(stage: Stage): void {\n    let i: number = 0\n    while (i < this.w) {\n      let j: number = 0\n      while (j < this.h) {\n        stage[this.x + i][this.y + j] = newRoomSpace()\n        j++\n      }\n\n      i++\n    }\n  }\n}\n\nclass Road extends Rect {\n  lined: boolean\n\n  constructor(x: number, y: number, w: number, h: number) {\n    super(x, y, w, h)\n    this.lined = (x >= w && y >= h) || (w >= x && h >= y)\n  }\n\n  add(stage: Stage): void {\n    let [hx, hy, w] = this.horizontalLine()\n\n    let i = 0\n    while (i < w) {\n      if (stage[hx + i][hy].key === 'W') {\n        stage[hx + i][hy] = newCorridor()\n      }\n      i += 1\n    }\n\n    let [vx, vy, h] = this.verticalLine()\n    let j = 0\n    while (j < h) {\n      if (stage[vx][vy + j].key === 'W') {\n        stage[vx][vy + j] = newCorridor()\n      }\n      j += 1\n    }\n  }\n\n  horizontalLine(): [number, number, number] {\n    // x\n    // |\\\n    // .-x\n    if (this.lined)\n      return [\n        Math.min(this.x, this.w),\n        Math.max(this.y, this.h),\n        Math.abs(this.w - this.x),\n      ]\n    // .-x\n    // |/\n    // x\n    else\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.w - this.x),\n      ]\n  }\n\n  verticalLine(): [number, number, number] {\n    // x\n    // |\\\n    // .-x\n    if (this.lined)\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.h - this.y),\n      ]\n    // .-x\n    // |/\n    // x\n    else\n      return [\n        Math.min(this.x, this.w),\n        Math.min(this.y, this.h),\n        Math.abs(this.h - this.y),\n      ]\n  }\n}\n\nclass DungeonGenerator {\n  rooms: Array<Room>\n  roads: Array<Road>\n\n  constructor(\n    protected maxX: number,\n    protected maxY: number,\n    private minSize: number,\n    private maxSize: number,\n    private roomsCount: number\n  ) {\n    let rooms: Room[] = new Array(this.roomsCount)\n      .fill(undefined)\n      .map(_ => this.generateRoom())\n\n    this.rooms = this.normalize(this.ray(rooms))\n    this.roads = this.buildRoads(this.rooms)\n  }\n\n  private generateRoom(): Room {\n    return new Room(\n      0,\n      0,\n      this.minSize + rand(this.maxSize - this.minSize),\n      this.minSize + rand(this.maxSize - this.minSize)\n    )\n  }\n\n  // Takes a room and tries to put it on a ray coming from (0, 0)\n  // until the room finds empty place for it.\n  private ray(rooms: Room[]): Room[] {\n    return rooms.reduce((pickedRooms: Room[], currentRoom: Room) => {\n      for (\n        let i = 0, angle = (rand(360) / 180) * Math.PI;\n        i < RAY_TURNS;\n        angle += DELTA_ANGLE, i++\n      ) {\n        // TODO: Build table with these values.\n        const cos: number = Math.cos(angle)\n        const sin: number = Math.sin(angle)\n        let l: number = 1\n        let dx: number = 0\n        let dy: number = 0\n\n        let roomToMove = new Room(\n          currentRoom.x,\n          currentRoom.y,\n          currentRoom.w,\n          currentRoom.h\n        )\n\n        while (Math.abs(dx) < this.maxX / 2 && Math.abs(dy) < this.maxY / 2) {\n          let ndx = Math.round(l * cos)\n          let ndy = Math.round(l * sin)\n\n          while (ndx === dx && ndy === dy) {\n            l += 1\n            ndx = Math.round(l * cos)\n            ndy = Math.round(l * sin)\n          }\n\n          roomToMove.move(ndx - dx, ndy - dy)\n          dx = ndx\n          dy = ndy\n\n          if (pickedRooms.every(room => roomToMove.notCross(room))) {\n            pickedRooms.push(roomToMove)\n            return pickedRooms\n          }\n        }\n      }\n\n      return pickedRooms\n    }, [])\n  }\n\n  private normalize(rooms: Room[]): Room[] {\n    const minX = min(rooms.map(room => room.x)) - 1\n    rooms.forEach(room => {\n      room.move(-minX, 0)\n    })\n    rooms = rooms.filter((room: Room) => room.x + room.w < this.maxX)\n\n    const minY = min(rooms.map(room => room.y)) - 1\n    rooms.forEach(room => {\n      room.move(0, -minY)\n    })\n    return rooms.filter((room: Room) => room.y + room.h < this.maxY)\n  }\n\n  private buildRoads(rooms: Room[]): Road[] {\n    let points: Point[] = rooms.map(room => {\n      return room.pointWithin()\n    })\n\n    let connectedPoints: Point[] = [points.shift()]\n    let roads: Road[] = []\n\n    const distance = function(point1: Point, point2: Point): number {\n      // No need to calc square root since it's being used for comparison only.\n      return (point1.x - point2.x) ** 2 + (point1.y - point2.y) ** 2\n    }\n\n    while (points.length) {\n      let currentPoint = points.shift()\n\n      let pointToConnect = connectedPoints[0]\n      let minDistance = distance(currentPoint, pointToConnect)\n\n      connectedPoints.forEach(point => {\n        const currentDistance = distance(point, currentPoint)\n        if (currentDistance < minDistance) {\n          pointToConnect = point\n          minDistance = currentDistance\n        }\n      })\n\n      connectedPoints.push(currentPoint)\n\n      roads.push(\n        new Road(\n          currentPoint.x,\n          currentPoint.y,\n          pointToConnect.x,\n          pointToConnect.y\n        )\n      )\n    }\n\n    return roads\n  }\n}\n\nexport default function(\n  dimX: number,\n  dimY: number,\n  minSize: number,\n  maxSize: number,\n  roomsCount: number\n): LevelMap {\n  // TODO: Validate min or max size is lower than map's sizes\n  const dungeon = new DungeonGenerator(dimX, dimY, minSize, maxSize, roomsCount)\n\n  let stage = twoDimArray(dimX, dimY, newWall)\n\n  for (let i = 0; i < dungeon.rooms.length; i++) dungeon.rooms[i].add(stage)\n\n  for (let i = 0; i < dungeon.roads.length; i++) dungeon.roads[i].add(stage)\n\n  return new LevelMap(stage)\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  AIMoveEvent,\n  Direction,\n  AIHandleEnvEvent,\n  AIPickUpItemsDialog,\n  DropItemsScreen,\n  DrinkScreen,\n  BagScreen,\n  AIMissileDialog,\n} from '../../engine'\nimport { InventoryScreen } from './inventory_screen'\n\nexport enum IdleInputKey {\n  Right,\n  Left,\n  Down,\n  Up,\n\n  UpRight,\n  UpLeft,\n  DownRight,\n  DownLeft,\n\n  Handle,\n  Missile,\n\n  Inventory,\n  Bag,\n  PickUp,\n  Drop,\n  Drink,\n}\n\nexport class IdleScreen extends Screen {\n  constructor(game: Game) {\n    super(ScreenType.Idle, game)\n  }\n\n  public onInput(key: IdleInputKey) {\n    // TODO: Shouldn't be done here, move to every command\n    this.game.screen = undefined\n\n    switch (key) {\n      case IdleInputKey.Right:\n        return new AIMoveEvent(Direction.right, this.game).act()\n      case IdleInputKey.Left:\n        return new AIMoveEvent(Direction.left, this.game).act()\n      case IdleInputKey.Down:\n        return new AIMoveEvent(Direction.down, this.game).act()\n      case IdleInputKey.Up:\n        return new AIMoveEvent(Direction.up, this.game).act()\n\n      case IdleInputKey.UpRight:\n        return new AIMoveEvent(Direction.upRight, this.game).act()\n      case IdleInputKey.UpLeft:\n        return new AIMoveEvent(Direction.upLeft, this.game).act()\n      case IdleInputKey.DownRight:\n        return new AIMoveEvent(Direction.downRight, this.game).act()\n      case IdleInputKey.DownLeft:\n        return new AIMoveEvent(Direction.downLeft, this.game).act()\n\n      case IdleInputKey.Handle:\n        return new AIHandleEnvEvent(this.game).act()\n\n      case IdleInputKey.PickUp:\n        return new AIPickUpItemsDialog(this.game).act()\n      case IdleInputKey.Missile:\n        return new AIMissileDialog(this.game).act()\n\n      case IdleInputKey.Drop:\n        this.game.screen = new DropItemsScreen(this.game)\n        return\n      case IdleInputKey.Drink:\n        this.game.screen = new DrinkScreen(this.game)\n        return\n      case IdleInputKey.Inventory:\n        this.game.screen = new InventoryScreen(this.game)\n        return\n      case IdleInputKey.Bag:\n        this.game.screen = new BagScreen(this.game)\n        return\n    }\n  }\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  AITakeOffItem,\n  Item,\n  InventorySlot,\n  GroupedItem,\n  PutOnItemsScreen,\n} from '../../engine'\nimport { IdleScreen } from './idle_screen'\n\nimport { intersection } from 'lodash'\n\ninterface InventoryPosition {\n  inventorySlot: InventorySlot\n  item: Item\n  count: number\n  availableItems: GroupedItem[]\n}\n\nexport class InventoryScreen extends Screen {\n  public positions: InventoryPosition[] = []\n\n  constructor(game: Game) {\n    super(ScreenType.Inventory, game)\n\n    const cares = this.player.inventory.cares()\n\n    this.positions = this.player.inventory\n      .wears()\n      .map(({ inventorySlot, equipment }) => {\n        return {\n          inventorySlot: inventorySlot,\n          item: equipment && equipment.item,\n          count: equipment && equipment.count,\n          availableItems: cares.filter(groupedItem =>\n            intersection(groupedItem.item.usages, inventorySlot.usages).length > 0\n          ),\n        }\n      })\n  }\n\n  public takeOff(position: InventoryPosition) {\n    new AITakeOffItem(position.inventorySlot, this.game).act()\n    this.game.screen = null\n  }\n\n  public putOn(position: InventoryPosition) {\n    this.game.screen = new PutOnItemsScreen(\n      position.inventorySlot,\n      position.availableItems,\n      this.game\n    )\n  }\n\n  public close() {\n    this.game.screen = new IdleScreen(this.game)\n  }\n}\n","import { Screen, ScreenType } from './internal'\nimport { Game } from '../game'\nimport { Point, bresenham, bresenhamInclusion, Direction } from '../utils'\nimport { Memory } from '../memory';\nimport { IdleScreen } from './idle_screen';\nimport { AIMissileAttack } from '../../engine';\n\nexport class MissileScreen extends Screen {\n  public targetPos: Point\n  private memory: Memory\n  private targetEnemyIndex: number = undefined\n  private enemies: Point[] = []\n\n  constructor(game: Game) {\n    super(ScreenType.Missile, game)\n\n    this.findEnemies()\n    this.memory = this.player.stageMemory()\n    this.resetTargetId()\n  }\n\n  public nextTarget(): void {\n    if (this.targetEnemyIndex === undefined) {\n      return this.resetTargetId()\n    }\n\n    this.targetEnemyIndex += 1\n\n    if (this.targetEnemyIndex >= this.enemies.length) {\n      this.targetEnemyIndex = 0\n    }\n\n    this.updateTarget(this.enemies[this.targetEnemyIndex])\n  }\n\n  public previousTarget(): void {\n    if (this.targetEnemyIndex === undefined) {\n      return this.resetTargetId()\n    }\n\n    this.targetEnemyIndex -= 1\n\n    if (this.targetEnemyIndex < 0) {\n      this.targetEnemyIndex = this.enemies.length - 1\n    }\n\n    this.updateTarget(this.enemies[this.targetEnemyIndex])\n  }\n\n  public moveTarget(direction: Direction): void {\n    const stage = this.player.currentLevel,\n      dest = this.targetPos.add(direction),\n      tile = stage.at(dest.x, dest.y)\n\n    if (tile.visibleThrough()) {\n      this.updateTarget(dest)\n      this.targetEnemyIndex = undefined\n    }\n  }\n\n  public attack(): void {\n    // TODO: Check the path exists\n    new AIMissileAttack(this.targetPos, this.game).act()\n  }\n\n  public close(): void {\n    this.resetPath()\n    this.game.screen = new IdleScreen(this.game)\n  }\n\n  private resetTargetId(): void {\n    if (this.enemies.length) {\n      this.targetEnemyIndex = 0\n      this.updateTarget(this.enemies[this.targetEnemyIndex])\n    } else {\n      this.targetEnemyIndex = undefined\n      this.updateTarget(this.player.pos)\n    }\n  }\n\n  private resetPath(): void {\n    if (!this.targetPos) {\n      return\n    }\n\n    bresenhamInclusion(this.player.pos, this.targetPos, (x, y) => {\n      this.memory.at(x, y).effect = undefined\n    })\n  }\n\n  private drawPath(): void {\n    bresenhamInclusion(this.player.pos, this.targetPos, (x, y) => {\n      this.memory.at(x, y).effect = 'x'\n    })\n  }\n\n  private updateTarget(newPos: Point): void {\n    this.resetPath()\n    this.targetPos = newPos.copy()\n    this.drawPath()\n  }\n\n  private findEnemies(): void {\n    this.enemies = []\n\n    this.player.stageMemory().each((tile, x, y) => {\n      if (tile.visible && tile.creature() && tile.creature().id !== this.player.id) {\n        this.enemies.push(new Point(x, y))\n      }\n    })\n  }\n}\n","import { Logger } from '../logger';\nimport { Player, AttackEvent, ThrowEvent, Reaction, Creature } from '../creature';\nimport { Game } from '../game';\nimport { Tile, StairwayDown, StairwayUp } from '../tile';\nimport { Direction, Point, bresenham } from '../utils';\nimport { IdleScreen, PickUpScreen, GroupedItem, InventorySlot, Potion, Item, ItemFlightEffect, MissileSlot } from '../../engine';\nimport { MissileScreen } from '../screens/missile_screen';\n\nexport abstract class Controller {\n  protected logger: Logger\n  protected player: Player\n\n  constructor(protected game: Game) {\n    this.player = game.player\n    this.logger = game.logger\n  }\n\n  public abstract act(): void\n\n  protected tile(): Tile {\n    return this.player.currentLevel.at(this.player.pos.x, this.player.pos.y)\n  }\n}\n\nexport class AIMoveEvent extends Controller {\n  constructor(public direction: Direction, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    const stage = this.player.currentLevel,\n      dest = this.player.pos.add(this.direction),\n      tile = stage.at(dest.x, dest.y)\n\n    if (tile.passibleThrough(this.player)) {\n      this.player.move(dest)\n    } else if (tile.creature) {\n      tile.creature.real().on(new AttackEvent(this.player))\n    } else {\n      this.game.logger.ranIntoAnObstacle()\n    }\n  }\n}\n\nexport class AIHandleEnvEvent extends Controller {\n  public act(): void {\n    const tile = this.tile()\n\n    if (tile instanceof StairwayDown || tile instanceof StairwayUp) {\n      tile.go(this.player)\n    } else {\n      this.player.currentLevel.game.logger.howToHandle()\n    }\n  }\n}\n\nexport class AIPickUpItemsDialog extends Controller {\n  public act(): void {\n    const items = this.tile().items,\n      game = this.player.currentLevel.game\n\n    switch ((items && items.bunch.length) || 0) {\n      case 0:\n        game.logger.noItemsToPickUp()\n        game.screen = new IdleScreen(this.game)\n        return\n      case 1:\n        new AIPickUpItems(items.bunch, this.game).act()\n        return\n      default:\n        game.screen = new PickUpScreen(game)\n        return\n    }\n  }\n}\n\nexport class AIPickUpItems extends Controller {\n  constructor(private items: GroupedItem[], game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    if (!this.items.length) {\n      this.game.screen = new IdleScreen(this.game)\n    }\n\n    let tileItems = this.tile().items\n\n    this.items.forEach(({ item, count }) => {\n      this.player.inventory.putToBag(item, count)\n      this.game.logger.pickedUpItem(item, count)\n      tileItems.remove(item, count)\n    })\n\n    this.game.screen = undefined\n  }\n}\n\nexport class AIDropItems extends Controller {\n  constructor(private items: GroupedItem[], game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    if (!this.items.length) {\n      this.game.screen = new IdleScreen(this.game)\n    }\n\n    let tile = this.tile()\n\n    this.items.forEach(({ item, count }) => {\n      this.player.inventory.removeFromBag(item, count)\n      this.game.logger.droppedItem(item, count)\n      tile.addItem(item, count)\n    })\n\n    this.game.screen = undefined\n  }\n}\n\nexport class AITakeOffItem extends Controller {\n  constructor(private slot: InventorySlot, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    // TODO: assert slot is not empty\n    const groupedItem = this.player.inventory.inSlot(this.slot)\n    this.player.inventory.takeOff(this.player, this.slot)\n    this.logger.takeOff(groupedItem.item)\n  }\n}\n\nexport class AIPutOnItem extends Controller {\n  constructor(private slot: InventorySlot, private item: Item, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    this.player.inventory.equip(this.player, this.slot, this.item)\n    this.logger.putOn(this.item)\n  }\n}\n\nexport class AIDrinkItem extends Controller {\n  constructor(private potion: Potion, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    this.player.inventory.removeFromBag(this.potion, 1)\n    this.potion.onDrink(this.game)\n    this.logger.drink(this.potion)\n  }\n}\n\nexport class AIMissileDialog extends Controller {\n  public act(): void {\n    this.game.screen = new MissileScreen(this.game)\n  }\n}\n\nexport class AIMissileAttack extends Controller {\n  constructor(private targetPos: Point, game: Game) {\n    super(game)\n  }\n\n  public act(): void {\n    let path = []\n\n    bresenham(this.player.pos, this.targetPos, (x, y) => path.push(new Point(x, y)))\n\n    const missile = this.player.inventory.inSlot(MissileSlot).item\n    this.player.inventory.removeWearing(this.player, MissileSlot, 1)\n\n    const tile = this.player.currentLevel.at(this.targetPos.x, this.targetPos.y)\n    // TODO: Remove real link\n    let victim: Creature = tile.creature && tile.creature.real()\n    const effect = new ItemFlightEffect(missile, path, () => {\n      if (victim) {\n        victim.on(new ThrowEvent(this.player, missile))\n      }\n    })\n\n    this.player.currentLevel.addEffect(effect)\n    this.game.screen = undefined\n  }\n}\n","import { Screen, ScreenType } from './internal'\nimport {\n  Game,\n  Item,\n  AIPickUpItems,\n  AIDropItems,\n  AIPutOnItem,\n  AIDrinkItem,\n} from '../../engine'\nimport { IdleScreen } from './idle_screen'\nimport { GroupedItem, ItemGroup, Potion } from '../items/internal'\nimport { InventoryScreen } from './inventory_screen'\nimport { InventorySlot } from '../inventory'\n\ninterface ItemsListingPosition {\n  item: Item\n  count: number\n}\n\nabstract class ItemsListingScreen extends Screen {\n  public positions: ItemsListingPosition[]\n  public title: string\n\n  constructor(game: Game) {\n    super(ScreenType.ItemsListing, game)\n    this.initPositions()\n  }\n\n  protected abstract initPositions()\n\n  public close(): void {\n    this.game.screen = new IdleScreen(this.game)\n  }\n}\n\nexport class PickUpScreen extends ItemsListingScreen {\n  public title: string = 'What to pick up?'\n\n  protected initPositions(): void {\n    const items = this.player.currentLevel.at(\n      this.player.pos.x,\n      this.player.pos.y\n    ).items\n    this.positions = items.bunch.map(itemGroup => {\n      return { item: itemGroup.item, count: itemGroup.count }\n    })\n  }\n\n  public pickUpItems(items: GroupedItem[]): void {\n    // TODO: Validate items are part of positions\n    new AIPickUpItems(items, this.game).act()\n  }\n}\n\nexport class DropItemsScreen extends ItemsListingScreen {\n  public title: string = 'What to drop?'\n\n  protected initPositions(): void {\n    this.positions = this.player.inventory.cares()\n  }\n\n  public pickUpItems(items: GroupedItem[]): void {\n    // TODO: Validate items are part of positions\n    new AIDropItems(items, this.game).act()\n  }\n}\n\nexport class PutOnItemsScreen extends ItemsListingScreen {\n  public title: string = 'What to put on?'\n  public singleItemMode: boolean = true\n\n  constructor(\n    protected inventorySlot: InventorySlot,\n    public positions: ItemsListingPosition[],\n    game: Game\n  ) {\n    super(game)\n  }\n\n  protected initPositions(): void {}\n\n  public pickUpItems(items: ItemsListingPosition[]): void {\n    // TODO: Validate items are part of positions\n    // new AIDropItems(items, this.game).act()\n  }\n\n  public withItem(itemGroup: ItemsListingPosition): void {\n    new AIPutOnItem(this.inventorySlot, itemGroup.item, this.game).act()\n    this.game.screen = undefined\n  }\n\n  public close(): void {\n    this.game.screen = new InventoryScreen(this.game)\n  }\n}\n\nexport class DrinkScreen extends ItemsListingScreen {\n  public title: string = ' ?'\n  public singleItemMode: boolean = true\n\n  protected initPositions(): void {\n    this.positions = this.player.inventory\n      .cares()\n      .filter(itemGroup => itemGroup.item.group === ItemGroup.Potion)\n  }\n\n  public pickUpItems(items: ItemsListingPosition[]): void {\n    // TODO: Remove this method or ensure it's not being called\n  }\n\n  public withItem(itemGroup: { item: Potion }): void {\n    new AIDrinkItem(itemGroup.item, this.game).act()\n    this.game.screen = undefined\n  }\n}\n\nexport class BagScreen extends ItemsListingScreen {\n  public title: string = ''\n  public singleItemMode: boolean = true\n\n  protected initPositions(): void {\n    this.positions = this.player.inventory.cares()\n  }\n\n  public pickUpItems(items: ItemsListingPosition[]): void {\n    // TODO: Remove this method or ensure it's not being called\n  }\n\n  public withItem(itemGroup: { item: Potion }): void {\n    this.game.screen = undefined\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { takeRight } from 'lodash'\n\nimport { LogLevel } from '../src/engine'\n\nimport * as moment from 'moment'\n\nexport default Vue.extend({\n  name: 'Logger',\n  props: ['logger'],\n  computed: {\n    messages() {\n      return takeRight(this.logger.messages, 5)\n    }\n  },\n  methods: {\n    ts(record) {\n      return moment(record.ts).format(\"hh:mm:ss\")\n    },\n    rowClass(record) {\n      switch (record.level) {\n        case LogLevel.DEBUG:\n          return 'table-secondary'\n        case LogLevel.INFO:\n          return 'table-info'\n        case LogLevel.WARNING:\n          return 'table-warning'\n        case LogLevel.DANGER:\n          return 'table-danger'\n      }\n    }\n  }\n})\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Logger.vue?vue&type=template&id=3e0edcb8\"\nimport script from \"./Logger.vue?vue&type=script&lang=ts\"\nexport * from \"./Logger.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Logger.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"container\",staticClass:\"logger\"},[_c('table',{staticClass:\"table table-sm table-striped\"},[_c('tbody',_vm._l((_vm.messages),function(record,i){return _c('tr',{key:i,class:_vm.rowClass(record)},[_c('td',[_vm._v(_vm._s(_vm.ts(record)))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(record.message))])])}))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./stats.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./stats.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nimport {\n  Patrol,\n  Explorer,\n  Waiter,\n  Chaser,\n  Escaper,\n  Loiter,\n  Dispatcher,\n  Picker,\n  SelfHealer,\n  Attacker,\n  Thrower,\n} from '../src/engine'\n\nexport default Vue.extend({\n  name: 'Stats',\n  props: ['creature'],\n  computed: {\n  },\n  methods: {\n    aiName(ai) {\n      if (ai instanceof Patrol) {\n        return 'Patrol'\n      }\n      if (ai instanceof Escaper) {\n        return 'Escaper'\n      }\n      if (ai instanceof Chaser) {\n        return 'Chaser'\n      }\n      if (ai instanceof Explorer) {\n        return 'Explorer'\n      }\n      if (ai instanceof Waiter) {\n        return 'Waiter'\n      }\n      if (ai instanceof Loiter) {\n        return `Loiter`\n      }\n      if (ai instanceof Dispatcher) {\n        return `Dispatcher (${this.aiName(ai.aiToRun)})`\n      }\n      if (ai instanceof Attacker) {\n        return `Attacker`\n      }\n      if (ai instanceof SelfHealer) {\n        return `SelfHealer`\n      }\n      if (ai instanceof Picker) {\n        return 'Picker'\n      }\n      if (ai instanceof Thrower) {\n        return 'Thrower'\n      }\n    },\n    displayAttribute(attribute) {\n      if (attribute.currentValue() != attribute.maximum()) {\n        return `${attribute.currentValue()} [${attribute.maximum()}]`\n      } else {\n        return attribute.currentValue()\n      }\n    },\n    displayAttributeWithModifiers(attribute) {\n      if (attribute.currentValue() != attribute.maximum()) {\n        const mods = attribute.modifiers.map(x => x > 0 ? `+ ${x}` : `- ${x}`).join(' ')\n        return `${attribute.currentValue()} = [${attribute.maximum()}] ${mods}`\n      } else {\n        return attribute.currentValue()\n      }\n    }\n  }\n})\n","import { AI } from './internal'\nimport { Creature } from '../creature'\n\nexport class Waiter extends AI {\n  act(actor: Creature): void {}\n\n  public available(actor: Creature): boolean {\n    return true\n  }\n}\n","import { render, staticRenderFns } from \"./stats.vue?vue&type=template&id=d9087414\"\nimport script from \"./stats.vue?vue&type=script&lang=ts\"\nexport * from \"./stats.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('dl',{staticClass:\"row small\"},[_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    ID\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.id)+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    POS\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.pos)+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    Level\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.creature.level.current)+\" [\"+_vm._s(_vm.creature.level.currentExperience)+\" - \"+_vm._s(_vm.creature.level.requiredExperience)+\"]\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttribute(_vm.creature.characteristics.health))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.attack))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.defense))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.displayAttributeWithModifiers(_vm.creature.characteristics.speed))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    AI\\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_vm._v(\"\\n    \"+_vm._s(_vm.aiName(_vm.creature.ai))+\"\\n  \")]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n     \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_c('ul',_vm._l((_vm.creature.inventory.cares()),function(invItem){return _c('li',{key:invItem.id},[_vm._v(\"\\n          \"+_vm._s(invItem.item.name)+\" \"+_vm._s(invItem.count === 1 ? '' : (\": \" + (invItem.count)))+\"\\n      \")])}))]),_vm._v(\" \"),_c('dd',{staticClass:\"col-sm-4\"},[_vm._v(\"\\n    \\n  \")]),_vm._v(\" \"),_c('dt',{staticClass:\"col-sm-8\"},[_c('ul',_vm._l((_vm.creature.professions),function(profession){return _c('li',{key:profession.name},[_vm._v(\"\\n          \"+_vm._s(profession.name)+\" \"+_vm._s(profession.level)+\"\\n      \")])}))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/// This file contains the main tile engine namespace.\n/// All coordinates are assumed to be integers - behaviour is undefined\n/// if you feed in floats (or anything other) as x and y (or similar) parameters.\n\n/// Class: Tile\n/// Represents a unicode character tile with various attributes.\nexport class Tile {\n  /// Constructor: Tile\n  /// Constructs a new Tile object.\n  ///\n  /// Parameters:\n  ///   ch - a character to display for this tile\n  ///   r - (optional) red foregorund color component 0-255\n  ///   g - (optional) green foreground color component 0-255\n  ///   b - (optional) blue foreground color component 0-255\n  ///   br - (optional) red background color component 0-255\n  ///   bg - (optional) green background color component 0-255\n  ///   bb - (optional) blue background color component 0-255\n  constructor(\n    public ch: string,\n    public r?: number,\n    public g?: number,\n    public b?: number,\n    public br?: number,\n    public bg?: number,\n    public bb?: number,\n  ) {}\n\n  /// Function: getChar\n  /// Returns the character of this tile.\n  public getChar() { return this.ch }\n\n  /// Function: setChar\n  /// Sets the character of this tile.\n  public setChar(ch: string) { this.ch = ch }\n\n  /// Function: setColor\n  /// Sets the foreground color of this tile.\n  public setColor(r: number, g: number, b: number) {\n    this.r = r\n    this.g = g\n    this.b = b\n  }\n\n  /// Function: setGrey\n  /// Sets the foreground color to the given shade (0-255) of grey.\n  public setGrey(grey: number) {\n    this.r = grey\n    this.g = grey\n    this.b = grey\n  }\n\n  /// Function: setBackground\n  /// Sets the background color of this tile.\n  public setBackground(r: number, g: number, b: number) {\n    this.br = r\n    this.bg = g\n    this.bb = b\n  }\n\n  public backgroundToColor() {\n    this.r = this.br\n    this.g = this.bg\n    this.b = this.bb\n  }\n\n  public swapColors() {\n    this.r = [this.br, this.br = this.r][0]\n    this.g = [this.bg, this.bg = this.g][0]\n    this.b = [this.bb, this.bb = this.b][0]\n  }\n\n  /// Function: resetColor\n  /// Clears the color of this tile / assigns default color.\n  public resetColor() { this.r = this.g = this.b = undefined }\n\n  /// Function: resetBackground\n  /// Clears the background color of this tile.\n  public resetBackground() { this.br = this.bg = this.bb = undefined }\n\n  /// Function: getColorHex\n  /// Returns the hexadecimal representation of the color\n  public getColorHex() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return '#' + this.r.toString(16) + this.g.toString(16) + this.b.toString(16)\n    else return ''\n  }\n\n  /// Function: getBackgroundHex\n  /// Returns the hexadecimal representation of the background color\n  public getBackgroundHex() {\n    if (this.br !== undefined && this.bg !== undefined && this.bb !== undefined)\n      return '#' + this.br.toString(16) + this.bg.toString(16) + this.bb.toString(16)\n    else return ''\n  }\n\n  /// Function: getColorRGB\n  /// Returns the CSS rgb(r,g,b) representation of the color\n  public getColorRGB() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return `rgb(${this.r},${this.g},${this.b})`\n    else return ''\n  }\n\n  /// Function: getBackgroundRGB\n  /// Returns the CSS rgb(r,g,b) representation of the background color\n  public getBackgroundRGB() {\n    if (this.br !== undefined && this.bg !== undefined && this.bb !== undefined)\n      return `rgb(${this.br},${this.bg},${this.bb})`\n    else return ''\n  }\n\n  /// Function: getColorJSON\n  /// Returns the JSON representation of the color, i.e. object { r, g, b }\n  public getColorJSON() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return { 'r': this.r, 'g': this.g, 'b': this.b }\n    else return {}\n  }\n\n  /// Function: getBackgroundJSON\n  /// Returns the JSON representation of the background color, i.e. object { r, g, b }\n  public getBackgroundJSON() {\n    if (this.r !== undefined && this.g !== undefined && this.b !== undefined)\n      return { 'r': this.br, 'g': this.bg, 'b': this.bb }\n    else return {}\n  }\n\n  /// Function: copy\n  /// Makes this tile identical to the one supplied. Custom properties are not copied.\n  public copy(other: Tile) {\n    this.ch = other.ch\n    this.r = other.r\n    this.g = other.g\n    this.b = other.b\n    this.br = other.br\n    this.bg = other.bg\n    this.bb = other.bb\n  }\n\n  /// Function: clone\n  /// Returns a new copy of this tile. Custom properties are not cloned.\n  public clone() {\n    return new Tile(this.ch, this.r, this.g, this.b, this.br, this.bg, this.bb)\n  }\n}\n\n/// Constants: Semi-internal constants for ut namespace\n/// VERSION  - Version of the library as string.\n/// NULLCHAR - Character used when none is specified otherwise.\n/// CSSCLASS - The CSS class name used for the tile engine element.\n/// NULLTILE - The tile used as placeholder for empty tile.\nexport const VERSION = '2.1'\nexport const NULLCHAR = ' '\nexport const CSSCLASS = 'unicodetiles'\nexport const NULLTILE = new Tile(NULLCHAR)\n\nexport interface Renderer {\n  updateStyle(s?: any): void\n\n    // if (this.renderer instanceof ut.WebGLRenderer) return ''\n    // if (this.renderer instanceof ut.CanvasRenderer) return 'canvas'\n    // if (this.renderer instanceof ut.DOMRenderer) return 'dom'\n  getRendererString(): string\n\n  clear(): void\n  render(): void\n}\n\n/// Class: Viewport\n/// The tile engine viewport / window. Takes care of initializing a proper renderer.\n\n/// Constructor: Viewport\n/// Constructs a new Viewport object.\n/// If you wish to display a player character at the center, you should use odd sizes.\n///\n/// Parameters:\n///   elem - the DOM element which shall be transformed into the tile engine\n///   w - (integer) width in tiles\n///   h - (integer) height in tiles\n///   renderer - (optional) choose rendering engine, see <Viewport.setRenderer>, defaults to 'auto'.\n///   squarify - (optional) set to true to force the tiles square; may break some box drawing\nexport class Viewport {\n  public cx: number\n  public cy: number\n\n  public buffer: Tile[][]\n  public renderer: Renderer\n\n  public defaultColor?: string\n  public defaultBackground?: string\n\n  constructor(\n    public elem: HTMLElement,\n    public w: number,\n    public h: number,\n    renderer: (viewport: Viewport) => Renderer,\n    public squarify: boolean = false,\n    ) {\n    this.cx = Math.floor(w / 2)\n    this.cy = Math.floor(h / 2)\n\n    this.elem.innerHTML = ''\n\n    // Add CSS class if not added already\n    if (elem.className.indexOf(CSSCLASS) === -1) {\n      if (elem.className.length === 0) {\n        elem.className = CSSCLASS\n      }\n      else elem.className += ' ' + CSSCLASS\n    }\n\n    // Create two 2-dimensional array to hold the viewport tiles\n    this.buffer = new Array(h)\n    for (let j = 0; j < h; ++j) {\n      this.buffer[j] = new Array(w)\n      for (let i = 0; i < w; ++i) {\n        this.buffer[j][i] = NULLTILE\n      }\n    }\n\n    this.renderer = renderer(this)\n  }\n\n  /// Function: updateStyle\n  /// If the style of the parent element is modified, this needs to be called.\n  private updateStyle(updateRenderer: boolean) {\n    const s = window.getComputedStyle(this.elem, null)\n\n    this.defaultColor = s.color || undefined // OMG\n    this.defaultBackground = s.backgroundColor || undefined\n    if (updateRenderer) {\n      this.renderer.updateStyle(s)\n    }\n  };\n\n  /// Function: getRendererString\n  /// Gets the currently used renderer.\n  ///\n  /// Returns:\n  ///   One of 'webgl', 'canvas', 'dom', ''.\n  public getRendererString(): string {\n    return this.renderer.getRendererString()\n  }\n\n  /// Function: put\n  /// Puts a tile to the given coordinates.\n  /// Checks bounds and does nothing if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   tile - the tile to put\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  public put(tile: Tile, x: number, y: number): void {\n    if (x < 0 || y < 0 || x >= this.w || y >= this.h) return\n    this.buffer[y][x] = tile\n  }\n\n  /// Function: unsafePut\n  /// Puts a tile to the given coordinates.\n  /// Does *not* check bounds throws exception if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   tile - the tile to put\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  public unsafePut(tile: Tile, x: number, y: number) {\n    this.buffer[y][x] = tile\n  }\n\n  /// Function: putString\n  /// Creates a row of tiles with the chars of the given string.\n  /// Wraps to next line if it can't fit the chars on one line.\n  ///\n  /// Parameters:\n  ///   str - (string) the string to put\n  ///   x - (integer) x coordinate (column)\n  ///   y - (integer) y coordinate (row)\n  ///   r - (optional) red foregorund color component 0-255\n  ///   g - (optional) green foreground color component 0-255\n  ///   b - (optional) blue foreground color component 0-255\n  ///   br - (optional) red background color component 0-255\n  ///   bg - (optional) green background color component 0-255\n  ///   bb - (optional) blue background color component 0-255\n  public putString(\n    str: string,\n    x: number,\n    y: number,\n    r?: number,\n    g?: number,\n    b?: number,\n    br?: number,\n    bg?: number,\n    bb?: number,\n  ) {\n    const len = str.length\n    if (x < 0 || y < 0) return\n\n    for (let i = 0; i < len; ++i) {\n      if (x >= this.w) {\n        x = 0\n        ++y\n      }\n      if (y >= this.h) return\n\n      const tile = new Tile(str[i], r, g, b, br, bg, bb)\n      this.unsafePut(tile, x, y)\n      ++x\n    }\n  }\n\n  /// Function: get\n  /// Returns the tile in the given coordinates.\n  /// Checks bounds and returns empty tile if invalid coordinates are given.\n  ///\n  /// Parameters:\n  ///   x - (integer) x coordinate\n  ///   y - (integer) y coordinate\n  ///\n  /// Returns:\n  ///   The tile.\n  public get(x: number, y: number): Tile {\n    if (x < 0 || y < 0 || x >= this.w || y >= this.h) return NULLTILE\n    return this.buffer[y][x]\n  }\n\n  /// Function: clear\n  /// Clears the viewport buffer by assigning empty tiles.\n  public clear() {\n    for (let j = 0; j < this.h; ++j) {\n      for (let i = 0; i < this.w; ++i) {\n        this.buffer[j][i] = NULLTILE\n      }\n    }\n    this.renderer.clear()\n  }\n\n  /// Function: render\n  /// Renders the buffer as html to the element specified at construction.\n  public render() {\n    this.renderer.render()\n  }\n}\n\n/// Class: Engine\n/// The tile engine itself.\nexport class Engine {\n  private refreshCache: boolean = true\n  private cacheEnabled: boolean = false\n  private transitionTimer?: number\n\n  private transitionDuration: number = 0\n  private transition?: (x: number, y: number, w: number, h: number, new_t: Tile, old_t: Tile, factor: number) => Tile\n  private maskFunc?: (x: number, y: number) => boolean\n  private shaderFunc?: (tile: Tile, x: number, y: number, timeNow: number) => Tile\n  private cachex: number = 0\n  private cachey: number = 0\n\n  private tileCache: Tile[][]\n  private tileCache2: Tile[][]\n\n  /// Constructor: Engine\n  /// Constructs a new Engine object. If width or height is given,\n  /// it will not attempt to fetch tiles outside the boundaries.\n  /// In that case 0,0 is assumed as the upper-left corner of the world,\n  /// but if no width/height is given also negative coords are valid.\n  ///\n  /// Parameters:\n  ///   vp - the <Viewport> instance to use as the viewport\n  ///   func - the function used for fetching tiles\n  ///   w - (integer) (optional) world width in tiles\n  ///   h - (integer) (optional) world height in tiles\n  constructor(\n    public viewport: Viewport,\n    public tileFunc: (x: number, y: number) => Tile,\n    public w: number,\n    public h: number,\n  ) {\n\n    this.tileCache = new Array(viewport.h)\n    this.tileCache2 = new Array(viewport.h)\n\n    for (let j = 0; j < viewport.h; ++j) {\n      this.tileCache[j] = new Array(viewport.w)\n      this.tileCache2[j] = new Array(viewport.w)\n    }\n  }\n\n  /// Function: setTileFunc\n  /// Sets the function to be called with coordinates to fetch each tile.\n  /// Optionally can apply a transition effect. Effects are:\n  /// 'boxin', 'boxout', 'circlein', 'circleout', 'random'\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (x, y) and returning an ut.Tile\n  ///   effect - (string) (optional) name of effect to use (see above for legal values)\n  ///   duration - (integer) (optional) how many milliseconds the transition effect should last\n  public setTileFunc(func: (x: number, y: number) => Tile, effect?: string, duration?: number) {\n    if (effect) {\n      this.transition = undefined\n      if (typeof effect === 'string') {\n        if (effect === 'boxin') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          if (Math.abs(x) < halfw * factor && Math.abs(y) < halfh * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'boxout') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          factor = 1.0 - factor\n          if (Math.abs(x) < halfw * factor && Math.abs(y) < halfh * factor) return old_t\n          else return new_t\n        }\n        else if (effect === 'circlein') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          if (x * x + y * y < (halfw * halfw + halfh * halfh) * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'circleout') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          const halfw = w * 0.5, halfh = h * 0.5\n          x -= halfw\n          y -= halfh\n          factor = 1.0 - factor\n          if (x * x + y * y > (halfw * halfw + halfh * halfh) * factor) return new_t\n          else return old_t\n        }\n        else if (effect === 'random') this.transition = function(x, y, w, h, new_t, old_t, factor) {\n          if (Math.random() > factor) return old_t\n          else return new_t\n        }\n      }\n      if (this.transition) {\n        this.transitionTimer = (new Date()).getTime()\n        this.transitionDuration = duration || 500\n      }\n    }\n    this.tileFunc = func\n  }\n\n  /// Function: setMaskFunc\n  /// Sets the function to be called to fetch mask information according to coordinates.\n  /// If mask function returns false to some coordinates, then that tile is not rendered.\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (x, y) and returning a true if the tile is visible\n  public setMaskFunc(func: (x: number, y: number) => boolean) { this.maskFunc = func }\n\n  /// Function: setShaderFunc\n  /// Sets the function to be called to post-process / shade each visible tile.\n  /// Shader function is called even if caching is enabled, see <Engine.setCacheEnabled>.\n  ///\n  /// Parameters:\n  ///   func - function taking parameters (tile, x, y) and returning an ut.Tile\n  public setShaderFunc(func: (tile: Tile, x: number, y: number) => Tile) { this.shaderFunc = func }\n\n  /// Function: setWorldSize\n  /// Tiles outside of the range x = [0,width[ y = [0,height[ are not fetched.\n  /// Set to undefined in order to make the world infinite.\n  ///\n  /// Parameters:\n  ///   width - (integer) new world width\n  ///   height - (integer) new world height\n  public setWorldSize(width: number, height: number) {\n    this.w = width\n    this.h = height\n  }\n\n  /// Function: setCacheEnabled\n  /// Enables or disables the usage of tile cache. This means that\n  /// extra measures are taken to not call the tile function unnecessarily.\n  /// This means that all animating must be done in a shader function,\n  /// see <Engine.setShaderFunc>.\n  /// Cache is off by default, but should be enabled if the tile function\n  /// does more computation than a simple array look-up.\n  ///\n  /// Parameters:\n  ///   mode - true to enable, false to disable\n  public setCacheEnabled(mode: boolean) {\n    this.cacheEnabled = mode\n    this.refreshCache = true\n  }\n\n  /// Function: update\n  /// Updates the viewport according to the given player coordinates.\n  /// The algorithm goes as follows:\n  ///   * Record the current time\n  ///   * For each viewport tile:\n  ///   * Check if the tile is visible by testing the mask\n  ///   * If not visible, continue to the next tile in the viewport\n  ///   * Otherwise, if cache is enabled try to fetch the tile from there\n  ///   * Otherwise, call the tile function and check for shader function presence\n  ///   * If there is shader function, apply it to the tile, passing the recorded time\n  ///   * Put the tile to viewport\n  ///\n  /// Parameters:\n  ///   x - (integer) viewport center x coordinate in the tile world\n  ///   y - (integer) viewport center y coordinate in the tile world\n  public update(x?: number, y?: number) {\n    x = x || 0\n    y = y || 0\n\n    // World coords of upper left corner of the viewport\n    const xx = x - this.viewport.cx\n    const yy = y - this.viewport.cy\n    const timeNow = (new Date()).getTime() // For passing to shaderFunc\n    let transTime\n    if (this.transition && this.transitionTimer) transTime = (timeNow - this.transitionTimer) / this.transitionDuration\n    if (transTime && transTime >= 1.0) this.transition = undefined\n\n    let tile: Tile\n\n    // For each tile in viewport...\n    for (let j = 0; j < this.viewport.h; ++j) {\n      for (let i = 0; i < this.viewport.w; ++i) {\n        const ixx = i + xx, jyy = j + yy\n        // Check horizontal bounds if requested\n        if (this.w && (ixx < 0 || ixx >= this.w)) {\n          tile = NULLTILE\n        // Check vertical bounds if requested\n        } else if (this.h && (jyy < 0 || jyy >= this.h)) {\n          tile = NULLTILE\n        // Check mask\n        } else if (this.maskFunc && !this.maskFunc(ixx, jyy)) {\n          tile = NULLTILE\n        // Check transition effect\n        } else if (this.transition && !this.refreshCache) {\n          tile = this.transition(\n            i,\n            j,\n            this.viewport.w,\n            this.viewport.h,\n            this.tileFunc(ixx, jyy),\n            this.tileCache[j][i],\n            transTime || 0\n          )\n        // Check cache\n        } else if (this.cacheEnabled && !this.refreshCache) {\n          const lookupx = ixx - this.cachex\n          const lookupy = jyy - this.cachey\n          if (lookupx >= 0 && lookupx < this.viewport.w && lookupy >= 0 && lookupy < this.viewport.h) {\n            tile = this.tileCache[lookupy][lookupx]\n            if (tile === NULLTILE) tile = this.tileFunc(ixx, jyy)\n          } else // Cache miss\n            tile = this.tileFunc(ixx, jyy)\n        // If all else fails, call tileFunc\n        } else tile = this.tileFunc(ixx, jyy)\n        // Save the tile to cache (always due to transition effects)\n        this.tileCache2[j][i] = tile\n        // Apply shader function\n        if (this.shaderFunc && tile !== NULLTILE)\n          tile = this.shaderFunc(tile, ixx, jyy, timeNow)\n        // Put shaded tile to viewport\n        this.viewport.unsafePut(tile, i, j)\n      }\n    }\n    // Cache stuff is enabled always, because it is also required by transitions\n    // Save the new cache origin\n    this.cachex = xx\n    this.cachey = yy\n\n    // Swap cache buffers\n    const tempCache = this.tileCache\n    this.tileCache = this.tileCache2\n    this.tileCache2 = tempCache\n    this.refreshCache = false\n  }\n}\n","import { Renderer, Viewport } from './unicodetiles'\n\n/// Class: CanvasRenderer\n/// Renders the <Viewport> into an HTML5 <canvas> element.\n///\n/// *Note:* This is an internal class used by <Viewport>\nclass CanvasRenderer implements Renderer {\n  private canvas: HTMLCanvasElement\n  private offscreen: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n  private ctx2: CanvasRenderingContext2D\n\n  private th?: number\n  private tw?: number\n  private gap?: number\n\n  constructor(private view: Viewport) {\n    this.canvas = document.createElement('canvas')\n    if (!this.canvas.getContext) throw('Canvas not supported')\n    this.ctx2 = this.canvas.getContext('2d')\n    if (!this.ctx2 || !this.ctx2.fillText) throw('Canvas not supported')\n    view.elem.appendChild(this.canvas)\n\n    // Create an offscreen canvas for rendering\n    this.offscreen = document.createElement('canvas')\n    this.ctx = this.offscreen.getContext('2d')\n    this.updateStyle()\n    this.canvas.width = (view.squarify ? this.th : this.tw) * view.w\n    this.canvas.height = this.th * view.h\n    this.offscreen.width = this.canvas.width\n    this.offscreen.height = this.canvas.height\n    // Doing this again since setting canvas w/h resets the state\n    this.updateStyle()\n  }\n\n  public getRendererString(): string { return 'canvas' }\n\n  public updateStyle(s?: any) {\n    s = s || window.getComputedStyle(this.view.elem, null)\n    this.ctx.font = `${s.fontSize}/${s.lineHeight} ${s.fontFamily}`\n    this.ctx.textBaseline = 'middle'\n    this.tw = this.ctx.measureText('M').width\n    this.th = parseInt(s.fontSize, 10)\n    this.gap = this.view.squarify ? (this.th - this.tw) : 0\n    if (this.view.squarify) this.tw = this.th\n  }\n\n  public clear() { /* No op */ }\n\n  public render() {\n    let tile, ch, fg, bg, x, y\n    const view = this.view,\n          buffer = this.view.buffer,\n          w = view.w, h = view.h,\n          hth = 0.5 * this.th,\n          hgap = 0.5 * this.gap // Squarification\n\n    // Clearing with one big rect is much faster than with individual char rects\n    this.ctx.fillStyle = view.defaultBackground\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height)\n    y = hth // half because textBaseline is middle\n    for (let j = 0; j < h; ++j) {\n      x = 0\n      for (let i = 0; i < w; ++i) {\n        tile = buffer[j][i]\n        ch = tile.ch\n        fg = tile.getColorRGB()\n        bg = tile.getBackgroundRGB()\n        // Only render background if the color is non-default\n        if (bg.length && bg !== view.defaultBackground) {\n          this.ctx.fillStyle = bg\n          this.ctx.fillRect(x, y - hth, this.tw, this.th)\n        }\n        // Do not attempt to render empty char\n        if (ch.length) {\n          if (!fg.length) fg = view.defaultColor\n          this.ctx.fillStyle = fg\n          this.ctx.fillText(ch, x + hgap, y)\n        }\n        x += this.tw\n      }\n      y += this.th\n    }\n    this.ctx2.drawImage(this.offscreen, 0, 0)\n  }\n}\n\nexport const canvasRenderer = function(viewport: Viewport): Renderer {\n  return new CanvasRenderer(viewport)\n}\n","import { Renderer, Viewport } from './unicodetiles'\n\nconst VERTEX_SHADER = `\nattribute vec2 position;\nattribute vec2 texCoord;\nattribute vec3 color;\nattribute vec3 bgColor;\nattribute float charIndex;\nuniform vec2 uResolution;\nuniform vec2 uTileCounts;\nuniform vec2 uPadding;\nvarying vec2 vTexCoord;\nvarying vec3 vColor;\nvarying vec3 vBgColor;\n\nvoid main() {\n  vec2 tileCoords = floor(vec2(mod(charIndex, uTileCounts.x), charIndex / uTileCounts.x));\n  vTexCoord = (texCoord + tileCoords) / uTileCounts;\n  vTexCoord += (0.5 - texCoord) * uPadding;\n  vColor = color;\n  vBgColor = bgColor;\n  vec2 pos = position / uResolution * 2.0 - 1.0;\n  gl_Position = vec4(pos.x, -pos.y, 0.0, 1.0);\n}\n`\n\nconst FRAGMENT_SHADER = `\nprecision mediump float;\nuniform sampler2D uFont;\nvarying vec2 vTexCoord;\nvarying vec3 vColor;\nvarying vec3 vBgColor;\n\nvoid main() {\n  vec4 color = texture2D(uFont, vTexCoord);\n  color.rgb = mix(vBgColor, vColor, color.rgb);\n  gl_FragColor = color;\n}\n`\n\n/// Class: WebGLRenderer\n/// Renders the <Viewport> with WebGL.\n/// Given decent GPU drivers and browser support, this is the fastest renderer.\n///\n/// *Note:* This is an internal class used by <Viewport>\nclass WebGLRenderer implements Renderer {\n  private canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n  private offscreen: HTMLCanvasElement\n\n  public gl: WebGLRenderingContext\n\n  private charMap: any\n  private charArray: any\n  private defaultColors: any\n  private attribs: any\n\n  private th?: number\n  private tw?: number\n  private gap?: number\n  private pad?: number\n\n  private tileCountsLocation: WebGLUniformLocation\n  private paddingLocation: WebGLUniformLocation\n\n  constructor(private view: Viewport) {\n    this.view = view\n    this.canvas = document.createElement('canvas')\n    // Try to fetch the context\n    if (!this.canvas.getContext) throw('Canvas not supported')\n    this.gl = this.canvas.getContext('experimental-webgl')\n    if (!this.gl) throw('WebGL not supported')\n    view.elem.appendChild(this.canvas)\n\n    this.charMap = {}\n    this.charArray = []\n    this.defaultColors = { r: 1.0, g: 1.0, b: 1.0, br: 0.0, bg: 0.0, bb: 0.0 }\n\n    this.attribs = {\n      position:  { buffer: null, data: null, itemSize: 2, location: null, hint: this.gl.STATIC_DRAW },\n      texCoord:  { buffer: null, data: null, itemSize: 2, location: null, hint: this.gl.STATIC_DRAW },\n      color:     { buffer: null, data: null, itemSize: 3, location: null, hint: this.gl.DYNAMIC_DRAW },\n      bgColor:   { buffer: null, data: null, itemSize: 3, location: null, hint: this.gl.DYNAMIC_DRAW },\n      charIndex: { buffer: null, data: null, itemSize: 1, location: null, hint: this.gl.DYNAMIC_DRAW }\n    }\n\n\n    // Create an offscreen canvas for rendering text to texture\n    if (!this.offscreen)\n      this.offscreen = document.createElement('canvas')\n    this.offscreen.style.position = 'absolute'\n    this.offscreen.style.top = '0px'\n    this.offscreen.style.left = '0px'\n    this.ctx = this.offscreen.getContext('2d')\n    if (!this.ctx) throw 'Failed to acquire offscreen canvas drawing context'\n    // WebGL drawing canvas\n    this.updateStyle()\n    this.canvas.width = (view.squarify ? this.th : this.tw) * view.w\n    this.canvas.height = this.th * view.h\n    this.offscreen.width = 0\n    this.offscreen.height = 0\n    // Doing this again since setting canvas w/h resets the state\n    this.updateStyle()\n\n    this.gl.viewport(0, 0, this.canvas.width, this.canvas.height)\n\n    let vertexShader = this.compileShader(this.gl.VERTEX_SHADER, VERTEX_SHADER)\n    let fragmentShader = this.compileShader(this.gl.FRAGMENT_SHADER, FRAGMENT_SHADER)\n    let program = this.gl.createProgram()\n    this.gl.attachShader(program, vertexShader)\n    this.gl.attachShader(program, fragmentShader)\n    this.gl.linkProgram(program)\n    this.gl.deleteShader(vertexShader)\n    this.gl.deleteShader(fragmentShader)\n    const ok = this.gl.getProgramParameter(program, this.gl.LINK_STATUS)\n    if (!ok) {\n      const msg = `Error linking program: ${this.gl.getProgramInfoLog(program)}`\n      this.gl.deleteProgram(program)\n      throw msg\n    }\n    this.gl.useProgram(program)\n\n    // Get attribute locations\n    this.attribs.position.location  = this.gl.getAttribLocation(program, 'position')\n    this.attribs.texCoord.location  = this.gl.getAttribLocation(program, 'texCoord')\n    this.attribs.color.location     = this.gl.getAttribLocation(program, 'color')\n    this.attribs.bgColor.location   = this.gl.getAttribLocation(program, 'bgColor')\n    this.attribs.charIndex.location = this.gl.getAttribLocation(program, 'charIndex')\n\n    // Setup buffers and uniforms\n    this.initBuffers()\n    let resolutionLocation = this.gl.getUniformLocation(program, 'uResolution')\n    this.gl.uniform2f(resolutionLocation, this.canvas.width, this.canvas.height)\n    this.tileCountsLocation = this.gl.getUniformLocation(program, 'uTileCounts')\n    this.gl.uniform2f(this.tileCountsLocation, this.view.w, this.view.h)\n    this.paddingLocation = this.gl.getUniformLocation(program, 'uPadding')\n    this.gl.uniform2f(this.paddingLocation, 0.0, 0.0)\n\n    // Setup texture\n    // view.elem.appendChild(this.offscreen) // Debug offscreen\n    let texture = this.gl.createTexture()\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture)\n    this.cacheChars(` !\\\"#$%&'()*+,-./0123456789:<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_\\`abcdefghijklmnopqrstuvwxyz{|}~`)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE)\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE)\n    this.gl.activeTexture(this.gl.TEXTURE0)\n\n    setTimeout(() => {\n      this.updateStyle()\n      this.buildTexture()\n      this.render()\n    }, 100)\n  }\n\n  public getRendererString(): string { return 'webgl' }\n\n  private buildTexture() {\n    let w = this.offscreen.width / (this.tw + this.pad),\n          h = this.offscreen.height / (this.th + this.pad)\n    // Check if need to resize the canvas\n    const charCount = this.charArray.length\n    if (charCount > Math.floor(w) * Math.floor(h)) {\n      w = Math.ceil(Math.sqrt(charCount))\n      h = w + 2 // Allocate some extra space too\n      this.offscreen.width = w * (this.tw + this.pad)\n      this.offscreen.height = h * (this.th + this.pad)\n      this.updateStyle()\n      this.gl.uniform2f(this.tileCountsLocation, w, h)\n    }\n    this.gl.uniform2f(this.paddingLocation, this.pad / this.offscreen.width, this.pad / this.offscreen.height)\n\n    let c = 0, ch: string\n    this.ctx.fillStyle = '#000000'\n    this.ctx.fillRect(0, 0, this.offscreen.width, this.offscreen.height)\n    this.ctx.fillStyle = '#ffffff'\n\n    const halfGap = 0.5 * this.gap // Squarification\n    const tw = this.tw + this.pad,\n          th = this.th + this.pad\n    let y = 0.5 * th // Half because textBaseline is middle\n    for (let j = 0; j < h; ++j) {\n      let x = this.pad * 0.5\n      for (let i = 0; i < w; ++i, ++c) {\n        ch = this.charArray[c]\n        if (ch === undefined) break\n        this.ctx.fillText(ch, x + halfGap, y)\n        x += tw\n      }\n      if (!ch) break\n      y += th\n    }\n    this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.offscreen)\n  }\n\n  private cacheChars(chars: string, build: boolean = true) {\n    if (!this.gl) return // Nothing to do if not using WebGL renderer\n    let changed = false\n    for (let i = 0; i < chars.length; ++i) {\n      if (!this.charMap[chars[i]]) {\n        changed = true\n        this.charArray.push(chars[i])\n        this.charMap[chars[i]] = this.charArray.length - 1\n      }\n    }\n\n    if (changed && build) this.buildTexture()\n  }\n\n  public updateStyle(s?: any) {\n    s = s || window.getComputedStyle(this.view.elem, null)\n    this.ctx.font = s.fontSize + '/' + s.lineHeight + ' ' + s.fontFamily\n    this.ctx.textBaseline = 'middle'\n    this.ctx.fillStyle = '#ffffff'\n    this.tw = this.ctx.measureText('').width // TODO: Make a parameter\n    this.th = parseInt(s.fontSize, 10)\n    this.gap = this.view.squarify ? (this.th - this.tw) : 0\n    if (this.view.squarify) this.tw = this.th\n    this.pad = Math.ceil(this.th * 0.2) * 2.0 // Must be even number\n\n    const color = s.color.match(/\\d+/g)\n    const bgColor = s.backgroundColor.match(/\\d+/g)\n    this.defaultColors.r = parseInt(color[0], 10) / 255\n    this.defaultColors.g = parseInt(color[1], 10) / 255\n    this.defaultColors.b = parseInt(color[2], 10) / 255\n    this.defaultColors.br = parseInt(bgColor[0], 10) / 255\n    this.defaultColors.bg = parseInt(bgColor[1], 10) / 255\n    this.defaultColors.bb = parseInt(bgColor[2], 10) / 255\n  }\n\n  public clear() { /* No op */ }\n\n  public render() {\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT)\n    const w = this.view.w,\n      h = this.view.h\n\n    // Create new tile data\n    let tiles = this.view.buffer\n    let defaultColor = this.view.defaultColor\n    let defaultBgColor = this.view.defaultBackground\n    let newChars = false\n\n    for (let j = 0; j < h; ++j) {\n      for (let i = 0; i < w; ++i) {\n        const tile = tiles[j][i]\n        let ch = this.charMap[tile.ch]\n        if (ch === undefined) { // Auto-cache new characters\n          this.cacheChars(tile.ch, false)\n          newChars = true\n          ch = this.charMap[tile.ch]\n        }\n        const k = this.attribs.color.itemSize * 6 * (j * w + i)\n        const kk = this.attribs.charIndex.itemSize * 6 * (j * w + i)\n        const r = tile.r === undefined ? this.defaultColors.r : tile.r / 255\n        const g = tile.g === undefined ? this.defaultColors.g : tile.g / 255\n        const b = tile.b === undefined ? this.defaultColors.b : tile.b / 255\n        const br = tile.br === undefined ? this.defaultColors.br : tile.br / 255\n        const bg = tile.bg === undefined ? this.defaultColors.bg : tile.bg / 255\n        const bb = tile.bb === undefined ? this.defaultColors.bb : tile.bb / 255\n        for (let m = 0; m < 6; ++m) {\n          const n = k + m * this.attribs.color.itemSize\n          this.attribs.color.data[n + 0] = r\n          this.attribs.color.data[n + 1] = g\n          this.attribs.color.data[n + 2] = b\n          this.attribs.bgColor.data[n + 0] = br\n          this.attribs.bgColor.data[n + 1] = bg\n          this.attribs.bgColor.data[n + 2] = bb\n          this.attribs.charIndex.data[kk + m] = ch\n        }\n      }\n    }\n\n    // Upload\n    if (newChars) this.buildTexture()\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.color.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.color.data, this.attribs.color.hint)\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.bgColor.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.bgColor.data, this.attribs.bgColor.hint)\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.attribs.charIndex.buffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.attribs.charIndex.data, this.attribs.charIndex.hint)\n\n    const attrib = this.attribs.position\n    this.gl.drawArrays(this.gl.TRIANGLES, 0, attrib.data.length / attrib.itemSize)\n  }\n\n  // Setup GLSL\n  private compileShader(type: number, source: string) {\n    const shader = this.gl.createShader(type)\n    this.gl.shaderSource(shader, source)\n    this.gl.compileShader(shader)\n    const ok = this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)\n    if (!ok) {\n      const msg = 'Error compiling shader: ' + this.gl.getShaderInfoLog(shader)\n      this.gl.deleteShader(shader)\n      throw msg\n    }\n    return shader\n  }\n\n  private initBuffers() {\n    let a, attrib, attribs = this.attribs\n\n    const w = this.view.w,\n          h = this.view.h\n\n    // Allocate data arrays\n    for (a in this.attribs) {\n      attrib = attribs[a]\n      attrib.data = new Float32Array(attrib.itemSize * 6 * w * h)\n    }\n    // Generate static data\n    for (let j = 0; j < h; ++j) {\n      for (let i = 0; i < w; ++i) {\n        // Position & texCoords\n        const k = attribs.position.itemSize * 6 * (j * w + i)\n        this.insertQuad(attribs.position.data, k, i * this.tw, j * this.th, this.tw, this.th)\n        this.insertQuad(attribs.texCoord.data, k, 0.0, 0.0, 1.0, 1.0)\n      }\n    }\n    // Upload\n    for (a in this.attribs) {\n      attrib = attribs[a]\n      if (attrib.buffer) this.gl.deleteBuffer(attrib.buffer)\n      attrib.buffer = this.gl.createBuffer()\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, attrib.buffer)\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, attrib.data, attrib.hint)\n      this.gl.enableVertexAttribArray(attrib.location)\n      this.gl.vertexAttribPointer(attrib.location, attrib.itemSize, this.gl.FLOAT, false, 0, 0)\n    }\n  }\n\n  private insertQuad(arr: number[], i: number, x: number, y: number, w: number, h: number) {\n    const x1 = x,\n          y1 = y,\n          x2 = x + w,\n          y2 = y + h\n\n    arr[  i] = x1\n    arr[++i] = y1\n    arr[++i] = x2\n    arr[++i] = y1\n    arr[++i] = x1\n    arr[++i] = y2\n    arr[++i] = x1\n    arr[++i] = y2\n    arr[++i] = x2\n    arr[++i] = y1\n    arr[++i] = x2\n    arr[++i] = y2\n  }\n}\n\nexport const webGLRenderer = function(viewport: Viewport): Renderer {\n  return new WebGLRenderer(viewport)\n}\n","import { Tile } from '../vendor/unicodetiles.ts/src/index'\n\nimport {\n  Item,\n  ItemGroup,\n} from '../src/engine'\n\nconst DEFAULT_GREY: number = 120\nconst IMPORTANT_GREY: number = 180\nconst DEFAULT_LIT = { r: 255, g: 165, b: 0 }\n\nexport class DisplayTile extends Tile {\n  public lighted(degree: number): Tile {\n    return this\n  }\n\n  constructor(char: string, r = DEFAULT_GREY, g = DEFAULT_GREY, b = DEFAULT_GREY) {\n    super(char, r, g, b)\n  }\n\n  protected litBackground(tile: Tile, degree: number): Tile {\n    tile.setBackground(\n      DEFAULT_LIT.r * degree,\n      DEFAULT_LIT.g * degree,\n      DEFAULT_LIT.b * degree,\n    )\n    return tile\n  }\n\n  protected litColor(tile: Tile, degree: number): Tile {\n    tile.setColor(\n      DEFAULT_LIT.r * degree,\n      DEFAULT_LIT.g * degree,\n      DEFAULT_LIT.b * degree,\n    )\n    return tile\n  }\n}\n\nabstract class ImportantTile extends DisplayTile {\n  constructor(char: string) {\n    super(char, IMPORTANT_GREY, IMPORTANT_GREY, IMPORTANT_GREY)\n  }\n}\n\nexport class CreatureTile extends ImportantTile {\n  constructor(\n    char: string,\n    public vr: number,\n    public vg: number,\n    public vb: number,\n  ) {\n    super(char)\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    tile.setColor(this.vr, this.vg, this.vb)\n\n    return tile\n  }\n}\n\nexport class DoorTile extends DisplayTile {\n  constructor() {\n    super('')\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    this.litColor(tile, degree)\n    tile.swapColors()\n\n    return tile\n  }\n}\n\nexport class FloorTile extends DisplayTile {\n  constructor() {\n    super('')\n  }\n\n  public lighted(degree: number) {\n    return this.litColor(this.clone(), degree)\n  }\n}\n\nexport class WallTile extends DisplayTile {\n  constructor() {\n    super('')\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    this.litBackground(tile, degree)\n    tile.backgroundToColor()\n\n    return tile\n  }\n}\n\nexport class StairwayDown extends DisplayTile {\n  constructor() {\n    super('')\n  }\n}\n\nexport class StairwayUp extends DisplayTile {\n  constructor() {\n    super('')\n  }\n}\n\nexport class ItemTile extends DisplayTile {\n  constructor(\n    char: string,\n    public vr: number,\n    public vg: number,\n    public vb: number,\n  ) {\n    super(char)\n  }\n\n  public lighted(degree: number) {\n    let tile = this.clone()\n    tile.setColor(this.vr, this.vg, this.vb)\n\n    return tile\n  }\n}\n\nconst WEAPON = new ItemTile('', 200, 200, 200)\nconst CORPSE = new ItemTile('', 200, 200, 200)\nconst BODY_ARMOR = new ItemTile('', 200, 200, 200)\nconst MISSILE = new ItemTile('', 200, 200, 200)\n\nconst POTION = new ItemTile('', 200, 200, 200)\n\nexport const displayItem = function(item: Item): ItemTile {\n  switch (item.group) {\n    case ItemGroup.OneHandWeapon:\n      return WEAPON\n    case ItemGroup.Consumable:\n      return CORPSE\n    case ItemGroup.BodyArmor:\n      return BODY_ARMOR\n    case ItemGroup.Missile:\n      return MISSILE\n    case ItemGroup.Potion:\n      return POTION\n    default:\n      throw `Unknown group ${item} with type ${item.group}`\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport Stats from './stats.vue'\n\nimport {\n  domRenderer,\n  canvasRenderer,\n  webGLRenderer,\n  Engine,\n  Viewport,\n  Tile,\n} from '../vendor/unicodetiles.ts/src/index'\n\nimport {\n  CreatureTile,\n  DoorTile,\n  FloorTile,\n  ItemTile,\n  WallTile,\n  StairwayUp,\n  StairwayDown,\n  DisplayTile,\n\n  displayItem,\n} from './scene_tiles'\n\nconst HUMAN  = new CreatureTile('', 0, 255, 0)\nconst HUMAN2 = new CreatureTile('', 255, 0, 0)\nconst HUMAN3 = new CreatureTile('', 0, 0, 255)\nconst HUMAN4 = new CreatureTile('', 255, 0, 255)\nconst HUMAN5 = new CreatureTile('', 0, 255, 255)\n\nconst RAT = new CreatureTile('', 197, 65, 38)\n\nconst DOOR = new DoorTile()\nconst WALL = new WallTile()\nconst FLOOR = new FloorTile()\nconst STAIRWAY_DOWN = new StairwayDown()\nconst STAIRWAY_UP = new StairwayUp()\nconst NULLTILE = new DisplayTile('', 0, 0, 0)\n\nconst nextItemAnimation = [\n  new ItemTile('', 200, 200, 200),\n  new ItemTile('', 200, 200, 200),\n  new ItemTile('', 200, 200, 200),\n  new ItemTile('', 200, 200, 200),\n]\n\nexport default Vue.extend({\n  props: ['level', 'player'],\n  data() {\n    return {\n      wholeMap: false,\n      term: null,\n      eng: null,\n      drawInterval: null,\n      ts: Date.now(),\n      fps: 0,\n      counter: 0,\n      interval: 100,\n      step: 0,\n    }\n  },\n  components: {\n    Stats\n  },\n  methods: {\n    getTile(x, y) {\n      const effect = this.stage.at(x, y).effect\n      const tile = this.wholeMap ? this.stage.at(x, y) : this.stage.at(x, y).tile\n\n      if (!tile) {\n        return NULLTILE\n      }\n\n      if (effect) {\n        if (tile.creature) {\n          let displayTile = this.creatureTile(tile.creature).clone()\n          displayTile.setBackground(200, 0, 0)\n          return displayTile\n        } else {\n          return new DisplayTile(effect, 200, 200, 0)\n        }\n      }\n\n      if (tile.creature) {\n        return this.creatureTile(tile.creature)\n      }\n\n      if (tile.items) {\n        switch (tile.items.bunch.length) {\n        case 0:\n          break;\n        case 1:\n          return displayItem(tile.items.bunch[0].item)\n        default:\n          const frame = this.step % (this.animationFps * 3 + 4)\n          if (frame < nextItemAnimation.length) {\n            return nextItemAnimation[frame]\n          } else {\n            const itemId = Math.floor(this.step / (this.animationFps * 3 + 4))\n\n            return displayItem(tile.items.bunch[itemId % tile.items.bunch.length].item)\n          }\n        }\n      }\n\n      switch (tile.display) {\n      case '#':\n        return WALL\n      case '+':\n        return DOOR\n      case ' ':\n        return FLOOR\n      case '<':\n        return STAIRWAY_UP\n      case '>':\n        return STAIRWAY_DOWN\n      default:\n        return NULLTILE\n      }\n    },\n    creatureTile(creature) {\n      if (creature.name() == 'Rat') {\n        return RAT\n      }\n\n      switch (creature.id % 5) {\n        case 0:\n          return HUMAN5\n        case 1:\n          return HUMAN4\n        case 2:\n          return HUMAN3\n        case 3:\n          return HUMAN2\n        case 4:\n          return HUMAN\n      }\n    },\n    initViewport() {\n      this.term = new Viewport(\n        this.$refs.scene,\n        this.level.width,\n        this.level.height,\n        webGLRenderer,\n        true,\n      )\n\n      this.eng = new Engine(\n        this.term,\n        (x, y) => this.getTile(x, y),\n        this.level.width,\n        this.level.height,\n      )\n\n      this.eng.setMaskFunc((x, y) => {\n        return this.wholeMap || this.stage.at(x, y).seen\n      });\n\n      this.eng.setShaderFunc((tile, x, y, time) => {\n        return this.lighting(tile, x, y, time)\n      })\n\n      clearInterval(this.drawInterval)\n      this.drawInterval = setInterval(() => { this.drawScene() }, this.interval)\n    },\n    drawScene() {\n      const ts = Date.now()\n      if (this.ts + 1000 < ts) {\n        this.fps = this.counter\n        this.counter = 0\n        this.ts = ts\n      }\n\n      // this.eng.update(this.player.x, this.player.y);\n      this.eng.update(this.term.cx, this.term.cy);\n      this.term.render();\n\n      this.counter += 1\n      this.step += 1\n    },\n    lighting(tile, x, y, time) {\n      if (this.wholeMap) {\n        return tile.lighted(1)\n      }\n      const fovTile = this.stage.at(x, y)\n\n      if (fovTile.visible && tile.lighted) {\n        return tile.lighted(fovTile.degree)\n      }\n\n      return tile\n    },\n  },\n  computed: {\n    stage() {\n      return this.wholeMap ? this.level : this.player.stageMemory(this.level.id)\n    },\n    animationFps() {\n      return 1000 / this.interval\n    },\n    tileItems() {\n      let items = this.stage.at(this.player.pos.x, this.player.pos.y).items()\n      return items && items.bunch\n    }\n  },\n  mounted() {\n    this.initViewport()\n  },\n  beforeDestroy() {\n    clearInterval(this.drawInterval)\n  },\n  watch: {\n    interval() {\n      this.initViewport()\n    }\n  }\n})\n","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./Scene.vue?vue&type=template&id=db63f82c\"\nimport script from \"./Scene.vue?vue&type=script&lang=ts\"\nexport * from \"./Scene.vue?vue&type=script&lang=ts\"\nimport style0 from \"./Scene.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"scene\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col mr-0\"},[_c('div',{ref:\"scene\",staticClass:\"unicodetiles\"})]),_vm._v(\" \"),_c('div',{staticClass:\"col pl-0\"},[_c('div',{staticClass:\"fps mb-2 \"},[_vm._v(\"FPS \"+_vm._s(_vm.fps))]),_vm._v(\" \"),_c('div',[_vm._v(\"\\n        MAP \"+_vm._s(_vm.level.id)+\"\\n        \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.wholeMap),expression:\"wholeMap\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.wholeMap)?_vm._i(_vm.wholeMap,null)>-1:(_vm.wholeMap)},on:{\"change\":function($event){var $$a=_vm.wholeMap,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.wholeMap=$$a.concat([$$v]))}else{$$i>-1&&(_vm.wholeMap=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.wholeMap=$$c}}}})]),_vm._v(\" \"),_c('Stats',{attrs:{\"creature\":_vm.player}}),_vm._v(\" \"),_c('ul',_vm._l((_vm.tileItems),function(group){return _c('li',{key:group.item.name},[_vm._v(\"\\n          \"+_vm._s(group.count)+\": \"+_vm._s(group.item.name)+\"\\n        \")])}))],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IdleScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./IdleScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\nimport Vue from 'vue'\nimport { IdleInputKey } from '../../src/engine'\n\nexport default Vue.extend({\n  name: 'IdleScreen',\n  props: ['screen'],\n  methods: {\n    close(inputKey) {\n      this.screen.onInput(inputKey)\n    },\n    onEvent(event) {\n      switch (event.key) {\n      case 'l':\n      case 'ArrowRight':\n        return this.close(IdleInputKey.Right)\n\n      case 'h':\n      case 'ArrowLeft':\n        return this.close(IdleInputKey.Left)\n\n      case 'k':\n      case 'ArrowUp':\n        return this.close(IdleInputKey.Up)\n\n      case 'j':\n      case 'ArrowDown':\n        return this.close(IdleInputKey.Down)\n\n      case 'y':\n        return this.close(IdleInputKey.UpLeft)\n      case 'u':\n        return this.close(IdleInputKey.UpRight)\n      case 'b':\n        return this.close(IdleInputKey.DownLeft)\n      case 'n':\n        return this.close(IdleInputKey.DownRight)\n\n      case 'H':\n        return this.close(IdleInputKey.Handle)\n\n      case 'i':\n        return this.close(IdleInputKey.Inventory)\n      case 'I':\n        return this.close(IdleInputKey.Bag)\n      case 't':\n        return this.close(IdleInputKey.Missile)\n      case ',':\n        return this.close(IdleInputKey.PickUp)\n      case 'd':\n        return this.close(IdleInputKey.Drop)\n      case 'D':\n        return this.close(IdleInputKey.Drink)\n      }\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./IdleScreen.vue?vue&type=template&id=242e1ebc\"\nimport script from \"./IdleScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./IdleScreen.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nexport default Vue.extend({\n  props: ['screen'],\n  data() {\n    return {\n      picked: null\n    }\n  },\n  methods: {\n    close(doubleClickOption) {\n      const option = doubleClickOption || this.picked\n      if (option) {\n        this.screen.onInput(option)\n      }\n    },\n    onEvent(event) {\n      switch(event.key) {\n      case 'a':\n        this.picked = this.screen.options[0]\n        break\n      case 'b':\n        this.picked = this.screen.options[1]\n        break\n      case ' ':\n      case 'Enter':\n        this.close()\n      default:\n        return\n      }\n    },\n    iconPath(professionId: number) {\n      return 'assets/professions/' + [\n        'acrobatic.svg',\n        'button-finger.svg',\n        'disintegrate.svg',\n        'flying-fox.svg',\n        'amputation.svg',\n        'catch.svg',\n        'divert.svg',\n        'fruiting.svg',\n        'annexation.svg',\n        'conversation.svg',\n        'dodging.svg',\n        'grab.svg',\n        'arrest.svg',\n        'convince.svg',\n        'drinking.svg',\n        'journey.svg',\n        'back-forth.svg',\n        'coronation.svg',\n        'drop-weapon.svg',\n        'juggler.svg',\n        'backstab.svg',\n        'crafting.svg',\n        'drowning.svg',\n        'jump-across.svg',\n        'boot-stomp.svg',\n        'crush.svg',\n        'eating.svg',\n        'kindle.svg',\n        'bowman.svg',\n        'discussion.svg',\n        'expander.svg',\n        'kneeling.svg',\n      ][professionId]\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./ProfessionPickingScreen.vue?vue&type=template&id=36229750\"\nimport script from \"./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./ProfessionPickingScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal text-center\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.screen.title))]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},_vm._l((_vm.screen.options),function(option){return _c('div',{key:option.id,staticClass:\"option p-2 m-3\",class:{ 'picked': _vm.picked && _vm.picked.id === option.id },on:{\"click\":function($event){_vm.picked = option},\"dblclick\":function($event){_vm.close(option)}}},[_c('img',{staticClass:\"icon\",attrs:{\"src\":_vm.iconPath(option.id)}}),_vm._v(\" \"),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(option.name))])])})),_vm._v(\" \"),_c('div',{staticClass:\"bottom\"},[(_vm.picked !== null)?_c('b-btn',{attrs:{\"variant\":\"success\"},on:{\"click\":_vm.close}},[_vm._v(\"\")]):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\n\nconst LETTER_OFFSET = 97\n\nexport default Vue.extend({\n  name: 'Inventory',\n  props: ['screen'],\n  data() {\n    return {\n      page: 0,\n      perPage: 20,\n      selected: [],\n    }\n  },\n  computed: {\n    player() {\n      return this.screen.player\n    }\n  },\n  methods: {\n    onEvent(event) {\n      switch (event.key) {\n      case 'Escape':\n        return this.screen.close()\n      case 'Enter':\n      case ' ':\n        return this.screen.pickUpItems(this.selected.map(index => this.screen.positions[index]))\n      default:\n        return this.selectAt(event.key.charCodeAt(0) - LETTER_OFFSET)\n      }\n    },\n    selectAt(i: number) {\n      if (i >= 0 && i < Math.min(this.perPage, this.screen.positions.length)) {\n        if (this.screen.singleItemMode) {\n          this.screen.withItem(this.screen.positions[i])\n        } else if (this.selected.indexOf(i) >= 0) {\n          this.selected.splice(this.selected.indexOf(i), 1)\n        } else {\n          this.selected.push(i)\n        }\n      }\n    },\n    indexLetter(i: number): string {\n      return String.fromCharCode(LETTER_OFFSET + i)\n    },\n    positionSelected(index) {\n      return this.selected.indexOf(index) >= 0\n    },\n    positionStatus(position) {\n      if (!position.item) {\n        return ''\n      } else {\n        return 'text-success'\n      }\n    }\n  }\n})\n","import { Talent, Game } from '../engine'\n\n// TODO: Validate all Talent's ids are uniq\nexport enum OnisunTalentId {\n  AttackerTwoHandedWeapons,\n  AttackerHeavyWeapons,\n  AttackerLightWeapons,\n  AttackerTwoWeapons,\n  AttackerDoubleTwoHandedWeapons,\n  AttackerStrongGrip,\n}\n\nexport abstract class OnisunTalent extends Talent {\n  constructor(\n    id: number,\n    name: string,\n    depth: number,\n    rank: number,\n    maxRank: number,\n    description: string = ''\n  ) {\n    super(id, name, depth, rank, maxRank, description)\n  }\n}\n\nexport class AttackerTwoHandedWeapons extends OnisunTalent {\n  constructor() {\n    super(OnisunTalentId.AttackerTwoHandedWeapons, ' ', 0, 0, 3)\n  }\n\n  public onObtain(game: Game): void {}\n}\n\nexport class AttackerLightWeapons extends OnisunTalent {\n  constructor() {\n    super(OnisunTalentId.AttackerLightWeapons, ' ', 0, 0, 3)\n  }\n\n  public onObtain(game: Game): void {}\n}\n\nexport class AttackerHeavyWeapons extends OnisunTalent {\n  constructor() {\n    super(OnisunTalentId.AttackerHeavyWeapons, ' ', 0, 0, 3)\n  }\n\n  public onObtain(game: Game): void {}\n}\n\nexport class AttackerTwoWeapons extends OnisunTalent {\n  constructor() {\n    super(\n      OnisunTalentId.AttackerTwoWeapons,\n      ' ',\n      1,\n      0,\n      1,\n      '     '\n    )\n  }\n\n  public onObtain(game: Game): void {}\n}\n\nexport class AttackerDoubleTwoHandedWeapons extends OnisunTalent {\n  constructor() {\n    super(\n      OnisunTalentId.AttackerDoubleTwoHandedWeapons,\n      '  ',\n      2,\n      0,\n      2\n    )\n  }\n\n  public onObtain(game: Game): void {}\n}\n\nexport class AttackerStrongGrip extends OnisunTalent {\n  constructor() {\n    super(\n      OnisunTalentId.AttackerStrongGrip,\n      ' ',\n      2,\n      0,\n      2,\n      '    '\n    )\n  }\n\n  public onObtain(game: Game): void {}\n}\n","import { ProfessionPicker, Profession, Player } from '../engine'\nimport { AttackerTwoHandedWeapons } from './talents';\n\nenum OnisunProfessionId {\n  Attacker,\n  Defender,\n}\n\nexport class OnisunAttackerProfession extends Profession {\n  constructor(level: number = 1) {\n    super(OnisunProfessionId.Attacker, '', level)\n\n    this.talents.push(\n      new AttackerTwoHandedWeapons()\n    )\n  }\n}\n\nexport class OnisunDefenderProfession extends Profession {\n  constructor(level: number = 1) {\n    super(OnisunProfessionId.Defender, '', level)\n  }\n}\n\nexport class OnisunProfessionPicker extends ProfessionPicker {\n  constructor(\n    player: Player,\n    public attacker = new OnisunAttackerProfession(),\n    public defender = new OnisunDefenderProfession()\n  ) {\n    super([attacker, defender], 3, 6)\n  }\n}\n","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./ItemsListingScreen.vue?vue&type=template&id=518ccf38\"\nimport script from \"./ItemsListingScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./ItemsListingScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.screen.title))]),_vm._v(\" \"),_c('table',{staticClass:\"container positions-list\"},_vm._l((_vm.screen.positions),function(position,index){return _c('tr',{key:index,class:_vm.positionStatus(position)},[_c('td',{staticClass:\"selected\"},[(_vm.positionSelected(index))?_c('div',{staticClass:\"sign\"},[_vm._v(\"\\n          +\\n        \")]):_vm._e()]),_vm._v(\" \"),_c('td',{staticClass:\"letter\"},[_vm._v(\"\\n        \"+_vm._s(_vm.indexLetter(index))+\"\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"separator\"},[_vm._v(\"\\n        \\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"name\"},[_vm._v(\"\\n        \"+_vm._s(position.item.name)+\" (\"+_vm._s(position.count)+\")\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"weight\"},[_vm._v(\"\\n        [\"+_vm._s(position.item.weight)+\"g]\\n      \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import {\n  dungeon,\n  drawn,\n  addDoors,\n  addCreatures,\n  addItems,\n  centralize,\n  addOnTile,\n  connectMaps,\n  Creature,\n  Clan,\n  Player,\n  Specie,\n  allAbilities,\n  Dispatcher,\n  OneHandWeapon,\n  Item,\n  LevelMap,\n  Pool,\n  BodyArmor,\n  Modifier,\n  Characteristics,\n  Game,\n  Point,\n  Level,\n  Ability,\n  Missile,\n  ProfessionPicker,\n  Profession,\n  GroupedItem,\n  MissileSlot,\n  PlayerAI,\n  Talent,\n} from './engine'\nimport { TalentStatus } from './engine/profession'\nimport { TalentsTreeScreen } from './engine/screens/talents_tree_screen'\n\nimport { OnisunProfessionPicker } from './onisun/professions'\nimport { ProfessionPickingScreen } from './engine/screens/profession_picking_screen'\nimport { HealPotion } from './onisun/potions'\nimport { MissileScreen } from './engine/screens/missile_screen';\nexport * from './onisun/professions'\nexport * from './onisun/talents'\n\nexport type GeneratorOptions = {\n  minSize: number\n  maxSize: number\n  roomsCount: number\n\n  addDoors: boolean\n  simple: boolean\n}\n\nexport let baseConfig = {\n  addDoors: false,\n  minSize: 3,\n  maxSize: 10,\n  roomsCount: 10,\n  simple: true,\n}\n\nconst weapons = new Pool<null, Item>([\n  [1, () => new OneHandWeapon('Katana', new Modifier({ attack: 10 }))],\n  [3, () => new OneHandWeapon('Axe', new Modifier({ attack: 7 }))],\n  [7, () => new OneHandWeapon('Dagger', new Modifier({ attack: 3 }))],\n  [5, () => new OneHandWeapon('Hammer', new Modifier({ attack: 5 }))],\n  [5, () => new Missile('Rock', new Modifier({}))],\n])\n\nconst itemsPool = new Pool<null, Item>([\n  [1, () => new BodyArmor('', new Modifier({ defense: 10 }))],\n  [5, () => new BodyArmor('', new Modifier({ defense: 5 }))],\n  [10, () => new BodyArmor('', new Modifier({ defense: 1 }))],\n  [100, () => new HealPotion()],\n])\n\nconst newCreature = (characteristics: Characteristics, name: string) => {\n  return new Creature(\n    characteristics,\n    new Dispatcher(),\n    new Specie(name, Clan.PlayerOnlyEnemy, [])\n  )\n}\n\nconst floatingEye = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 1,\n      defense: 1,\n      dexterity: 1,\n      health: 100,\n      radius: 5,\n      speed: 200,\n    }),\n    'Floating eye'\n  )\n}\n\nconst rat = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 1,\n      defense: 1,\n      dexterity: 1,\n      health: 1,\n      radius: 5,\n      speed: 90,\n    }),\n    'Rat'\n  )\n}\n\nconst orc = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 3,\n      defense: 3,\n      dexterity: 2,\n      health: 5,\n      radius: 5,\n      speed: 100,\n    }),\n    'Orc'\n  )\n}\n\nconst undead = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 2,\n      defense: 7,\n      dexterity: 1,\n      health: 10,\n      radius: 5,\n      speed: 120,\n    }),\n    'Undead'\n  )\n}\n\nconst robot = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 5,\n      defense: 5,\n      dexterity: 3,\n      health: 7,\n      radius: 7,\n      speed: 90,\n    }),\n    'Robot'\n  )\n}\n\nconst dragon = () => {\n  return newCreature(\n    new Characteristics({\n      attack: 7,\n      defense: 7,\n      dexterity: 7,\n      health: 30,\n      radius: 5,\n      speed: 100,\n    }),\n    'Dragon'\n  )\n}\n\nconst creaturesPool1 = new Pool<null, Creature>([[1, rat]])\nconst creaturesPool2 = new Pool<null, Creature>([[1, rat], [2, orc]])\nconst creaturesPool3 = new Pool<null, Creature>([\n  [1, rat],\n  [1, orc],\n  [2, undead],\n])\nconst creaturesPool4 = new Pool<null, Creature>([[2, undead], [2, robot]])\nconst creaturesPool5 = new Pool<null, Creature>([[2, robot], [1, dragon]])\n\nexport class Onisun extends Game {\n  public professionPicker: OnisunProfessionPicker\n\n  constructor(generatorOptions: GeneratorOptions) {\n    super()\n    this.player = this.initPlayer()\n    this.professionPicker = new OnisunProfessionPicker(this.player)\n    this.player.professions.push(this.professionPicker.attacker)\n\n    let map1 = this.generateMap(generatorOptions)\n    let map2 = this.generateMap(generatorOptions)\n    // let map3 = this.generateMap(generatorOptions)\n    // let map4 = this.generateMap(generatorOptions)\n    // let map5 = this.generateMap(generatorOptions)\n\n    // addCreatures(0.05, map1, creaturesPool1)\n    // addCreatures(0.06, map2, creaturesPool2)\n    // addCreatures(0.07, map3, creaturesPool3)\n    // addCreatures(0.08, map4, creaturesPool4)\n    // addCreatures(0.09, map5, creaturesPool5)\n\n    connectMaps(map1, map2)\n    // connectMaps(map2, map3)\n    // connectMaps(map3, map4)\n    // connectMaps(map4, map5)\n\n    this.currentMap = map1\n\n    rat().addToMap(new Point(4, 1), this.currentMap)\n    rat().addToMap(new Point(2, 5), this.currentMap)\n    rat().addToMap(new Point(6, 3), this.currentMap)\n\n    addOnTile(\n      this.currentMap,\n      tile => tile.isFloor() && tile.passibleThrough(),\n      (x, y) => {\n        this.player.addToMap(new Point(1, 3), this.currentMap)\n      }\n    )\n\n    this.screen = new MissileScreen(this)\n  }\n\n  protected initPlayer(): Player {\n    const playerSpecie = new Specie('Player', Clan.Player, allAbilities)\n\n    let player = new Player(\n      new Level([1, 1, 1, 3, 10]),\n      new Characteristics({\n        attack: 1,\n        defense: 4,\n        dexterity: 3,\n        health: 10,\n        radius: 10,\n        speed: 80,\n      }),\n      new PlayerAI(),\n      // new Dispatcher(),\n      playerSpecie\n    )\n\n    const dagger = new OneHandWeapon('Dagger', new Modifier({ attack: 3 }))\n    const katana = new OneHandWeapon('Katana', new Modifier({ attack: 10 }))\n    const rock = new Missile('Rock', new Modifier({}))\n    player.inventory.putToBag(dagger, 2)\n    player.inventory.putToBag(katana, 1)\n    player.inventory.putToBag(rock, 30)\n    // player.putOn(RightHandSlot, dagger)\n    player.inventory.equip(player, MissileSlot, rock)\n\n    return player\n  }\n\n  protected generateMap(options: GeneratorOptions): LevelMap {\n    let map = dungeon(\n      20,\n      40,\n      options.minSize,\n      options.maxSize,\n      options.roomsCount\n    )\n\n    if (options.simple) {\n      map = drawn([\n        'WWWWWWWWWWW',\n        'WRRRRRRRRRW',\n        'WRRRRRRRRRW',\n        'WRRRRRRRRRW',\n        'WRRRRRRRRRW',\n        'WRRRRRRRRRW',\n        'WWWWWWWWWWW',\n      ])\n    }\n\n    if (options.addDoors) {\n      addDoors(map)\n    }\n    centralize(map)\n    map.game = this\n\n    addItems(0.05, map, weapons.merge(itemsPool))\n\n    return map\n  }\n}\n","import { Potion } from '../engine/items'\nimport { Game } from '../engine'\n\nexport class HealPotion extends Potion {\n  constructor() {\n    super(' ')\n  }\n\n  public onDrink(game: Game) {\n    game.player.characteristics.health.increase(5)\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { OnisunTalentId } from 'src/onisun'\nimport { TalentStatus } from 'src/engine';\n\nconst LETTER_OFFSET = 97\n\nexport default Vue.extend({\n  props: ['screen'],\n  data() {\n    return {\n      picked: null,\n      professionIndex: 0\n    }\n  },\n  computed: {\n    option() {\n      return this.screen.options[this.professionIndex]\n    },\n    profession() {\n      return this.option.profession\n    },\n    groupedTalents() {\n      let groups = new Array(5)\n      for (let i = 0; i < groups.length; i++) {\n        groups[i] = []\n      }\n\n      let availableIndex = 0\n\n      this.option.talents.forEach(talent => {\n        if (talent.status === TalentStatus.Available) {\n          Object.assign(talent, {\n            letter: String.fromCharCode(LETTER_OFFSET + availableIndex++)\n          })\n        }\n\n        groups[talent.depth].push(talent)\n      })\n\n      return groups\n    }\n  },\n  methods: {\n    close(doubleClickOption) {\n      const talent = doubleClickOption || this.picked\n\n      if (!talent || talent.status !== TalentStatus.Available) {\n        return\n      }\n\n      this.screen.onInput(this.profession.id, talent.id)\n      this.picked = null\n    },\n    pickTalent(talent) {\n      if (talent.status === TalentStatus.Available) {\n        this.picked = talent\n      }\n    },\n    onEvent(event) {\n      switch(event.key) {\n      case ' ':\n      case 'Enter':\n        this.close()\n      default:\n        this.groupedTalents.forEach(group => group.forEach(talent => {\n          if (talent.letter === event.key) {\n            this.picked = talent\n          }\n        }))\n\n        const index = parseInt(event.key)\n        if (index >= 1 && index <= this.screen.options.length) {\n          this.professionIndex = index - 1\n        }\n      }\n    },\n    talentTip(talent) {\n      let tip = `${talent.rank}/${talent.maxRank}`\n      if (talent.rank >= talent.maxRank) {\n        return tip\n      } else {\n        return `${talent.letter} ${tip}`\n      }\n    },\n    talentStatus(talent) {\n      if (this.picked && this.picked.id === talent.id) {\n        return '-selected'\n      }\n      switch(talent.status) {\n      case TalentStatus.Available:\n        return '-available'\n      case TalentStatus.Unavailable:\n        return '-unavailable'\n      case TalentStatus.Completed:\n        return '-completed'\n      }\n    },\n    iconPath(talentId) {\n      switch(talentId) {\n        case OnisunTalentId.AttackerTwoHandedWeapons:\n          return 'AttackerTwoHandedWeapons.svg'\n        case OnisunTalentId.AttackerHeavyWeapons:\n          return 'AttackerHeavyWeapons.svg'\n        case OnisunTalentId.AttackerLightWeapons:\n          return 'AttackerLightWeapons.svg'\n        case OnisunTalentId.AttackerTwoWeapons:\n          return 'AttackerTwoWeapons.svg'\n        case OnisunTalentId.AttackerDoubleTwoHandedWeapons:\n          return 'AttackerDoubleTwoHandedWeapons.svg'\n        case OnisunTalentId.AttackerStrongGrip:\n          return 'AttackerStrongGrip.svg'\n      }\n    }\n  },\n  watch: {\n    professionIndex() {\n      this.picked =  null\n    }\n  }\n})\n","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./TalentsTreeScreen.vue?vue&type=template&id=3a417cd2\"\nimport script from \"./TalentsTreeScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./TalentsTreeScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal text-center\",attrs:{\"id\":\"talents-tree-container\"}},[_c('b-tabs',{staticClass:\"tabs-list\",attrs:{\"card\":\"\"},model:{value:(_vm.professionIndex),callback:function ($$v) {_vm.professionIndex=$$v},expression:\"professionIndex\"}},_vm._l((_vm.screen.player.professions),function(profession){return _c('b-tab',{key:profession.id,attrs:{\"title\":profession.name,\"no-body\":\"\"}})})),_vm._v(\" \"),_c('table',{staticClass:\"content\"},_vm._l((_vm.groupedTalents),function(group,i){return _c('tr',{key:i},_vm._l((group),function(talent,j){return _c('td',{key:j,staticClass:\"cell\"},[_c('div',{staticClass:\"talent-cell\",class:_vm.talentStatus(talent),attrs:{\"id\":j + 'talentTree-'+i,\"variant\":\"primary\"},on:{\"click\":function($event){_vm.pickTalent(talent)},\"dblclick\":function($event){_vm.close(talent)}}},[_c('img',{staticClass:\"icon\",attrs:{\"src\":'assets/talents/' + _vm.iconPath(talent.id)}}),_vm._v(\" \"),_c('span',{staticClass:\"level\"},[_vm._v(_vm._s(_vm.talentTip(talent)))]),_vm._v(\" \"),_c('b-popover',{attrs:{\"target\":j + 'talentTree-'+i,\"triggers\":\"hover\",\"container\":\"talents-tree-container\"}},[[_c('p',{staticClass:\"name\"},[_vm._v(_vm._s(talent.name))]),_vm._v(\" \"),_c('small',[_c('p',{staticClass:\"rank\"},[_vm._v(\"\\n                     \"+_vm._s(talent.rank)+\"/\"+_vm._s(talent.maxRank)+\"\\n                  \")]),_vm._v(\" \"),(_vm.talentStatus(talent) === '-unavailable')?_c('p',{staticClass:\"requirements\"},[_vm._v(\"\\n                     \"+_vm._s(talent.depth * _vm.profession.depthCost)+\"   \"+_vm._s(_vm.profession.name)+\"\\n                  \")]):_vm._e(),_vm._v(\" \"),_c('p',{staticClass:\"description\"},[_vm._v(\"\\n                    \"+_vm._s(talent.description)+\"\\n                  \")])])]],2)],1)])}))})),_vm._v(\" \"),(_vm.picked !== null)?_c('b-btn',{attrs:{\"variant\":\"default\"},on:{\"click\":function($event){_vm.close()}}},[_vm._v(\"\")]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport {\n  LeftHandSlot,\n  RightHandSlot,\n  BodySlot,\n  MissileSlot,\n} from '../../src/engine'\n\nimport {\n  displayItem,\n} from './../scene_tiles'\n\nconst LETTER_OFFSET = 97\n\nexport default Vue.extend({\n  name: 'Inventory',\n  props: ['screen'],\n  data() {\n    return {\n      page: 0,\n      perPage: 20,\n    }\n  },\n  computed: {\n    player() {\n      return this.screen.player\n    }\n  },\n  methods: {\n    onEvent(event) {\n      switch (event.key) {\n      case ' ':\n      case 'Escape':\n        return this.screen.close()\n      case 'Enter':\n      case ',':\n        return this.screen.pickUpItems(this.selected.map(index => this.screen.positions[index]))\n      default:\n        return this.selectAt(event.key.charCodeAt(0) - LETTER_OFFSET)\n      }\n    },\n    selectAt(i: number) {\n      if (i >= 0 && i < Math.min(this.perPage, this.screen.positions.length)) {\n        const position = this.screen.positions[i]\n        if (position.item) {\n          this.screen.takeOff(position)\n        } else if (position.availableItems.length) {\n          this.screen.putOn(position)\n        }\n      }\n    },\n    indexLetter(i: number): string {\n      return String.fromCharCode(LETTER_OFFSET + i)\n    },\n    positionSelected(index) {\n      return this.selected.indexOf(index) >= 0\n    },\n    positionStatus(position) {\n      if (!position.item) {\n        return ''\n      } else {\n        return 'text-success'\n      }\n    },\n    displayBodyPart(bodyPart) {\n      switch (bodyPart.id) {\n        case LeftHandSlot.id:\n          return ' '\n        case RightHandSlot.id:\n          return ' '\n        // case BodyPart.Legs:\n        //   return ''\n        // case BodyPart.Finger:\n        //   return ''\n        // case BodyPart.Head:\n        //   return ''\n        // case BodyPart.Eye:\n        //   return ''\n        // case BodyPart.Neck:\n        //   return ''\n        // case BodyPart.Back:\n        //   return ''\n        case BodySlot.id:\n          return ''\n        // case BodyPart.MissileWeapon:\n        //   return 'MissileWeapon'\n        case MissileSlot.id:\n          return ''\n        default:\n          throw `Unknow body part ${bodyPart}`\n      }\n    },\n    displayItem(item) {\n      if (item) {\n        return `${displayItem(item).getChar()} ${item.name}`\n      }\n    },\n    itemName(position) {\n      if (position.item) {\n        return `${position.item.name} (${position.count})`\n      } else {\n        return '-'\n      }\n    },\n    itemWeight(position) {\n      if (position.item) {\n        return `[${position.item.weight}g]`\n      }\n    },\n    available(position) {\n      return position.item || position.availableItems.length\n    },\n    availableStatus(position) {\n      return this.available(position) ? '-available' : '-unavailable'\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./InventoryScreen.vue?vue&type=template&id=c5310062\"\nimport script from \"./InventoryScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./InventoryScreen.vue?vue&type=script&lang=ts\"\nimport style0 from \"./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"screen-modal\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"\")]),_vm._v(\" \"),_c('table',{staticClass:\"content inventory-list\"},_vm._l((_vm.screen.positions),function(position,index){return _c('tr',{key:index,class:_vm.availableStatus(position)},[_c('td',{staticClass:\"slot\"},[_c('span',{staticClass:\"letter\"},[_vm._v(\"\\n          \"+_vm._s(_vm.indexLetter(index))+\"\\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"dash\"},[_vm._v(\"\\n          \\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"part\"},[_vm._v(\"\\n          \"+_vm._s(_vm.displayBodyPart(position.inventorySlot))+\"\\n        \")]),_vm._v(\" \"),_c('span',{staticClass:\"separator float-right\"},[_vm._v(\"\\n            :\\n        \")])]),_vm._v(\" \"),_c('td',{staticClass:\"name\",class:_vm.positionStatus(position)},[_vm._v(\"\\n        \"+_vm._s(_vm.itemName(position))+\"\\n      \")]),_vm._v(\" \"),_c('td',{staticClass:\"weight\"},[_vm._v(\"\\n        \"+_vm._s(_vm.itemWeight(position))+\"\\n      \")])])}))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MissileScreen.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/ts-loader/index.js??ref--13-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MissileScreen.vue?vue&type=script&lang=ts\"","\n\n\n\n\nimport Vue from 'vue'\nimport { IdleInputKey, Direction } from '../../src/engine'\n\nexport default Vue.extend({\n  name: 'MissileScreen',\n  props: ['screen'],\n  methods: {\n    close(inputKey) {\n      this.screen.onInput(inputKey)\n    },\n    onEvent(event) {\n      switch (event.key) {\n      case 'l':\n      case 'ArrowRight':\n        return this.screen.moveTarget(Direction.right)\n      case 'h':\n      case 'ArrowLeft':\n        return this.screen.moveTarget(Direction.left)\n      case 'k':\n      case 'ArrowUp':\n        return this.screen.moveTarget(Direction.up)\n      case 'j':\n      case 'ArrowDown':\n        return this.screen.moveTarget(Direction.down)\n      case 'y':\n        return this.screen.moveTarget(Direction.upLeft)\n      case 'u':\n        return this.screen.moveTarget(Direction.upRight)\n      case 'b':\n        return this.screen.moveTarget(Direction.downLeft)\n      case 'n':\n        return this.screen.moveTarget(Direction.downRight)\n\n      case '>':\n        this.screen.nextTarget()\n        break\n      case '<':\n        this.screen.previousTarget()\n        break\n      case 'T':\n        this.screen.attack()\n        break\n      case 'Escape':\n        this.screen.close()\n        break\n      }\n    }\n  }\n})\n","import { render, staticRenderFns } from \"./MissileScreen.vue?vue&type=template&id=59b734cb\"\nimport script from \"./MissileScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./MissileScreen.vue?vue&type=script&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\"MissileScreen\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../node_modules/ts-loader/index.js??ref--13-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport * as _ from 'lodash'\n\nimport Cell from './Cell.vue'\nimport Logger from './Logger.vue'\nimport Scene from './Scene.vue'\n\nimport Idle from './screens/IdleScreen.vue'\nimport ProfessionPickingScreen from './screens/ProfessionPickingScreen.vue'\nimport ItemsListingScreen from './screens/ItemsListingScreen.vue'\nimport TalentsTreeScreen from './screens/TalentsTreeScreen.vue'\nimport InventoryScreen from './screens/InventoryScreen.vue'\nimport MissileScreen from './screens/MissileScreen.vue'\n\nimport { LevelMap, ScreenType, Screen } from '../src/engine'\n\nimport {\n  Onisun,\n  baseConfig,\n} from '../src/onisun'\nimport { setInterval, clearInterval } from 'timers';\n\nexport default Vue.extend({\n  data() {\n    return {\n      game: new Onisun(baseConfig),\n      ts: Date.now(),\n      generatorOptions: baseConfig,\n      loopIntervalId: undefined\n    }\n  },\n  components: {\n    Cell,\n    Logger,\n    Scene,\n  },\n  computed: {\n    screenComponent() {\n      switch (this.game.screen && this.game.screen.type) {\n      case ScreenType.AbilitiesPicking:\n        return TalentsTreeScreen\n      case ScreenType.ProfessionPicking:\n        return ProfessionPickingScreen\n      case ScreenType.Idle:\n        return Idle\n      case ScreenType.ItemsListing:\n        return ItemsListingScreen\n      case ScreenType.Inventory:\n        return InventoryScreen\n      case ScreenType.Missile:\n        return MissileScreen\n      }\n    }\n  },\n  methods: {\n    generateMap() {\n      this.game = new Onisun(\n        this.generatorOptions,\n      )\n    },\n    loop() {\n      this.game.turn()\n    },\n    onEvent(event) {\n      const screen = this.$refs.screenComponent\n      if (screen) {\n        screen.onEvent(event)\n      }\n    }\n  },\n  created() {\n    this.loopIntervalId = setInterval(this.loop, 10)\n    document.addEventListener('keydown', this.onEvent)\n  },\n  beforeDestroy() {\n    clearInterval(this.loopIntervalId)\n    document.removeEventListener('keydown', this.onEvent)\n  }\n})\n","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=0b9b7999\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.game)?_c('div',{staticClass:\"container\",attrs:{\"id\":\"app\"}},[(_vm.game.player && !_vm.game.player.dead)?_c('Scene',{attrs:{\"level\":_vm.game.currentMap,\"player\":_vm.game.player}}):_vm._e(),_vm._v(\" \"),(_vm.game.player && _vm.game.player.dead)?_c('div',[_vm._v(\"You are dead\")]):_vm._e(),_vm._v(\" \"),(_vm.game.screen)?_c(_vm.screenComponent,{ref:\"screenComponent\",tag:\"component\",attrs:{\"screen\":_vm.game.screen}}):_vm._e(),_vm._v(\" \"),_c('Logger',{attrs:{\"logger\":_vm.game.logger}}),_vm._v(\" \"),_c('div',{},[_c('div',{},[_c('div',{staticClass:\"form-group row\"},[_c('div',{staticClass:\"col-sm-2\"},[_vm._v(\"\\n          Map\\n        \")]),_vm._v(\" \"),_c('div',{staticClass:\"col-sm-10\"},[_c('div',{staticClass:\"form-check\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.addDoors),expression:\"generatorOptions.addDoors\"}],staticClass:\"form-check-input\",attrs:{\"id\":\"doors\",\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.generatorOptions.addDoors)?_vm._i(_vm.generatorOptions.addDoors,null)>-1:(_vm.generatorOptions.addDoors)},on:{\"change\":function($event){var $$a=_vm.generatorOptions.addDoors,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.generatorOptions, \"addDoors\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.generatorOptions, \"addDoors\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.generatorOptions, \"addDoors\", $$c)}}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"doors\"}},[_vm._v(\"\\n              Add doors\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.roomsCount),expression:\"generatorOptions.roomsCount\"}],staticClass:\"form-control\",attrs:{\"id\":\"roomsCount\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.roomsCount)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"roomsCount\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"roomsCount\"}},[_vm._v(\"\\n              roomsCount\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.minSize),expression:\"generatorOptions.minSize\"}],staticClass:\"form-control\",attrs:{\"id\":\"minSize\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.minSize)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"minSize\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"minSize\"}},[_vm._v(\"\\n              minSize\\n            \")])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.generatorOptions.maxSize),expression:\"generatorOptions.maxSize\"}],staticClass:\"form-control\",attrs:{\"id\":\"maxSize\",\"type\":\"number\"},domProps:{\"value\":(_vm.generatorOptions.maxSize)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.generatorOptions, \"maxSize\", $event.target.value)}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"maxSize\"}},[_vm._v(\"\\n              maxSize\\n            \")])])])]),_vm._v(\" \"),_c('div',{staticClass:\"form-group row\"},[_c('div',{staticClass:\"col-sm-10\"},[_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){_vm.generateMap()}}},[_vm._v(\"\\n            Rebuild!\\n          \")])])])])])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue'\nimport App from './App.vue'\nimport BootstrapVue from 'bootstrap-vue'\n\nVue.use(BootstrapVue)\n\nimport './application.scss'\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport 'bootstrap-vue/dist/bootstrap-vue.css'\n\nnew Vue({\n  el: '#app',\n  render: h => h(App)\n})\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InventoryScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TalentsTreeScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ItemsListingScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProfessionPickingScreen.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Scene.vue?vue&type=style&index=0&lang=scss\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=style&index=0&lang=scss\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--1-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/sass-loader/lib/loader.js??ref--1-oneOf-2-2!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logger.vue?vue&type=style&index=0&lang=scss\"","var map = {\n\t\"./af\": 141,\n\t\"./af.js\": 141,\n\t\"./ar\": 140,\n\t\"./ar-dz\": 139,\n\t\"./ar-dz.js\": 139,\n\t\"./ar-kw\": 138,\n\t\"./ar-kw.js\": 138,\n\t\"./ar-ly\": 137,\n\t\"./ar-ly.js\": 137,\n\t\"./ar-ma\": 136,\n\t\"./ar-ma.js\": 136,\n\t\"./ar-sa\": 135,\n\t\"./ar-sa.js\": 135,\n\t\"./ar-tn\": 134,\n\t\"./ar-tn.js\": 134,\n\t\"./ar.js\": 140,\n\t\"./az\": 133,\n\t\"./az.js\": 133,\n\t\"./be\": 132,\n\t\"./be.js\": 132,\n\t\"./bg\": 131,\n\t\"./bg.js\": 131,\n\t\"./bm\": 130,\n\t\"./bm.js\": 130,\n\t\"./bn\": 129,\n\t\"./bn.js\": 129,\n\t\"./bo\": 128,\n\t\"./bo.js\": 128,\n\t\"./br\": 127,\n\t\"./br.js\": 127,\n\t\"./bs\": 126,\n\t\"./bs.js\": 126,\n\t\"./ca\": 125,\n\t\"./ca.js\": 125,\n\t\"./cs\": 124,\n\t\"./cs.js\": 124,\n\t\"./cv\": 123,\n\t\"./cv.js\": 123,\n\t\"./cy\": 122,\n\t\"./cy.js\": 122,\n\t\"./da\": 121,\n\t\"./da.js\": 121,\n\t\"./de\": 120,\n\t\"./de-at\": 119,\n\t\"./de-at.js\": 119,\n\t\"./de-ch\": 118,\n\t\"./de-ch.js\": 118,\n\t\"./de.js\": 120,\n\t\"./dv\": 117,\n\t\"./dv.js\": 117,\n\t\"./el\": 116,\n\t\"./el.js\": 116,\n\t\"./en-au\": 115,\n\t\"./en-au.js\": 115,\n\t\"./en-ca\": 114,\n\t\"./en-ca.js\": 114,\n\t\"./en-gb\": 113,\n\t\"./en-gb.js\": 113,\n\t\"./en-ie\": 112,\n\t\"./en-ie.js\": 112,\n\t\"./en-il\": 111,\n\t\"./en-il.js\": 111,\n\t\"./en-nz\": 110,\n\t\"./en-nz.js\": 110,\n\t\"./eo\": 109,\n\t\"./eo.js\": 109,\n\t\"./es\": 108,\n\t\"./es-do\": 107,\n\t\"./es-do.js\": 107,\n\t\"./es-us\": 106,\n\t\"./es-us.js\": 106,\n\t\"./es.js\": 108,\n\t\"./et\": 105,\n\t\"./et.js\": 105,\n\t\"./eu\": 104,\n\t\"./eu.js\": 104,\n\t\"./fa\": 103,\n\t\"./fa.js\": 103,\n\t\"./fi\": 102,\n\t\"./fi.js\": 102,\n\t\"./fo\": 101,\n\t\"./fo.js\": 101,\n\t\"./fr\": 100,\n\t\"./fr-ca\": 99,\n\t\"./fr-ca.js\": 99,\n\t\"./fr-ch\": 98,\n\t\"./fr-ch.js\": 98,\n\t\"./fr.js\": 100,\n\t\"./fy\": 97,\n\t\"./fy.js\": 97,\n\t\"./gd\": 96,\n\t\"./gd.js\": 96,\n\t\"./gl\": 95,\n\t\"./gl.js\": 95,\n\t\"./gom-latn\": 94,\n\t\"./gom-latn.js\": 94,\n\t\"./gu\": 93,\n\t\"./gu.js\": 93,\n\t\"./he\": 92,\n\t\"./he.js\": 92,\n\t\"./hi\": 91,\n\t\"./hi.js\": 91,\n\t\"./hr\": 90,\n\t\"./hr.js\": 90,\n\t\"./hu\": 89,\n\t\"./hu.js\": 89,\n\t\"./hy-am\": 88,\n\t\"./hy-am.js\": 88,\n\t\"./id\": 87,\n\t\"./id.js\": 87,\n\t\"./is\": 86,\n\t\"./is.js\": 86,\n\t\"./it\": 85,\n\t\"./it.js\": 85,\n\t\"./ja\": 84,\n\t\"./ja.js\": 84,\n\t\"./jv\": 83,\n\t\"./jv.js\": 83,\n\t\"./ka\": 82,\n\t\"./ka.js\": 82,\n\t\"./kk\": 81,\n\t\"./kk.js\": 81,\n\t\"./km\": 80,\n\t\"./km.js\": 80,\n\t\"./kn\": 79,\n\t\"./kn.js\": 79,\n\t\"./ko\": 78,\n\t\"./ko.js\": 78,\n\t\"./ky\": 77,\n\t\"./ky.js\": 77,\n\t\"./lb\": 76,\n\t\"./lb.js\": 76,\n\t\"./lo\": 75,\n\t\"./lo.js\": 75,\n\t\"./lt\": 74,\n\t\"./lt.js\": 74,\n\t\"./lv\": 73,\n\t\"./lv.js\": 73,\n\t\"./me\": 72,\n\t\"./me.js\": 72,\n\t\"./mi\": 71,\n\t\"./mi.js\": 71,\n\t\"./mk\": 70,\n\t\"./mk.js\": 70,\n\t\"./ml\": 69,\n\t\"./ml.js\": 69,\n\t\"./mn\": 68,\n\t\"./mn.js\": 68,\n\t\"./mr\": 67,\n\t\"./mr.js\": 67,\n\t\"./ms\": 66,\n\t\"./ms-my\": 65,\n\t\"./ms-my.js\": 65,\n\t\"./ms.js\": 66,\n\t\"./mt\": 64,\n\t\"./mt.js\": 64,\n\t\"./my\": 63,\n\t\"./my.js\": 63,\n\t\"./nb\": 62,\n\t\"./nb.js\": 62,\n\t\"./ne\": 61,\n\t\"./ne.js\": 61,\n\t\"./nl\": 60,\n\t\"./nl-be\": 59,\n\t\"./nl-be.js\": 59,\n\t\"./nl.js\": 60,\n\t\"./nn\": 58,\n\t\"./nn.js\": 58,\n\t\"./pa-in\": 57,\n\t\"./pa-in.js\": 57,\n\t\"./pl\": 56,\n\t\"./pl.js\": 56,\n\t\"./pt\": 55,\n\t\"./pt-br\": 54,\n\t\"./pt-br.js\": 54,\n\t\"./pt.js\": 55,\n\t\"./ro\": 53,\n\t\"./ro.js\": 53,\n\t\"./ru\": 52,\n\t\"./ru.js\": 52,\n\t\"./sd\": 51,\n\t\"./sd.js\": 51,\n\t\"./se\": 50,\n\t\"./se.js\": 50,\n\t\"./si\": 49,\n\t\"./si.js\": 49,\n\t\"./sk\": 48,\n\t\"./sk.js\": 48,\n\t\"./sl\": 47,\n\t\"./sl.js\": 47,\n\t\"./sq\": 46,\n\t\"./sq.js\": 46,\n\t\"./sr\": 45,\n\t\"./sr-cyrl\": 44,\n\t\"./sr-cyrl.js\": 44,\n\t\"./sr.js\": 45,\n\t\"./ss\": 43,\n\t\"./ss.js\": 43,\n\t\"./sv\": 42,\n\t\"./sv.js\": 42,\n\t\"./sw\": 41,\n\t\"./sw.js\": 41,\n\t\"./ta\": 40,\n\t\"./ta.js\": 40,\n\t\"./te\": 39,\n\t\"./te.js\": 39,\n\t\"./tet\": 38,\n\t\"./tet.js\": 38,\n\t\"./tg\": 37,\n\t\"./tg.js\": 37,\n\t\"./th\": 36,\n\t\"./th.js\": 36,\n\t\"./tl-ph\": 35,\n\t\"./tl-ph.js\": 35,\n\t\"./tlh\": 34,\n\t\"./tlh.js\": 34,\n\t\"./tr\": 33,\n\t\"./tr.js\": 33,\n\t\"./tzl\": 32,\n\t\"./tzl.js\": 32,\n\t\"./tzm\": 31,\n\t\"./tzm-latn\": 30,\n\t\"./tzm-latn.js\": 30,\n\t\"./tzm.js\": 31,\n\t\"./ug-cn\": 29,\n\t\"./ug-cn.js\": 29,\n\t\"./uk\": 28,\n\t\"./uk.js\": 28,\n\t\"./ur\": 27,\n\t\"./ur.js\": 27,\n\t\"./uz\": 26,\n\t\"./uz-latn\": 25,\n\t\"./uz-latn.js\": 25,\n\t\"./uz.js\": 26,\n\t\"./vi\": 24,\n\t\"./vi.js\": 24,\n\t\"./x-pseudo\": 23,\n\t\"./x-pseudo.js\": 23,\n\t\"./yo\": 22,\n\t\"./yo.js\": 22,\n\t\"./zh-cn\": 21,\n\t\"./zh-cn.js\": 21,\n\t\"./zh-hk\": 20,\n\t\"./zh-hk.js\": 20,\n\t\"./zh-tw\": 19,\n\t\"./zh-tw.js\": 19\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 179;","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--0-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=style&index=0&lang=css\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js!../node_modules/css-loader/index.js??ref--0-oneOf-2-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Cell.vue?vue&type=style&index=0&lang=css\""],"sourceRoot":""}